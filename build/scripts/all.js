/*! hellojs v1.14.1 | (c) 2012-2017 Andrew Dodson | MIT https://adodson.com/hello.js/LICENSE */
Object.create||(Object.create=function(){function e(){}return function(t){if(1!=arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return e.prototype=t,new e}}()),Object.keys||(Object.keys=function(e,t,n){n=[];for(t in e)n.hasOwnProperty.call(e,t)&&n.push(t);return n}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(e){if(void 0===this||null===this)throw new TypeError;var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var o=arguments.length>=2?arguments[1]:void 0,i=0;n>i;i++)i in t&&e.call(o,t[i],i,t);return this}),Array.prototype.filter||(Array.prototype.filter=function(e,t){var n=[];return this.forEach(function(o,i,r){e.call(t||void 0,o,i,r)&&n.push(o)}),n}),Array.prototype.map||(Array.prototype.map=function(e,t){var n=[];return this.forEach(function(o,i,r){n.push(e.call(t||void 0,o,i,r))}),n}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),"object"!=typeof window||"object"!=typeof window.location||window.location.assign||(window.location.assign=function(e){window.location=e}),Function.prototype.bind||(Function.prototype.bind=function(e){function t(){}if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var n=[].slice,o=n.call(arguments,1),i=this,r=function(){return i.apply(this instanceof t?this:e||window,o.concat(n.call(arguments)))};return t.prototype=this.prototype,r.prototype=new t,r});var hello=function(e){return hello.use(e)};hello.utils={extend:function(e){return Array.prototype.slice.call(arguments,1).forEach(function(t){if(Array.isArray(e)&&Array.isArray(t))Array.prototype.push.apply(e,t);else if(e&&(e instanceof Object||"object"==typeof e)&&t&&(t instanceof Object||"object"==typeof t)&&e!==t)for(var n in t)e[n]=hello.utils.extend(e[n],t[n]);else Array.isArray(t)&&(t=t.slice(0)),e=t}),e}},hello.utils.extend(hello,{settings:{redirect_uri:window.location.href.split("#")[0],response_type:"token",display:"popup",state:"",oauth_proxy:"https://auth-server.herokuapp.com/proxy",timeout:2e4,popup:{resizable:1,scrollbars:1,width:500,height:550},scope:["basic"],scope_map:{basic:""},default_service:null,force:null,page_uri:window.location.href},services:{},use:function(e){var t=Object.create(this);return t.settings=Object.create(this.settings),e&&(t.settings.default_service=e),t.utils.Event.call(t),t},init:function(e,t){var n=this.utils;if(!e)return this.services;for(var o in e)e.hasOwnProperty(o)&&"object"!=typeof e[o]&&(e[o]={id:e[o]});return n.extend(this.services,e),t&&(n.extend(this.settings,t),"redirect_uri"in t&&(this.settings.redirect_uri=n.url(t.redirect_uri).href)),this},login:function(){function e(e,t){hello.emit(e,t)}function t(e){return e}function n(e){return!!e}var o,i=this,r=i.utils,a=r.error,s=r.Promise(),l=r.args({network:"s",options:"o",callback:"f"},arguments),u=r.diffKey(l.options,i.settings),c=l.options=r.merge(i.settings,l.options||{});if(c.popup=r.merge(i.settings.popup,l.options.popup||{}),l.network=l.network||i.settings.default_service,s.proxy.then(l.callback,l.callback),s.proxy.then(e.bind(this,"auth.login auth"),e.bind(this,"auth.failed auth")),"string"!=typeof l.network||!(l.network in i.services))return s.reject(a("invalid_network","The provided network was not recognized"));var d=i.services[l.network],f=r.globalEvent(function(e){var t;t=e?JSON.parse(e):a("cancelled","The authentication was not completed"),t.error?s.reject(t):(r.store(t.network,t),s.fulfill({network:t.network,authResponse:t}))}),p=r.url(c.redirect_uri).href,m=d.oauth.response_type||c.response_type;/\bcode\b/.test(m)&&!d.oauth.grant&&(m=m.replace(/\bcode\b/,"token")),l.qs=r.merge(u,{client_id:encodeURIComponent(d.id),response_type:encodeURIComponent(m),redirect_uri:encodeURIComponent(p),state:{client_id:d.id,network:l.network,display:c.display,callback:f,state:c.state,redirect_uri:p}});var h=r.store(l.network),g=/[,\s]+/,v=i.settings.scope?[i.settings.scope.toString()]:[],y=r.merge(i.settings.scope_map,d.scope||{});if(c.scope&&v.push(c.scope.toString()),h&&"scope"in h&&h.scope instanceof String&&v.push(h.scope),v=v.join(",").split(g),v=r.unique(v).filter(n),l.qs.state.scope=v.join(","),v=v.map(function(e){return e in y?y[e]:e}),v=v.join(",").split(g),v=r.unique(v).filter(n),l.qs.scope=v.join(d.scope_delim||","),c.force===!1&&h&&"access_token"in h&&h.access_token&&"expires"in h&&h.expires>(new Date).getTime()/1e3){var w=r.diff((h.scope||"").split(g),(l.qs.state.scope||"").split(g));if(0===w.length)return s.fulfill({unchanged:!0,network:l.network,authResponse:h}),s}if("page"===c.display&&c.page_uri&&(l.qs.state.page_uri=r.url(c.page_uri).href),"login"in d&&"function"==typeof d.login&&d.login(l),(!/\btoken\b/.test(m)||parseInt(d.oauth.version,10)<2||"none"===c.display&&d.oauth.grant&&h&&h.refresh_token)&&(l.qs.state.oauth=d.oauth,l.qs.state.oauth_proxy=c.oauth_proxy),l.qs.state=encodeURIComponent(JSON.stringify(l.qs.state)),1===parseInt(d.oauth.version,10)?o=r.qs(c.oauth_proxy,l.qs,t):"none"===c.display&&d.oauth.grant&&h&&h.refresh_token?(l.qs.refresh_token=h.refresh_token,o=r.qs(c.oauth_proxy,l.qs,t)):o=r.qs(d.oauth.auth,l.qs,t),e("auth.init",l),"none"===c.display)r.iframe(o,p);else if("popup"===c.display)var _=r.popup(o,p,c.popup),b=setInterval(function(){if((!_||_.closed)&&(clearInterval(b),!s.state)){var e=a("cancelled","Login has been cancelled");_||(e=a("blocked","Popup was blocked")),e.network=l.network,s.reject(e)}},100);else window.location=o;return s.proxy},logout:function(){function e(e,t){hello.emit(e,t)}var t=this,n=t.utils,o=n.error,i=n.Promise(),r=n.args({name:"s",options:"o",callback:"f"},arguments);if(r.options=r.options||{},i.proxy.then(r.callback,r.callback),i.proxy.then(e.bind(this,"auth.logout auth"),e.bind(this,"error")),r.name=r.name||this.settings.default_service,r.authResponse=n.store(r.name),!r.name||r.name in t.services)if(r.name&&r.authResponse){var a=function(e){n.store(r.name,null),i.fulfill(hello.utils.merge({network:r.name},e||{}))},s={};if(r.options.force){var l=t.services[r.name].logout;if(l)if("function"==typeof l&&(l=l(a,r)),"string"==typeof l)n.iframe(l),s.force=null,s.message="Logout success on providers site was indeterminate";else if(void 0===l)return i.proxy}a(s)}else i.reject(o("invalid_session","There was no session to remove"));else i.reject(o("invalid_network","The network was unrecognized"));return i.proxy},getAuthResponse:function(e){return e=e||this.settings.default_service,e&&e in this.services?this.utils.store(e)||null:null},events:{}}),hello.utils.extend(hello.utils,{error:function(e,t){return{error:{code:e,message:t}}},qs:function(e,t,n){if(t){n=n||encodeURIComponent;for(var o in t){var i="([\\?\\&])"+o+"=[^\\&]*",r=new RegExp(i);e.match(r)&&(e=e.replace(r,"$1"+o+"="+n(t[o])),delete t[o])}}return this.isEmpty(t)?e:e+(e.indexOf("?")>-1?"&":"?")+this.param(t,n)},param:function(e,t){var n,o,i={};if("string"==typeof e){if(t=t||decodeURIComponent,o=e.replace(/^[\#\?]/,"").match(/([^=\/\&]+)=([^\&]+)/g))for(var r=0;r<o.length;r++)n=o[r].match(/([^=]+)=(.*)/),i[n[1]]=t(n[2]);return i}t=t||encodeURIComponent;var a=e;i=[];for(var s in a)a.hasOwnProperty(s)&&a.hasOwnProperty(s)&&i.push([s,"?"===a[s]?"?":t(a[s])].join("="));return i.join("&")},store:function(){function e(){var e={};try{e=JSON.parse(n.getItem("hello"))||{}}catch(t){}return e}function t(e){n.setItem("hello",JSON.stringify(e))}for(var n,o=["localStorage","sessionStorage"],i=-1,r="test";o[++i];)try{n=window[o[i]],n.setItem(r+i,i),n.removeItem(r+i);break}catch(a){n=null}if(!n){var s=null;n={getItem:function(e){e+="=";for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var o=t[n].replace(/(^\s+|\s+$)/,"");if(o&&0===o.indexOf(e))return o.substr(e.length)}return s},setItem:function(e,t){s=t,document.cookie=e+"="+t}},s=n.getItem("hello")}return function(n,o,i){var r=e();if(n&&void 0===o)return r[n]||null;if(n&&null===o)try{delete r[n]}catch(a){r[n]=null}else{if(!n)return r;r[n]=o}return t(r),r||null}}(),append:function(e,t,n){var o="string"==typeof e?document.createElement(e):e;if("object"==typeof t)if("tagName"in t)n=t;else for(var i in t)if(t.hasOwnProperty(i))if("object"==typeof t[i])for(var r in t[i])t[i].hasOwnProperty(r)&&(o[i][r]=t[i][r]);else"html"===i?o.innerHTML=t[i]:/^on/.test(i)?o[i]=t[i]:o.setAttribute(i,t[i]);return"body"===n?!function a(){document.body?document.body.appendChild(o):setTimeout(a,16)}():"object"==typeof n?n.appendChild(o):"string"==typeof n&&document.getElementsByTagName(n)[0].appendChild(o),o},iframe:function(e){this.append("iframe",{src:e,style:{position:"absolute",left:"-1000px",bottom:0,height:"1px",width:"1px"}},"body")},merge:function(){var e=Array.prototype.slice.call(arguments);return e.unshift({}),this.extend.apply(null,e)},args:function(e,t){var n={},o=0,i=null,r=null;for(r in e)if(e.hasOwnProperty(r))break;if(1===t.length&&"object"==typeof t[0]&&"o!"!=e[r])for(r in t[0])if(e.hasOwnProperty(r)&&r in e)return t[0];for(r in e)if(e.hasOwnProperty(r))if(i=typeof t[o],"function"==typeof e[r]&&e[r].test(t[o])||"string"==typeof e[r]&&(e[r].indexOf("s")>-1&&"string"===i||e[r].indexOf("o")>-1&&"object"===i||e[r].indexOf("i")>-1&&"number"===i||e[r].indexOf("a")>-1&&"object"===i||e[r].indexOf("f")>-1&&"function"===i))n[r]=t[o++];else if("string"==typeof e[r]&&e[r].indexOf("!")>-1)return!1;return n},url:function(e){if(e){if(window.URL&&URL instanceof Function&&0!==URL.length)return new URL(e,window.location);var t=document.createElement("a");return t.href=e,t.cloneNode(!1)}return window.location},diff:function(e,t){return t.filter(function(t){return-1===e.indexOf(t)})},diffKey:function(e,t){if(e||!t){var n={};for(var o in e)o in t||(n[o]=e[o]);return n}return e},unique:function(e){return Array.isArray(e)?e.filter(function(t,n){return e.indexOf(t)===n}):[]},isEmpty:function(e){if(!e)return!0;if(Array.isArray(e))return!e.length;if("object"==typeof e)for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},Promise:function(){var e=0,t=1,n=2,o=function(t){return this instanceof o?(this.id="Thenable/1.0.6",this.state=e,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},void("function"==typeof t&&t.call(this,this.fulfill.bind(this),this.reject.bind(this)))):new o(t)};o.prototype={fulfill:function(e){return i(this,t,"fulfillValue",e)},reject:function(e){return i(this,n,"rejectReason",e)},then:function(e,t){var n=this,i=new o;return n.onFulfilled.push(s(e,i,"fulfill")),n.onRejected.push(s(t,i,"reject")),r(n),i.proxy}};var i=function(t,n,o,i){return t.state===e&&(t.state=n,t[o]=i,r(t)),t},r=function(e){e.state===t?a(e,"onFulfilled",e.fulfillValue):e.state===n&&a(e,"onRejected",e.rejectReason)},a=function(e,t,n){if(0!==e[t].length){var o=e[t];e[t]=[];var i=function(){for(var e=0;e<o.length;e++)o[e](n)};"object"==typeof process&&"function"==typeof process.nextTick?process.nextTick(i):"function"==typeof setImmediate?setImmediate(i):setTimeout(i,0)}},s=function(e,t,n){return function(o){if("function"!=typeof e)t[n].call(t,o);else{var i;try{i=e(o)}catch(r){return void t.reject(r)}l(t,i)}}},l=function(e,t){if(e===t||e.proxy===t)return void e.reject(new TypeError("cannot resolve promise with itself"));var n;if("object"==typeof t&&null!==t||"function"==typeof t)try{n=t.then}catch(o){return void e.reject(o)}if("function"!=typeof n)e.fulfill(t);else{var i=!1;try{n.call(t,function(n){i||(i=!0,n===t?e.reject(new TypeError("circular thenable chain")):l(e,n))},function(t){i||(i=!0,e.reject(t))})}catch(o){i||e.reject(o)}}};return o}(),Event:function(){var e=/[\s\,]+/;return this.parent={events:this.events,findEvents:this.findEvents,parent:this.parent,utils:this.utils},this.events={},this.on=function(t,n){if(n&&"function"==typeof n)for(var o=t.split(e),i=0;i<o.length;i++)this.events[o[i]]=[n].concat(this.events[o[i]]||[]);return this},this.off=function(e,t){return this.findEvents(e,function(e,n){t&&this.events[e][n]!==t||(this.events[e][n]=null)}),this},this.emit=function(e){var t=Array.prototype.slice.call(arguments,1);t.push(e);for(var n=function(n,o){t[t.length-1]="*"===n?e:n,this.events[n][o].apply(this,t)},o=this;o&&o.findEvents;)o.findEvents(e+",*",n),o=o.parent;return this},this.emitAfter=function(){var e=this,t=arguments;return setTimeout(function(){e.emit.apply(e,t)},0),this},this.findEvents=function(t,n){var o=t.split(e);for(var i in this.events)if(this.events.hasOwnProperty(i)&&o.indexOf(i)>-1)for(var r=0;r<this.events[i].length;r++)this.events[i][r]&&n.call(this,i,r)},this},globalEvent:function(e,t){return t=t||"_hellojs_"+parseInt(1e12*Math.random(),10).toString(36),window[t]=function(){try{e.apply(this,arguments)&&delete window[t]}catch(n){console.error(n)}},t},popup:function(e,t,n){var o=document.documentElement;if(n.height){var i=void 0!==window.screenTop?window.screenTop:screen.top,r=screen.height||window.innerHeight||o.clientHeight;n.top=parseInt((r-n.height)/2,10)+i}if(n.width){var a=void 0!==window.screenLeft?window.screenLeft:screen.left,s=screen.width||window.innerWidth||o.clientWidth;n.left=parseInt((s-n.width)/2,10)+a}var l=[];Object.keys(n).forEach(function(e){var t=n[e];l.push(e+(null!==t?"="+t:""))}),-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&(e=t+"#oauth_redirect="+encodeURIComponent(encodeURIComponent(e)));var u=window.open(e,"_blank",l.join(","));return u&&u.focus&&u.focus(),u},responseHandler:function(e,t){function n(e,t,n){var r=e.callback,s=e.network;if(a.store(s,e),!("display"in e&&"page"===e.display)){if(n&&r&&r in n){try{delete e.callback}catch(l){}a.store(s,e);var u=JSON.stringify(e);try{o(n,r)(u)}catch(l){}}i()}}function o(e,t){return 0!==t.indexOf("_hellojs_")?function(){throw"Could not execute callback "+t}:e[t]}function i(){if(e.frameElement)t.document.body.removeChild(e.frameElement);else{try{e.close()}catch(n){}e.addEventListener&&e.addEventListener("load",function(){e.close()})}}var r,a=this,s=e.location;if(r=a.param(s.search),r&&r.state&&(r.code||r.oauth_token)){var l=JSON.parse(r.state);r.redirect_uri=l.redirect_uri||s.href.replace(/[\?\#].*$/,"");var u=l.oauth_proxy+"?"+a.param(r);return void s.assign(u)}if(r=a.merge(a.param(s.search||""),a.param(s.hash||"")),r&&"state"in r){try{var c=JSON.parse(r.state);a.extend(r,c)}catch(d){console.error("Could not decode state parameter")}if("access_token"in r&&r.access_token&&r.network)r.expires_in&&0!==parseInt(r.expires_in,10)||(r.expires_in=0),r.expires_in=parseInt(r.expires_in,10),r.expires=(new Date).getTime()/1e3+(r.expires_in||31536e3),n(r,e,t);else if("error"in r&&r.error&&r.network)r.error={code:r.error,message:r.error_message||r.error_description},n(r,e,t);else if(r.callback&&r.callback in t){var f="result"in r&&r.result?JSON.parse(r.result):!1;o(t,r.callback)(f),i()}r.page_uri&&s.assign(r.page_uri)}else if("oauth_redirect"in r)return void s.assign(decodeURIComponent(r.oauth_redirect))}}),hello.utils.Event.call(hello),function(e){var t={},n={};e.on("auth.login, auth.logout",function(n){n&&"object"==typeof n&&n.network&&(t[n.network]=e.utils.store(n.network)||{})}),function o(){var i=(new Date).getTime()/1e3,r=function(t){e.emit("auth."+t,{network:a,authResponse:s})};for(var a in e.services)if(e.services.hasOwnProperty(a)){if(!e.services[a].id)continue;var s=e.utils.store(a)||{},l=e.services[a],u=t[a]||{};if(s&&"callback"in s){var c=s.callback;try{delete s.callback}catch(d){}e.utils.store(a,s);try{window[c](s)}catch(d){}}if(s&&"expires"in s&&s.expires<i){var f=l.refresh||s.refresh_token;!f||a in n&&!(n[a]<i)?f||a in n||(r("expired"),n[a]=!0):(e.emit("notice",a+" has expired trying to resignin"),e.login(a,{display:"none",force:!1}),n[a]=i+600);continue}if(u.access_token===s.access_token&&u.expires===s.expires)continue;!s.access_token&&u.access_token?r("logout"):s.access_token&&!u.access_token?r("login"):s.expires!==u.expires&&r("update"),t[a]=s,a in n&&delete n[a]}setTimeout(o,1e3)}()}(hello),hello.api=function(){function e(e){e=e.replace(/\@\{([a-z\_\-]+)(\|.*?)?\}/gi,function(e,t,n){var a=n?n.replace(/^\|/,""):"";return t in r.query?(a=r.query[t],delete r.query[t]):r.data&&t in r.data?(a=r.data[t],delete r.data[t]):n||i.reject(o("missing_attribute","The attribute "+t+" is missing from the request")),a}),e.match(/^https?:\/\//)||(e=u.base+e),r.url=e,n.request(r,function(e,t){if(!r.formatResponse)return void(("object"==typeof t?t.statusCode>=400:"object"==typeof e&&"error"in e)?i.reject(e):i.fulfill(e));if(e===!0?e={success:!0}:e||(e={}),"delete"===r.method&&(e=!e||n.isEmpty(e)?{success:!0}:e),u.wrap&&(r.path in u.wrap||"default"in u.wrap)){var o=r.path in u.wrap?r.path:"default",a=((new Date).getTime(),u.wrap[o](e,t,r));a&&(e=a)}e&&"paging"in e&&e.paging.next&&("?"===e.paging.next[0]?e.paging.next=r.path+e.paging.next:e.paging.next+="#"+r.path),!e||"error"in e?i.reject(e):i.fulfill(e)})}var t=this,n=t.utils,o=n.error,i=n.Promise(),r=n.args({path:"s!",query:"o",method:"s",data:"o",timeout:"i",callback:"f"},arguments);r.method=(r.method||"get").toLowerCase(),r.headers=r.headers||{},r.query=r.query||{},"get"!==r.method&&"delete"!==r.method||(n.extend(r.query,r.data),r.data={});var a=r.data=r.data||{};if(i.then(r.callback,r.callback),!r.path)return i.reject(o("invalid_path","Missing the path parameter from the request"));r.path=r.path.replace(/^\/+/,"");var s=(r.path.split(/[\/\:]/,2)||[])[0].toLowerCase();if(s in t.services){r.network=s;var l=new RegExp("^"+s+":?/?");r.path=r.path.replace(l,"")}r.network=t.settings.default_service=r.network||t.settings.default_service;var u=t.services[r.network];if(!u)return i.reject(o("invalid_network","Could not match the service requested: "+r.network));if(r.method in u&&r.path in u[r.method]&&u[r.method][r.path]===!1)return i.reject(o("invalid_path","The provided path is not available on the selected network"));r.oauth_proxy||(r.oauth_proxy=t.settings.oauth_proxy),"proxy"in r||(r.proxy=r.oauth_proxy&&u.oauth&&1===parseInt(u.oauth.version,10)),"timeout"in r||(r.timeout=t.settings.timeout),"formatResponse"in r||(r.formatResponse=!0),r.authResponse=t.getAuthResponse(r.network),r.authResponse&&r.authResponse.access_token&&(r.query.access_token=r.authResponse.access_token);var c,d=r.path;r.options=n.clone(r.query),r.data=n.clone(a);var f=u[{"delete":"del"}[r.method]||r.method]||{};if("get"===r.method){var p=d.split(/[\?#]/)[1];p&&(n.extend(r.query,n.param(p)),d=d.replace(/\?.*?(#|$)/,"$1"))}return(c=d.match(/#(.+)/,""))?(d=d.split("#")[0],r.path=c[1]):d in f?(r.path=d,d=f[d]):"default"in f&&(d=f["default"]),r.redirect_uri=t.settings.redirect_uri,r.xhr=u.xhr,r.jsonp=u.jsonp,r.form=u.form,"function"==typeof d?d(r,e):e(d),i.proxy},hello.utils.extend(hello.utils,{request:function(e,t){function n(e,t){var n;e.authResponse&&e.authResponse.oauth&&1===parseInt(e.authResponse.oauth.version,10)&&(n=e.query.access_token,delete e.query.access_token,e.proxy=!0),!e.data||"get"!==e.method&&"delete"!==e.method||(o.extend(e.query,e.data),e.data=null);var i=o.qs(e.url,e.query);e.proxy&&(i=o.qs(e.oauth_proxy,{path:i,access_token:n||"",then:e.proxy_response_type||("get"===e.method.toLowerCase()?"redirect":"proxy"),method:e.method.toLowerCase(),suppress_response_codes:!0})),t(i)}var o=this,i=o.error;o.isEmpty(e.data)||"FileList"in window||!o.hasBinary(e.data)||(e.xhr=!1,e.jsonp=!1);var r=this.request_cors(function(){return void 0===e.xhr||e.xhr&&("function"!=typeof e.xhr||e.xhr(e,e.query))});if(r)return void n(e,function(n){var i=o.xhr(e.method,n,e.headers,e.data,t);i.onprogress=e.onprogress||null,i.upload&&e.onuploadprogress&&(i.upload.onprogress=e.onuploadprogress)});var a=e.query;if(e.query=o.clone(e.query),e.callbackID=o.globalEvent(),e.jsonp!==!1){if(e.query.callback=e.callbackID,"function"==typeof e.jsonp&&e.jsonp(e,e.query),"get"===e.method)return void n(e,function(n){o.jsonp(n,t,e.callbackID,e.timeout)});e.query=a}if(e.form!==!1){e.query.redirect_uri=e.redirect_uri,e.query.state=JSON.stringify({callback:e.callbackID});var s;if("function"==typeof e.form&&(s=e.form(e,e.query)),"post"===e.method&&s!==!1)return void n(e,function(n){o.post(n,e.data,s,t,e.callbackID,e.timeout)})}t(i("invalid_request","There was no mechanism for handling this request"))},request_cors:function(e){return"withCredentials"in new XMLHttpRequest&&e()},domInstance:function(e,t){var n="HTML"+(e||"").replace(/^[a-z]/,function(e){return e.toUpperCase()})+"Element";return t?window[n]?t instanceof window[n]:window.Element?t instanceof window.Element&&(!e||t.tagName&&t.tagName.toLowerCase()===e):!(t instanceof Object||t instanceof Array||t instanceof String||t instanceof Number)&&t.tagName&&t.tagName.toLowerCase()===e:!1},clone:function(e){if(null===e||"object"!=typeof e||e instanceof Date||"nodeName"in e||this.isBinary(e)||"function"==typeof FormData&&e instanceof FormData)return e;if(Array.isArray(e))return e.map(this.clone.bind(this));var t={};for(var n in e)t[n]=this.clone(e[n]);return t},xhr:function(e,t,n,o,i){function r(e){for(var t,n={},o=/([a-z\-]+):\s?(.*);?/gi;t=o.exec(e);)n[t[1]]=t[2];return n}var a=new XMLHttpRequest,s=this.error,l=!1;"blob"===e&&(l=e,e="GET"),e=e.toUpperCase(),a.onload=function(t){var n=a.response;try{n=JSON.parse(a.responseText)}catch(o){401===a.status&&(n=s("access_denied",a.statusText))}var l=r(a.getAllResponseHeaders());l.statusCode=a.status,i(n||("GET"===e?s("empty_response","Could not get resource"):{}),l)},a.onerror=function(e){var t=a.responseText;try{t=JSON.parse(a.responseText)}catch(n){}i(t||s("access_denied","Could not get resource"))};var u;if("GET"===e||"DELETE"===e)o=null;else if(o&&"string"!=typeof o&&!(o instanceof FormData)&&!(o instanceof File)&&!(o instanceof Blob)){var c=new FormData;for(u in o)o.hasOwnProperty(u)&&(o[u]instanceof HTMLInputElement?"files"in o[u]&&o[u].files.length>0&&c.append(u,o[u].files[0]):o[u]instanceof Blob?c.append(u,o[u],o.name):c.append(u,o[u]));o=c}if(a.open(e,t,!0),l&&("responseType"in a?a.responseType=l:a.overrideMimeType("text/plain; charset=x-user-defined")),n)for(u in n)a.setRequestHeader(u,n[u]);return a.send(o),a},jsonp:function(e,t,n,o){var i,r=this,a=r.error,s=0,l=document.getElementsByTagName("head")[0],u=a("server_error","server_error"),c=function(){s++||window.setTimeout(function(){t(u),l.removeChild(d)},0)};n=r.globalEvent(function(e){return u=e,!0},n),e=e.replace(new RegExp("=\\?(&|$)"),"="+n+"$1");var d=r.append("script",{id:n,name:n,src:e,async:!0,onload:c,onerror:c,onreadystatechange:function(){/loaded|complete/i.test(this.readyState)&&c()}});window.navigator.userAgent.toLowerCase().indexOf("opera")>-1&&(i=r.append("script",{text:"document.getElementById('"+n+"').onerror();"}),d.async=!1),o&&window.setTimeout(function(){u=a("timeout","timeout"),c()},o),l.appendChild(d),i&&l.appendChild(i)},post:function(e,t,n,o,i,r){var a,s=this,l=s.error,u=document,c=null,d=[],f=0,p=null,m=0,h=function(e){m++||o(e)};s.globalEvent(h,i);var g;try{g=u.createElement('<iframe name="'+i+'">')}catch(v){g=u.createElement("iframe")}if(g.name=i,g.id=i,g.style.display="none",n&&n.callbackonload&&(g.onload=function(){h({response:"posted",message:"Content was posted"})}),r&&setTimeout(function(){h(l("timeout","The post operation timed out"))},r),u.body.appendChild(g),s.domInstance("form",t)){for(c=t.form,f=0;f<c.elements.length;f++)c.elements[f]!==t&&c.elements[f].setAttribute("disabled",!0);t=c}if(s.domInstance("form",t))for(c=t,f=0;f<c.elements.length;f++)c.elements[f].disabled||"file"!==c.elements[f].type||(c.encoding=c.enctype="multipart/form-data",c.elements[f].setAttribute("name","file"));else{for(p in t)t.hasOwnProperty(p)&&s.domInstance("input",t[p])&&"file"===t[p].type&&(c=t[p].form,c.encoding=c.enctype="multipart/form-data");c||(c=u.createElement("form"),u.body.appendChild(c),a=c);var y;for(p in t)if(t.hasOwnProperty(p)){var w=s.domInstance("input",t[p])||s.domInstance("textArea",t[p])||s.domInstance("select",t[p]);if(w&&t[p].form===c)w&&t[p].name!==p&&(t[p].setAttribute("name",p),t[p].name=p);else{var _=c.elements[p];if(y)for(_ instanceof NodeList||(_=[_]),f=0;f<_.length;f++)_[f].parentNode.removeChild(_[f]);y=u.createElement("input"),y.setAttribute("type","hidden"),y.setAttribute("name",p),w?y.value=t[p].value:s.domInstance(null,t[p])?y.value=t[p].innerHTML||t[p].innerText:y.value=t[p],c.appendChild(y)}}for(f=0;f<c.elements.length;f++)y=c.elements[f],y.name in t||y.getAttribute("disabled")===!0||(y.setAttribute("disabled",!0),d.push(y))}c.setAttribute("method","POST"),c.setAttribute("target",i),c.target=i,c.setAttribute("action",e),setTimeout(function(){c.submit(),setTimeout(function(){try{a&&a.parentNode.removeChild(a)}catch(e){try{console.error("HelloJS: could not remove iframe")}catch(t){}}for(var n=0;n<d.length;n++)d[n]&&(d[n].setAttribute("disabled",!1),d[n].disabled=!1)},0)},100)},hasBinary:function(e){for(var t in e)if(e.hasOwnProperty(t)&&this.isBinary(e[t]))return!0;return!1},isBinary:function(e){return e instanceof Object&&(this.domInstance("input",e)&&"file"===e.type||"FileList"in window&&e instanceof window.FileList||"File"in window&&e instanceof window.File||"Blob"in window&&e instanceof window.Blob)},toBlob:function(e){var t=/^data\:([^;,]+(\;charset=[^;,]+)?)(\;base64)?,/i,n=e.match(t);if(!n)return e;for(var o=atob(e.replace(t,"")),i=[],r=0;r<o.length;r++)i.push(o.charCodeAt(r));return new Blob([new Uint8Array(i)],{type:n[1]})}}),function(e){var t=e.api,n=e.utils;n.extend(n,{dataToJSON:function(e){var t=this,n=window,o=e.data;if(t.domInstance("form",o)?o=t.nodeListToJSON(o.elements):"NodeList"in n&&o instanceof NodeList?o=t.nodeListToJSON(o):t.domInstance("input",o)&&(o=t.nodeListToJSON([o])),("File"in n&&o instanceof n.File||"Blob"in n&&o instanceof n.Blob||"FileList"in n&&o instanceof n.FileList)&&(o={file:o}),!("FormData"in n&&o instanceof n.FormData))for(var i in o)if(o.hasOwnProperty(i))if("FileList"in n&&o[i]instanceof n.FileList)1===o[i].length&&(o[i]=o[i][0]);else{if(t.domInstance("input",o[i])&&"file"===o[i].type)continue;t.domInstance("input",o[i])||t.domInstance("select",o[i])||t.domInstance("textArea",o[i])?o[i]=o[i].value:t.domInstance(null,o[i])&&(o[i]=o[i].innerHTML||o[i].innerText)}return e.data=o,o},nodeListToJSON:function(e){for(var t={},n=0;n<e.length;n++){var o=e[n];!o.disabled&&o.name&&("file"===o.type?t[o.name]=o:t[o.name]=o.value||o.innerHTML)}return t}}),e.api=function(){var e=n.args({path:"s!",method:"s",data:"o",timeout:"i",callback:"f"},arguments);return e.data&&n.dataToJSON(e),t.call(this,e)}}(hello),hello.utils.responseHandler(window,window.opener||window.parent),"object"==typeof chrome&&"object"==typeof chrome.identity&&chrome.identity.launchWebAuthFlow&&!function(){function e(t,n){var o={closed:!1};return chrome.identity.launchWebAuthFlow({url:t,interactive:n},function(t){if(void 0===t)return void(o.closed=!0);var n=hello.utils.url(t),i={location:{assign:function(t){e(t,!1)},search:n.search,hash:n.hash,href:n.href},close:function(){}};hello.utils.responseHandler(i,window)}),o}hello.utils.popup=function(t){return e(t,!0)},hello.utils.iframe=function(t){e(t,!1)},hello.utils.request_cors=function(e){return e(),!0};var t={};chrome.storage.local.get("hello",function(e){t=e.hello||{}}),hello.utils.store=function(e,n){return 0===arguments.length?t:1===arguments.length?t[e]||null:n?(t[e]=n,chrome.storage.local.set({hello:t}),n):null===n?(delete t[e],chrome.storage.local.set({hello:t}),null):void 0}}(),function(){if(/^file:\/{3}[^\/]/.test(window.location.href)&&window.cordova){hello.utils.iframe=function(e,t){hello.utils.popup(e,t,{hidden:"yes"})};var e=hello.utils.popup;hello.utils.popup=function(t,n,o){var i=e.call(this,t,n,o);try{if(i&&i.addEventListener){var r=hello.utils.url(n),a=r.origin||r.protocol+"//"+r.hostname;i.addEventListener("loadstart",function(e){var t=e.url;if(0===t.indexOf(a)){var n=hello.utils.url(t),o={location:{assign:function(e){i.executeScript({code:'window.location.href = "'+e+';"'})},search:n.search,hash:n.hash,href:n.href},close:function(){if(i.close){i.close();try{i.closed=!0}catch(e){}}}};hello.utils.responseHandler(o,window)}})}}catch(s){}return i}}}(),function(e){function t(e){e&&"error"in e&&(e.error={code:"server_error",message:e.error.message||e.error})}function n(t,n,o){if(!("object"!=typeof t||"undefined"!=typeof Blob&&t instanceof Blob||"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer||"error"in t)){var i=("app_folder"!==t.root?t.root:"")+t.path.replace(/\&/g,"%26");i=i.replace(/^\//,""),t.thumb_exists&&(t.thumbnail=o.oauth_proxy+"?path="+encodeURIComponent("https://api-content.dropbox.com/1/thumbnails/auto/"+i+"?format=jpeg&size=m")+"&access_token="+o.options.access_token),t.type=t.is_dir?"folder":t.mime_type,t.name=t.path.replace(/.*\//g,""),t.is_dir?t.files=i.replace(/^\//,""):(t.downloadLink=e.settings.oauth_proxy+"?path="+encodeURIComponent("https://api-content.dropbox.com/1/files/auto/"+i)+"&access_token="+o.options.access_token,t.file="https://api-content.dropbox.com/1/files/auto/"+i),t.id||(t.id=t.path.replace(/^\//,""))}}function o(e){return function(t,n){delete t.query.limit,n(e)}}var i={version:"1.0",auth:"https://www.dropbox.com/1/oauth/authorize",request:"https://api.dropbox.com/1/oauth/request_token",token:"https://api.dropbox.com/1/oauth/access_token"},r={version:2,auth:"https://www.dropbox.com/1/oauth2/authorize",grant:"https://api.dropbox.com/1/oauth2/token"};e.init({dropbox:{name:"Dropbox",oauth:r,login:function(t){t.qs.scope="";var n=decodeURIComponent(t.qs.redirect_uri);0===n.indexOf("http:")&&0!==n.indexOf("http://localhost/")?e.services.dropbox.oauth=i:e.services.dropbox.oauth=r,t.options.popup.width=1e3,t.options.popup.height=1e3},base:"https://api.dropbox.com/1/",root:"sandbox",get:{me:"account/info","me/files":o("metadata/auto/@{parent|}"),"me/folder":o("metadata/auto/@{id}"),"me/folders":o("metadata/auto/"),"default":function(e,t){e.path.match("https://api-content.dropbox.com/1/files/")&&(e.method="blob"),t(e.path)}},post:{"me/files":function(t,n){var o=t.data.parent,i=t.data.name;t.data={file:t.data.file},"string"==typeof t.data.file&&(t.data.file=e.utils.toBlob(t.data.file)),n("https://api-content.dropbox.com/1/files_put/auto/"+o+"/"+i)},"me/folders":function(t,n){var o=t.data.name;t.data={},n("fileops/create_folder?root=@{root|sandbox}&"+e.utils.param({path:o}))}},del:{"me/files":"fileops/delete?root=@{root|sandbox}&path=@{id}","me/folder":"fileops/delete?root=@{root|sandbox}&path=@{id}"},wrap:{me:function(e){if(t(e),!e.uid)return e;e.name=e.display_name;var n=e.name.split(" ");return e.first_name=n.shift(),e.last_name=n.join(" "),e.id=e.uid,delete e.uid,delete e.display_name,e},"default":function(e,o,i){return t(e),e.is_dir&&e.contents&&(e.data=e.contents,delete e.contents,e.data.forEach(function(t){t.root=e.root,n(t,o,i)})),n(e,o,i),e.is_deleted&&(e.success=!0),e}},xhr:function(e){if(e.data&&e.data.file){var t=e.data.file;t&&(t.files?e.data=t.files[0]:e.data=t)}return"delete"===e.method&&(e.method="post"),!0},form:function(e,t){delete t.state,delete t.redirect_uri}}})}(hello),function(e){function t(e){return e.id&&(e.thumbnail=e.picture="https://graph.facebook.com/"+e.id+"/picture"),e}function n(e){return"data"in e&&e.data.forEach(t),e}function o(e,t,n){if("boolean"==typeof e&&(e={success:e}),e&&"data"in e){var o=n.query.access_token;if(!(e.data instanceof Array)){var r=e.data;delete e.data,e.data=[r]}e.data.forEach(function(e){e.picture&&(e.thumbnail=e.picture),e.pictures=(e.images||[]).sort(function(e,t){return e.width-t.width}),e.cover_photo&&e.cover_photo.id&&(e.thumbnail=i+e.cover_photo.id+"/picture?access_token="+o),"album"===e.type&&(e.files=e.photos=i+e.id+"/photos"),e.can_upload&&(e.upload_location=i+e.id+"/photos")})}return e}e.init({facebook:{name:"Facebook",oauth:{version:2,auth:"https://www.facebook.com/dialog/oauth/",grant:"https://graph.facebook.com/oauth/access_token"
},scope:{basic:"public_profile",email:"email",share:"user_posts",birthday:"user_birthday",events:"user_events",photos:"user_photos",videos:"user_videos",friends:"user_friends",files:"user_photos,user_videos",publish_files:"user_photos,user_videos,publish_actions",publish:"publish_actions",offline_access:""},refresh:!1,login:function(e){e.options.force&&(e.qs.auth_type="reauthenticate"),e.qs.display=e.options.display||"popup"},logout:function(t,n){var o=e.utils.globalEvent(t),i=encodeURIComponent(e.settings.redirect_uri+"?"+e.utils.param({callback:o,result:JSON.stringify({force:!0}),state:"{}"})),r=(n.authResponse||{}).access_token;return e.utils.iframe("https://www.facebook.com/logout.php?next="+i+"&access_token="+r),r?void 0:!1},base:"https://graph.facebook.com/v2.7/",get:{me:"me?fields=email,first_name,last_name,name,timezone,verified","me/friends":"me/friends","me/following":"me/friends","me/followers":"me/friends","me/share":"me/feed","me/like":"me/likes","me/files":"me/albums","me/albums":"me/albums?fields=cover_photo,name","me/album":"@{id}/photos?fields=picture","me/photos":"me/photos","me/photo":"@{id}","friend/albums":"@{id}/albums","friend/photos":"@{id}/photos"},post:{"me/share":"me/feed","me/photo":"@{id}"},wrap:{me:t,"me/friends":n,"me/following":n,"me/followers":n,"me/albums":o,"me/photos":o,"me/files":o,"default":o},xhr:function(t,n){return"get"!==t.method&&"post"!==t.method||(n.suppress_response_codes=!0),"post"===t.method&&t.data&&"string"==typeof t.data.file&&(t.data.file=e.utils.toBlob(t.data.file)),!0},jsonp:function(t,n){var o=t.method;"get"===o||e.utils.hasBinary(t.data)?"delete"===t.method&&(n.method="delete",t.method="post"):(t.data.method=o,t.method="get")},form:function(e){return{callbackonload:!0}}}});var i="https://graph.facebook.com/"}(hello),function(e){function t(t,n,o){var i=(o?"":"flickr:")+"?method="+t+"&api_key="+e.services.flickr.id+"&format=json";for(var r in n)n.hasOwnProperty(r)&&(i+="&"+r+"="+n[r]);return i}function n(t){var n=e.getAuthResponse("flickr");t(n&&n.user_nsid?n.user_nsid:null)}function o(e,o){return o||(o={}),function(i,r){n(function(n){o.user_id=n,r(t(e,o,!0))})}}function i(e,t){var n="https://www.flickr.com/images/buddyicon.gif";return e.nsid&&e.iconserver&&e.iconfarm&&(n="https://farm"+e.iconfarm+".staticflickr.com/"+e.iconserver+"/buddyicons/"+e.nsid+(t?"_"+t:"")+".jpg"),n}function r(e,t,n,o,i){return i=i?"_"+i:"","https://farm"+t+".staticflickr.com/"+n+"/"+e+"_"+o+i+".jpg"}function a(e){e&&e.stat&&"ok"!=e.stat.toLowerCase()&&(e.error={code:"invalid_request",message:e.message})}function s(e){if(e.photoset||e.photos){var t="photoset"in e?"photoset":"photos";e=u(e,t),d(e),e.data=e.photo,delete e.photo;for(var n=0;n<e.data.length;n++){var o=e.data[n];o.name=o.title,o.picture=r(o.id,o.farm,o.server,o.secret,""),o.pictures=l(o.id,o.farm,o.server,o.secret),o.source=r(o.id,o.farm,o.server,o.secret,"b"),o.thumbnail=r(o.id,o.farm,o.server,o.secret,"m")}}return e}function l(e,t,n,o){var i=2048,a=[{id:"t",max:100},{id:"m",max:240},{id:"n",max:320},{id:"",max:500},{id:"z",max:640},{id:"c",max:800},{id:"b",max:1024},{id:"h",max:1600},{id:"k",max:2048},{id:"o",max:i}];return a.map(function(i){return{source:r(e,t,n,o,i.id),width:i.max,height:i.max}})}function u(e,t){return t in e?e=e[t]:"error"in e||(e.error={code:"invalid_request",message:e.message||"Failed to get data from Flickr"}),e}function c(e){if(a(e),e.contacts){e=u(e,"contacts"),d(e),e.data=e.contact,delete e.contact;for(var t=0;t<e.data.length;t++){var n=e.data[t];n.id=n.nsid,n.name=n.realname||n.username,n.thumbnail=i(n,"m")}}return e}function d(e){e.page&&e.pages&&e.page!==e.pages&&(e.paging={next:"?page="+ ++e.page})}e.init({flickr:{name:"Flickr",oauth:{version:"1.0a",auth:"https://www.flickr.com/services/oauth/authorize?perms=read",request:"https://www.flickr.com/services/oauth/request_token",token:"https://www.flickr.com/services/oauth/access_token"},base:"https://api.flickr.com/services/rest",get:{me:o("flickr.people.getInfo"),"me/friends":o("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/following":o("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/followers":o("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/albums":o("flickr.photosets.getList",{per_page:"@{limit|50}"}),"me/album":o("flickr.photosets.getPhotos",{photoset_id:"@{id}"}),"me/photos":o("flickr.people.getPhotos",{per_page:"@{limit|50}"})},wrap:{me:function(e){if(a(e),e=u(e,"person"),e.id){if(e.realname){e.name=e.realname._content;var t=e.name.split(" ");e.first_name=t.shift(),e.last_name=t.join(" ")}e.thumbnail=i(e,"l"),e.picture=i(e,"l")}return e},"me/friends":c,"me/followers":c,"me/following":c,"me/albums":function(e){return a(e),e=u(e,"photosets"),d(e),e.photoset&&(e.data=e.photoset,e.data.forEach(function(e){e.name=e.title._content,e.photos="https://api.flickr.com/services/rest"+t("flickr.photosets.getPhotos",{photoset_id:e.id},!0)}),delete e.photoset),e},"me/photos":function(e){return a(e),s(e)},"default":function(e){return a(e),s(e)}},xhr:!1,jsonp:function(e,t){"get"==e.method&&(delete t.callback,t.jsoncallback=e.callbackID)}}})}(hello),function(e){function t(e){!e.meta||400!==e.meta.code&&401!==e.meta.code||(e.error={code:"access_denied",message:e.meta.errorDetail})}function n(e){e&&e.id&&(e.thumbnail=e.photo.prefix+"100x100"+e.photo.suffix,e.name=e.firstName+" "+e.lastName,e.first_name=e.firstName,e.last_name=e.lastName,e.contact&&e.contact.email&&(e.email=e.contact.email))}function o(e,t){var n=t.access_token;return delete t.access_token,t.oauth_token=n,t.v=20121125,!0}e.init({foursquare:{name:"Foursquare",oauth:{version:2,auth:"https://foursquare.com/oauth2/authenticate",grant:"https://foursquare.com/oauth2/access_token"},refresh:!0,base:"https://api.foursquare.com/v2/",get:{me:"users/self","me/friends":"users/self/friends","me/followers":"users/self/friends","me/following":"users/self/friends"},wrap:{me:function(e){return t(e),e&&e.response&&(e=e.response.user,n(e)),e},"default":function(e){return t(e),e&&"response"in e&&"friends"in e.response&&"items"in e.response.friends&&(e.data=e.response.friends.items,e.data.forEach(n),delete e.response),e}},xhr:o,jsonp:o}})}(hello),function(e){function t(e,t){var n=t?t.statusCode:e&&"meta"in e&&"status"in e.meta&&e.meta.status;401!==n&&403!==n||(e.error={code:"access_denied",message:e.message||(e.data?e.data.message:"Could not get response")},delete e.message)}function n(e){e.id&&(e.thumbnail=e.picture=e.avatar_url,e.name=e.login)}function o(e,t,n){if(e.data&&e.data.length&&t&&t.Link){var o=t.Link.match(/<(.*?)>;\s*rel=\"next\"/);o&&(e.paging={next:o[1]})}}e.init({github:{name:"GitHub",oauth:{version:2,auth:"https://github.com/login/oauth/authorize",grant:"https://github.com/login/oauth/access_token",response_type:"code"},scope:{email:"user:email"},base:"https://api.github.com/",get:{me:"user","me/friends":"user/following?per_page=@{limit|100}","me/following":"user/following?per_page=@{limit|100}","me/followers":"user/followers?per_page=@{limit|100}","me/like":"user/starred?per_page=@{limit|100}"},wrap:{me:function(e,o){return t(e,o),n(e),e},"default":function(e,i,r){return t(e,i),Array.isArray(e)&&(e={data:e}),e.data&&(o(e,i,r),e.data.forEach(n)),e}},xhr:function(e){return"get"!==e.method&&e.data&&(e.headers=e.headers||{},e.headers["Content-Type"]="application/json","object"==typeof e.data&&(e.data=JSON.stringify(e.data))),!0}}})}(hello),function(e){function t(e){return parseInt(e,10)}function n(e){return c(e),e.data=e.items,delete e.items,e}function o(e){return e.error?void 0:(e.name||(e.name=e.title||e.message),e.picture||(e.picture=e.thumbnailLink),e.thumbnail||(e.thumbnail=e.thumbnailLink),"application/vnd.google-apps.folder"===e.mimeType&&(e.type="folder",e.files="https://www.googleapis.com/drive/v2/files?q=%22"+e.id+"%22+in+parents"),e)}function i(e){return{source:e.url,width:e.width,height:e.height}}function r(e){e.data=e.feed.entry.map(u),delete e.feed}function a(e){if(c(e),"feed"in e&&"entry"in e.feed)e.data=e.feed.entry.map(u),delete e.feed;else{if("entry"in e)return u(e.entry);"items"in e?(e.data=e.items.map(o),delete e.items):o(e)}return e}function s(e){e.name=e.displayName||e.name,e.picture=e.picture||(e.image?e.image.url:null),e.thumbnail=e.picture}function l(e,t,n){c(e);if("feed"in e&&"entry"in e.feed){for(var o=n.query.access_token,i=0;i<e.feed.entry.length;i++){var r=e.feed.entry[i];if(r.id=r.id.$t,r.name=r.title.$t,delete r.title,r.gd$email&&(r.email=r.gd$email&&r.gd$email.length>0?r.gd$email[0].address:null,r.emails=r.gd$email,delete r.gd$email),r.updated&&(r.updated=r.updated.$t),r.link){var a=r.link.length>0?r.link[0].href:null;a&&r.link[0].gd$etag&&(a+=(a.indexOf("?")>-1?"&":"?")+"access_token="+o,r.picture=a,r.thumbnail=a),delete r.link}r.category&&delete r.category}e.data=e.feed.entry,delete e.feed}return e}function u(e){var t,n=e.media$group,o=n.media$content.length?n.media$content[0]:{},r=n.media$content||[],a=n.media$thumbnail||[],s=r.concat(a).map(i).sort(function(e,t){return e.width-t.width}),l=0,u={id:e.id.$t,name:e.title.$t,description:e.summary.$t,updated_time:e.updated.$t,created_time:e.published.$t,picture:o?o.url:null,pictures:s,images:[],thumbnail:o?o.url:null,width:o.width,height:o.height};if("link"in e)for(l=0;l<e.link.length;l++){var c=e.link[l];if(c.rel.match(/\#feed$/)){u.upload_location=u.files=u.photos=c.href;break}}if("category"in e&&e.category.length)for(t=e.category,l=0;l<t.length;l++)t[l].scheme&&t[l].scheme.match(/\#kind$/)&&(u.type=t[l].term.replace(/^.*?\#/,""));return"media$thumbnail"in n&&n.media$thumbnail.length&&(t=n.media$thumbnail,u.thumbnail=t[0].url,u.images=t.map(i)),t=n.media$content,t&&t.length&&u.images.push(i(t[0])),u}function c(e){if("feed"in e&&e.feed.openSearch$itemsPerPage){var n=t(e.feed.openSearch$itemsPerPage.$t),o=t(e.feed.openSearch$startIndex.$t),i=t(e.feed.openSearch$totalResults.$t);i>o+n&&(e.paging={next:"?start="+(o+n)})}else"nextPageToken"in e&&(e.paging={next:"?pageToken="+e.nextPageToken})}function d(){function e(e){var n=new FileReader;n.onload=function(n){t(btoa(n.target.result),e.type+r+"Content-Transfer-Encoding: base64")},n.readAsBinaryString(e)}function t(e,t){n.push(r+"Content-Type: "+t+r+r+e),i--,s()}var n=[],o=(1e10*Math.random()).toString(32),i=0,r="\r\n",a=r+"--"+o,s=function(){},l=/^data\:([^;,]+(\;charset=[^;,]+)?)(\;base64)?,/i;this.append=function(n,o){"string"!=typeof n&&"length"in Object(n)||(n=[n]);for(var a=0;a<n.length;a++){i++;var s=n[a];if("undefined"!=typeof File&&s instanceof File||"undefined"!=typeof Blob&&s instanceof Blob)e(s);else if("string"==typeof s&&s.match(l)){var u=s.match(l);t(s.replace(l,""),u[1]+r+"Content-Transfer-Encoding: base64")}else t(s,o)}},this.onready=function(e){(s=function(){0===i&&(n.unshift(""),n.push("--"),e(n.join(a),o),n=[])})()}}function f(e,t){var n={};e.data&&"undefined"!=typeof HTMLInputElement&&e.data instanceof HTMLInputElement&&(e.data={file:e.data}),!e.data.name&&Object(Object(e.data.file).files).length&&"post"===e.method&&(e.data.name=e.data.file.files[0].name),"post"===e.method?e.data={title:e.data.name,parents:[{id:e.data.parent||"root"}],file:e.data.file}:(n=e.data,e.data={},n.parent&&(e.data.parents=[{id:e.data.parent||"root"}]),n.file&&(e.data.file=n.file),n.name&&(e.data.title=n.name));var o;if("file"in e.data&&(o=e.data.file,delete e.data.file,"object"==typeof o&&"files"in o&&(o=o.files),!o||!o.length))return void t({error:{code:"request_invalid",message:"There were no files attached with this request to upload"}});var i=new d;i.append(JSON.stringify(e.data),"application/json"),o&&i.append(o),i.onready(function(o,i){e.headers["content-type"]='multipart/related; boundary="'+i+'"',e.data=o,t("upload/drive/v2/files"+(n.id?"/"+n.id:"")+"?uploadType=multipart")})}function p(e){if("object"==typeof e.data)try{e.data=JSON.stringify(e.data),e.headers["content-type"]="application/json"}catch(t){}}var m="https://www.google.com/m8/feeds/contacts/default/full?v=3.0&alt=json&max-results=@{limit|1000}&start-index=@{start|1}";e.init({google:{name:"Google Plus",oauth:{version:2,auth:"https://accounts.google.com/o/oauth2/auth",grant:"https://accounts.google.com/o/oauth2/token"},scope:{basic:"https://www.googleapis.com/auth/plus.me profile",email:"email",birthday:"",events:"",photos:"https://picasaweb.google.com/data/",videos:"http://gdata.youtube.com",friends:"https://www.google.com/m8/feeds, https://www.googleapis.com/auth/plus.login",files:"https://www.googleapis.com/auth/drive.readonly",publish:"",publish_files:"https://www.googleapis.com/auth/drive",share:"",create_event:"",offline_access:""},scope_delim:" ",login:function(e){"code"===e.qs.response_type&&(e.qs.access_type="offline"),e.options.force&&(e.qs.approval_prompt="force")},base:"https://www.googleapis.com/",get:{me:"plus/v1/people/me","me/friends":"plus/v1/people/me/people/visible?maxResults=@{limit|100}","me/following":m,"me/followers":m,"me/contacts":m,"me/share":"plus/v1/people/me/activities/public?maxResults=@{limit|100}","me/feed":"plus/v1/people/me/activities/public?maxResults=@{limit|100}","me/albums":"https://picasaweb.google.com/data/feed/api/user/default?alt=json&max-results=@{limit|100}&start-index=@{start|1}","me/album":function(e,t){var n=e.query.id;delete e.query.id,t(n.replace("/entry/","/feed/"))},"me/photos":"https://picasaweb.google.com/data/feed/api/user/default?alt=json&kind=photo&max-results=@{limit|100}&start-index=@{start|1}","me/file":"drive/v2/files/@{id}","me/files":"drive/v2/files?q=%22@{parent|root}%22+in+parents+and+trashed=false&maxResults=@{limit|100}","me/folders":"drive/v2/files?q=%22@{id|root}%22+in+parents+and+mimeType+=+%22application/vnd.google-apps.folder%22+and+trashed=false&maxResults=@{limit|100}","me/folder":"drive/v2/files?q=%22@{id|root}%22+in+parents+and+trashed=false&maxResults=@{limit|100}"},post:{"me/files":f,"me/folders":function(e,t){e.data={title:e.data.name,parents:[{id:e.data.parent||"root"}],mimeType:"application/vnd.google-apps.folder"},t("drive/v2/files")}},put:{"me/files":f},del:{"me/files":"drive/v2/files/@{id}","me/folder":"drive/v2/files/@{id}"},patch:{"me/file":"drive/v2/files/@{id}"},wrap:{me:function(e){return e.id&&(e.last_name=e.family_name||(e.name?e.name.familyName:null),e.first_name=e.given_name||(e.name?e.name.givenName:null),e.emails&&e.emails.length&&(e.email=e.emails[0].value),s(e)),e},"me/friends":function(e){return e.items&&(c(e),e.data=e.items,e.data.forEach(s),delete e.items),e},"me/contacts":l,"me/followers":l,"me/following":l,"me/share":n,"me/feed":n,"me/albums":a,"me/photos":r,"default":a},xhr:function(t){return"post"===t.method||"put"===t.method?p(t):"patch"===t.method&&(e.utils.extend(t.query,t.data),t.data=null),!0},form:!1}})}(hello),function(e){function t(e){return{source:e.url,width:e.width,height:e.height}}function n(e){return"string"==typeof e?{error:{code:"invalid_request",message:e}}:(e&&"meta"in e&&"error_type"in e.meta&&(e.error={code:e.meta.error_type,message:e.meta.error_message}),e)}function o(e){return r(e),e&&"data"in e&&e.data.forEach(i),e}function i(e){e.id&&(e.thumbnail=e.profile_picture,e.name=e.full_name||e.username)}function r(e){"pagination"in e&&(e.paging={next:e.pagination.next_url},delete e.pagination)}e.init({instagram:{name:"Instagram",oauth:{version:2,auth:"https://instagram.com/oauth/authorize/",grant:"https://api.instagram.com/oauth/access_token"},refresh:!0,scope:{basic:"basic",photos:"",friends:"relationships",publish:"likes comments",email:"",share:"",publish_files:"",files:"",videos:"",offline_access:""},scope_delim:" ",base:"https://api.instagram.com/v1/",get:{me:"users/self","me/feed":"users/self/feed?count=@{limit|100}","me/photos":"users/self/media/recent?min_id=0&count=@{limit|100}","me/friends":"users/self/follows?count=@{limit|100}","me/following":"users/self/follows?count=@{limit|100}","me/followers":"users/self/followed-by?count=@{limit|100}","friend/photos":"users/@{id}/media/recent?min_id=0&count=@{limit|100}"},post:{"me/like":function(e,t){var n=e.data.id;e.data={},t("media/"+n+"/likes")}},del:{"me/like":"media/@{id}/likes"},wrap:{me:function(e){return n(e),"data"in e&&(e.id=e.data.id,e.thumbnail=e.data.profile_picture,e.name=e.data.full_name||e.data.username),e},"me/friends":o,"me/following":o,"me/followers":o,"me/photos":function(e){return n(e),r(e),"data"in e&&(e.data=e.data.filter(function(e){return"image"===e.type}),e.data.forEach(function(e){e.name=e.caption?e.caption.text:null,e.thumbnail=e.images.thumbnail.url,e.picture=e.images.standard_resolution.url,e.pictures=Object.keys(e.images).map(function(n){var o=e.images[n];return t(o)}).sort(function(e,t){return e.width-t.width})})),e},"default":function(e){return e=n(e),r(e),e}},xhr:function(e,t){var n=e.method,o="get"!==n;return o&&("post"!==n&&"put"!==n||!e.query.access_token||(e.data.access_token=e.query.access_token,delete e.query.access_token),e.proxy=o),o},form:!1}})}(hello),function(e){function t(e,t){var n,i;return e&&"Message"in e&&(i=e.Message,delete e.Message,"ErrorCode"in e?(n=e.ErrorCode,delete e.ErrorCode):n=o(t),e.error={code:n,message:i,details:e}),e}function n(e,t){var n=t.access_token;return delete t.access_token,e.headers.Authorization="Bearer "+n,"get"!==e.method&&e.data&&(e.headers["Content-Type"]="application/json","object"==typeof e.data&&(e.data=JSON.stringify(e.data))),"put"===e.method&&(e.method="patch"),!0}function o(e){switch(e.statusCode){case 400:return"invalid_request";case 403:return"stale_token";case 401:return"invalid_token";case 500:return"server_error";default:return"server_error"}}e.init({joinme:{name:"join.me",oauth:{version:2,auth:"https://secure.join.me/api/public/v1/auth/oauth2",grant:"https://secure.join.me/api/public/v1/auth/oauth2"},refresh:!1,scope:{basic:"user_info",user:"user_info",scheduler:"scheduler",start:"start_meeting",email:"",friends:"",share:"",publish:"",photos:"",publish_files:"",files:"",videos:"",offline_access:""},scope_delim:" ",login:function(e){e.options.popup.width=400,e.options.popup.height=700},base:"https://api.join.me/v1/",get:{me:"user",meetings:"meetings","meetings/info":"meetings/@{id}"},post:{"meetings/start/adhoc":function(e,t){t("meetings/start")},"meetings/start/scheduled":function(e,t){var n=e.data.meetingId;e.data={},t("meetings/"+n+"/start")},"meetings/schedule":function(e,t){t("meetings")}},patch:{"meetings/update":function(e,t){t("meetings/"+e.data.meetingId)}},del:{"meetings/delete":"meetings/@{id}"},wrap:{me:function(e,n){return t(e,n),e.email?(e.name=e.fullName,e.first_name=e.name.split(" ")[0],e.last_name=e.name.split(" ")[1],e.id=e.email,e):e},"default":function(e,n){return t(e,n),e}},xhr:n}})}(hello),function(e){function t(e){e&&"errorCode"in e&&(e.error={code:e.status,message:e.message})}function n(e){return e.error?void 0:(e.first_name=e.firstName,e.last_name=e.lastName,e.name=e.formattedName||e.first_name+" "+e.last_name,e.thumbnail=e.pictureUrl,e.email=e.emailAddress,e)}function o(e){return t(e),i(e),e.values&&(e.data=e.values.map(n),delete e.values),e}function i(e){"_count"in e&&"_start"in e&&e._count+e._start<e._total&&(e.paging={next:"?start="+(e._start+e._count)+"&count="+e._count})}function r(e,t){"{}"===JSON.stringify(e)&&200===t.statusCode&&(e.success=!0)}function a(e){e.access_token&&(e.oauth2_access_token=e.access_token,delete e.access_token)}function s(e,t){e.headers["x-li-format"]="json";var n=e.data.id;e.data=("delete"!==e.method).toString(),e.method="put",t("people/~/network/updates/key="+n+"/is-liked")}e.init({linkedin:{oauth:{version:2,response_type:"code",auth:"https://www.linkedin.com/uas/oauth2/authorization",grant:"https://www.linkedin.com/uas/oauth2/accessToken"},refresh:!0,scope:{basic:"r_basicprofile",email:"r_emailaddress",files:"",friends:"",photos:"",publish:"w_share",publish_files:"w_share",share:"",videos:"",offline_access:""},scope_delim:" ",base:"https://api.linkedin.com/v1/",get:{me:"people/~:(picture-url,first-name,last-name,id,formatted-name,email-address)","me/share":"people/~/network/updates?count=@{limit|250}"},post:{"me/share":function(e,t){var n={visibility:{code:"anyone"}};e.data.id?n.attribution={share:{id:e.data.id}}:(n.comment=e.data.message,e.data.picture&&e.data.link&&(n.content={"submitted-url":e.data.link,"submitted-image-url":e.data.picture})),e.data=JSON.stringify(n),t("people/~/shares?format=json")},"me/like":s},del:{"me/like":s},wrap:{me:function(e){return t(e),n(e),e},"me/friends":o,"me/following":o,"me/followers":o,"me/share":function(e){return t(e),i(e),e.values&&(e.data=e.values.map(n),e.data.forEach(function(e){e.message=e.headline}),delete e.values),e},"default":function(e,n){t(e),r(e,n),i(e)}},jsonp:function(e,t){a(t),"get"===e.method&&(t.format="jsonp",t["error-callback"]=e.callbackID)},xhr:function(e,t){return"get"!==e.method?(a(t),e.headers["Content-Type"]="application/json",e.headers["x-li-format"]="json",e.proxy=!0,!0):!1}}})}(hello),function(e){function t(e,t){var n=t.access_token;return delete t.access_token,t.oauth_token=n,t["_status_code_map[302]"]=200,!0}function n(e){return e.id&&(e.picture=e.avatar_url,e.thumbnail=e.avatar_url,e.name=e.username||e.full_name),e}function o(e){"next_href"in e&&(e.paging={next:e.next_href})}e.init({soundcloud:{name:"SoundCloud",oauth:{version:2,auth:"https://soundcloud.com/connect",grant:"https://soundcloud.com/oauth2/token"},base:"https://api.soundcloud.com/",get:{me:"me.json","me/friends":"me/followings.json","me/followers":"me/followers.json","me/following":"me/followings.json","default":function(e,t){t(e.path+".json")}},wrap:{me:function(e){return n(e),e},"default":function(e){return Array.isArray(e)&&(e={data:e.map(n)}),o(e),e}},xhr:t,jsonp:t}})}(hello),function(e){function t(e){if(e.id){if(e.name){var t=e.name.split(" ");e.first_name=t.shift(),e.last_name=t.join(" ")}e.thumbnail=e.profile_image_url_https||e.profile_image_url}return e}function n(e){return o(e),i(e),e.users&&(e.data=e.users.map(t),delete e.users),e}function o(e){if(e.errors){var t=e.errors[0];e.error={code:"request_failed",message:t.message}}}function i(e){"next_cursor_str"in e&&(e.paging={next:"?cursor="+e.next_cursor_str})}function r(e){return Array.isArray(e)?{data:e}:e}var a="https://api.twitter.com/";e.init({twitter:{oauth:{version:"1.0a",auth:a+"oauth/authenticate",request:a+"oauth/request_token",token:a+"oauth/access_token"},login:function(e){var t="?force_login=true";this.oauth.auth=this.oauth.auth.replace(t,"")+(e.options.force?t:"")},base:a+"1.1/",get:{me:"account/verify_credentials.json","me/friends":"friends/list.json?count=@{limit|200}","me/following":"friends/list.json?count=@{limit|200}","me/followers":"followers/list.json?count=@{limit|200}","me/share":"statuses/user_timeline.json?count=@{limit|200}","me/like":"favorites/list.json?count=@{limit|200}"},post:{"me/share":function(t,n){var o=t.data;t.data=null;var i=[];o.message&&(i.push(o.message),delete o.message),o.link&&(i.push(o.link),delete o.link),o.picture&&(i.push(o.picture),delete o.picture),i.length&&(o.status=i.join(" ")),o.file?(o["media[]"]=o.file,delete o.file,t.data=o,n("statuses/update_with_media.json")):"id"in o?n("statuses/retweet/"+o.id+".json"):(e.utils.extend(t.query,o),n("statuses/update.json?include_entities=1"))},"me/like":function(e,t){var n=e.data.id;e.data=null,t("favorites/create.json?id="+n)}},del:{"me/like":function(){p.method="post";var e=p.data.id;p.data=null,callback("favorites/destroy.json?id="+e)}},wrap:{me:function(e){return o(e),t(e),e},"me/friends":n,"me/followers":n,"me/following":n,"me/share":function(e){return o(e),i(e),!e.error&&"length"in e?{data:e}:e},"default":function(e){return e=r(e),i(e),e}},xhr:function(e){return"get"!==e.method}}})}(hello),function(e){function t(e,t){return null!==e&&"response"in e&&null!==e.response&&e.response.length&&(e=e.response[0],e.id=e.uid,e.thumbnail=e.picture=e.photo_max,e.name=e.first_name+" "+e.last_name,t.authResponse&&null!==t.authResponse.email&&(e.email=t.authResponse.email)),e}function n(e){if(e.error){var t=e.error;e.error={code:t.error_code,message:t.error_msg}}}e.init({vk:{name:"Vk",oauth:{version:2,auth:"https://oauth.vk.com/authorize",grant:"https://oauth.vk.com/access_token"},scope:{email:"email",friends:"friends",photos:"photos",videos:"video",share:"share",offline_access:"offline"},refresh:!0,login:function(e){e.qs.display=window.navigator&&window.navigator.userAgent&&/ipad|phone|phone|android/.test(window.navigator.userAgent.toLowerCase())?"mobile":"popup"},base:"https://api.vk.com/method/",get:{me:function(e,t){e.query.fields="id,first_name,last_name,photo_max",t("users.get")}},wrap:{me:function(e,o,i){return n(e),t(e,i)}},xhr:!1,jsonp:!0,form:!1}})}(hello),function(e){function t(e){return"data"in e&&e.data.forEach(function(e){e.picture&&(e.thumbnail=e.picture),e.images&&(e.pictures=e.images.map(n).sort(function(e,t){return e.width-t.width}))}),e}function n(e){return{width:e.width,height:e.height,source:e.source}}function o(e){return"data"in e&&e.data.forEach(function(e){e.photos=e.files="https://apis.live.net/v5.0/"+e.id+"/photos"}),e}function i(e,t,n){if(e.id){var o=n.query.access_token;if(e.emails&&(e.email=e.emails.preferred),e.is_friend!==!1){var i=e.user_id||e.id;e.thumbnail=e.picture="https://apis.live.net/v5.0/"+i+"/picture?access_token="+o}}return e}function r(e,t,n){return"data"in e&&e.data.forEach(function(e){i(e,t,n)}),e}e.init({windows:{name:"Windows live",oauth:{version:2,auth:"https://login.live.com/oauth20_authorize.srf",grant:"https://login.live.com/oauth20_token.srf"},refresh:!0,logout:function(){return"http://login.live.com/oauth20_logout.srf?ts="+(new Date).getTime()},scope:{basic:"wl.signin,wl.basic",email:"wl.emails",birthday:"wl.birthday",events:"wl.calendars",photos:"wl.photos",videos:"wl.photos",friends:"wl.contacts_emails",files:"wl.skydrive",publish:"wl.share",publish_files:"wl.skydrive_update",share:"wl.share",create_event:"wl.calendars_update,wl.events_create",offline_access:"wl.offline_access"},base:"https://apis.live.net/v5.0/",get:{me:"me","me/friends":"me/friends","me/following":"me/contacts","me/followers":"me/friends","me/contacts":"me/contacts","me/albums":"me/albums","me/album":"@{id}/files","me/photo":"@{id}","me/files":"@{parent|me/skydrive}/files","me/folders":"@{id|me/skydrive}/files","me/folder":"@{id|me/skydrive}/files"},post:{"me/albums":"me/albums","me/album":"@{id}/files/","me/folders":"@{id|me/skydrive/}","me/files":"@{parent|me/skydrive}/files"},del:{"me/album":"@{id}","me/photo":"@{id}","me/folder":"@{id}","me/files":"@{id}"},wrap:{me:i,"me/friends":r,"me/contacts":r,"me/followers":r,"me/following":r,"me/albums":o,"me/photos":t,"default":t},xhr:function(t){return"get"===t.method||"delete"===t.method||e.utils.hasBinary(t.data)||("string"==typeof t.data.file?t.data.file=e.utils.toBlob(t.data.file):(t.data=JSON.stringify(t.data),t.headers={"Content-Type":"application/json"})),!0},jsonp:function(t){"get"===t.method||e.utils.hasBinary(t.data)||(t.data.method=t.method,t.method="get")}}})}(hello),function(e){function t(e){e&&"meta"in e&&"error_type"in e.meta&&(e.error={code:e.meta.error_type,message:e.meta.error_message})}function n(e){if(t(e),e.query&&e.query.results&&e.query.results.profile){e=e.query.results.profile,e.id=e.guid,e.last_name=e.familyName,e.first_name=e.givenName||e.nickname;var n=[];e.first_name&&n.push(e.first_name),e.last_name&&n.push(e.last_name),e.name=n.join(" "),e.email=e.emails&&e.emails[0]?e.emails[0].handle:null,e.thumbnail=e.image?e.image.imageUrl:null}return e}function o(e,n,o){t(e),r(e,n,o);return e.query&&e.query.results&&e.query.results.contact&&(e.data=e.query.results.contact,delete e.query,Array.isArray(e.data)||(e.data=[e.data]),e.data.forEach(i)),e}function i(e){e.id=null,!e.fields||e.fields instanceof Array||(e.fields=[e.fields]),(e.fields||[]).forEach(function(t){"email"===t.type&&(e.email=t.value),"name"===t.type&&(e.first_name=t.value.givenName,e.last_name=t.value.familyName,e.name=t.value.givenName+" "+t.value.familyName),"yahooid"===t.type&&(e.id=t.value)})}function r(e,t,n){return e.query&&e.query.count&&n.options&&(e.paging={next:"?start="+(e.query.count+(+n.options.start||1))}),e}function a(e){return"https://query.yahooapis.com/v1/yql?q="+(e+" limit @{limit|100} offset @{start|0}").replace(/\s/g,"%20")+"&format=json"}e.init({yahoo:{oauth:{version:"1.0a",auth:"https://api.login.yahoo.com/oauth/v2/request_auth",request:"https://api.login.yahoo.com/oauth/v2/get_request_token",token:"https://api.login.yahoo.com/oauth/v2/get_token"},login:function(e){e.options.popup.width=560;try{delete e.qs.state.scope}catch(t){}},base:"https://social.yahooapis.com/v1/",get:{me:a("select * from social.profile(0) where guid=me"),"me/friends":a("select * from social.contacts(0) where guid=me"),"me/following":a("select * from social.contacts(0) where guid=me")},wrap:{me:n,"me/friends":o,"me/following":o,"default":r}}})}(hello),"function"==typeof define&&define.amd&&define(function(){return hello}),"object"==typeof module&&module.exports&&(module.exports=hello);
// ------------------------------------------------------------------------------
//  Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.  See License in the project root for license information.
// ------------------------------------------------------------------------------

'use strict';

angular.module('ApiExplorer', ['ngAnimate', 'ngMaterial'])
    .config(['$mdThemingProvider', function ($mdThemingProvider) {

    $mdThemingProvider.definePalette('O365PrimaryPalette', {
            '50': 'e9f0fc',
            '100': 'd3e2f8',
            '200': 'bdd3f5',
            '300': '91b6ee', 
            '400': '6599e7',
            '500': '4685e2', //blue
            '600': '387be0',
            '700': '226ddd',
            '800': '1f62c7', 
            '900': '1c57b0',
            'A100': 'FF6A00', 
            'A200': 'FF6A00', 
            'A400': 'FF6A00', 
            'A700': 'FF6A00', 
            'contrastDefaultColor': 'light',   
            'contrastDarkColors': ['50', '100', 
                '200', '300', '400', 'A100'],
            'contrastLightColors': undefined 
    });
    
    $mdThemingProvider.definePalette('O365AccentPalette', {
            '50': 'ffc499',
            '100': 'ffb580',
            '200': 'ffa666',
            '300': 'ff974d', 
            '400': 'ff8833',
            '500': 'FF6A00', //orange
            '600': 'e66000',
            '700': 'cc5500',
            '800': 'b34a00', 
            '900': '994000',
            'A100': 'FF6A00',
            'A200': 'FF6A00', 
            'A400': 'FF6A00', 
            'A700': 'FF6A00', 
    });

    $mdThemingProvider.theme('default').primaryPalette('O365PrimaryPalette');
    $mdThemingProvider.theme('default').accentPalette('O365AccentPalette');
}]);
'use strict';
function run($scope, url, apiService) {
    $scope.$emit('urlChange', url);
}
function formatXml(xml) {
    var reg = /(>)\s*(<)(\/*)/g;
    var wsexp = / *(.*) +\n/g;
    var contexp = /(<.+>)(.+\n)/g;
    xml = xml.replace(reg, '$1\n$2$3').replace(wsexp, '$1\n').replace(contexp, '$1\n$2');
    var pad = 0;
    var formatted = '';
    var lines = xml.split('\n');
    var indent = 0;
    var lastType = 'other';
    var transitions = {
        'single->single': 0,
        'single->closing': -1,
        'single->opening': 0,
        'single->other': 0,
        'closing->single': 0,
        'closing->closing': -1,
        'closing->opening': 0,
        'closing->other': 0,
        'opening->single': 1,
        'opening->closing': 0,
        'opening->opening': 1,
        'opening->other': 1,
        'other->single': 0,
        'other->closing': -1,
        'other->opening': 0,
        'other->other': 0
    };
    for (var i = 0; i < lines.length; i++) {
        var ln = lines[i];
        var single = Boolean(ln.match(/<.+\/>/));
        var closing = Boolean(ln.match(/<\/.+>/));
        var opening = Boolean(ln.match(/<[^!].*>/));
        var type = single ? 'single' : closing ? 'closing' : opening ? 'opening' : 'other';
        var fromTo = lastType + '->' + type;
        lastType = type;
        var padding = '';
        indent += transitions[fromTo];
        for (var j = 0; j < indent; j++) {
            padding += '\t';
        }
        if (fromTo == 'opening->closing')
            formatted = formatted.substr(0, formatted.length - 1) + ln + '\n';
        else
            formatted += padding + ln + '\n';
    }
    return formatted;
}
;
function insertHeadersIntoResponseViewer(headers, status) {
    var responseObj = {};
    if (headers != null) {
        responseObj = headers();
    }
    responseObj["Status Code"] = status;
    var headersArr = [];
    for (var headerName in responseObj) {
        headersArr.push(headerName + ": " + responseObj[headerName]);
    }
    getJsonViewer().getSession().setValue("");
    getJsonViewer().getSession().insert(0, headersArr.join("\n"));
}
function showResults(results, headers, status, responseContentType) {
    getJsonViewer().setValue("");
    insertHeadersIntoResponseViewer(headers, status);
    getJsonViewer().getSession().insert(0, results);
    if (responseContentType)
        getJsonViewer().getSession().setMode("ace/mode/" + responseContentType);
}
function handleImageResponse($scope, apiService, startTime, headers, status, handleUnsuccessfulQueryResponse) {
    apiService.performQuery('GET_BINARY')($scope.getSearchText()).then(function (result) {
        var blob = new Blob([result.data], { type: "image/jpeg" });
        var imageUrl = window.URL.createObjectURL(blob);
        var imageResultViewer = document.getElementById("img");
        imageResultViewer.src = imageUrl;
        $scope.showImage = true;
        insertHeadersIntoResponseViewer(result.headers, result.status);
        $scope.requestInProgress = false;
    }, handleUnsuccessfulQueryResponse);
}
function handleHtmlResponse($scope, startTime, results, headers, status) {
    $scope.requestInProgress = false;
    showResults(results, headers, status, "html");
}
function handleJsonResponse($scope, startTime, results, headers, status) {
    results = JSON.stringify(results, null, 4);
    $scope.requestInProgress = false;
    showResults(results, headers, status, "json");
}
function handleXmlResponse($scope, startTime, results, headers, status) {
    results = formatXml(results);
    $scope.requestInProgress = false;
    showResults(results, headers, status, "xml");
}
function isImageResponse(headers) {
    var contentType = getContentType(headers);
    return contentType === "application/octet-stream" || contentType.substr(0, 6) === "image/";
}
function isHtmlResponse(headers) {
    var contentType = getContentType(headers);
    return contentType === "text/html" || contentType === "application/xhtml+xml";
}
function isXmlResponse(results) {
    return JSON.stringify(results, null, 4).indexOf("<?xml") != -1;
}
function isJsonResponse(headers) {
    var contentType = getContentType(headers);
    return contentType === "application/json";
}
function getContentType(headers) {
    var full = headers("content-type");
    var delimiterPos = full.indexOf(";");
    if (delimiterPos != -1) {
        return full.substr(0, delimiterPos);
    }
    else {
        return full;
    }
}
function getEntitySets(metadata) {
    var entitySetsObj = {};
    var entitySetsAndSingletons = $(($.parseHTML(metadata))[1]).find("EntityContainer")[0].children;
    for (var i = 0; i < entitySetsAndSingletons.length; i++) {
        var set = entitySetsAndSingletons[i];
        var entitySetOrSingleton = null;
        if (set.tagName == "ENTITYSET") {
            entitySetOrSingleton = {
                name: set.getAttribute("name"),
                isEntitySet: true,
                type: set.getAttribute("entitytype"),
                isACollection: true
            };
        }
        else if (set.tagName == "SINGLETON") {
            entitySetOrSingleton = {
                name: set.getAttribute("name"),
                isEntitySet: false,
                type: set.getAttribute("type"),
                isACollection: false
            };
        }
        else {
            console.error("Found unexpected type in metadata under EntityContainer");
        }
        entitySetsObj[entitySetOrSingleton.name] = entitySetOrSingleton;
    }
    return entitySetsObj;
}
function formatRequestHeaders(headers) {
    var obj = {};
    var parts = headers.replace(/^\s+|,\s*$/g, '').split('\n');
    for (var i = 0, len = parts.length; i < len; i++) {
        var match = parts[i].match(/^\s*"?([^":]*)"?\s*:\s*"?([^"]*)\s*$/);
        if (match) {
            obj[match[1]] = match[2];
        }
    }
    return obj;
}
function createEntityTypeObject(DOMarray) {
    var entityTypes = {};
    for (var i = 0; i < DOMarray.length; i++) {
        var EntityType = {
            name: DOMarray[i].getAttribute("name"),
            links: {}
        };
        var children = DOMarray[i].children;
        for (var j = 0; j < children.length; j++) {
            if (children[j].attributes.length > 0) {
                var childName = children[j].getAttribute("name");
                var type = children[j].getAttribute("type");
                var urlObject = {
                    isACollection: false,
                    name: childName,
                    isEntitySet: false,
                    type: type
                };
                if (type.indexOf("Collection(") == 0) {
                    urlObject.isACollection = true;
                    urlObject.type = type.split("(")[1].split(")")[0];
                }
                EntityType.links[childName] = urlObject;
            }
        }
        entityTypes[EntityType.name] = EntityType;
    }
    return entityTypes;
}
function showRequestHeaders($scope) {
    getHeadersEditor().getSession().setValue("");
    var requestHeaders = "Content-Type: application/json";
    getHeadersEditor().getSession().insert(0, requestHeaders);
}
function getEntityTypes(metadata) {
    var entities = {};
    var entityTypes = $(($.parseHTML(metadata))[1]).find("EntityType");
    jQuery.extend(entities, createEntityTypeObject(entityTypes));
    var complexTypes = $(($.parseHTML(metadata))[1]).find("ComplexType");
    jQuery.extend(entities, createEntityTypeObject(complexTypes));
    return entities;
}
function getEntityFromTypeName(service, typePossiblyWithPrefix) {
    var entityTypeData = service.cache.get(service.selectedVersion + "EntityTypeData");
    var type = typePossiblyWithPrefix.split("microsoft.graph.").pop();
    return entityTypeData[type];
}
function constructGraphLinksFromServicePath(service) {
    var urlPathArr = service.text.split("https://graph.microsoft.com/");
    if (urlPathArr.length <= 1)
        return [];
    var segments = urlPathArr[1].split("/");
    var version = segments.shift();
    var graph = [];
    var entityContainerData = service.cache.get(service.selectedVersion + "EntitySetData");
    if (entityContainerData === undefined)
        return [];
    while (segments.length > 0) {
        var segment = segments.shift();
        if (graph.length == 0) {
            if (segment in entityContainerData) {
                var node = entityContainerData[segment];
                graph.push(node);
            }
        }
        else {
            var lastGraphItem = graph[graph.length - 1];
            var lastGraphItemEntity = getEntityFromTypeName(service, lastGraphItem.type);
            if (lastGraphItemEntity === undefined) {
                continue;
            }
            if (lastGraphItemEntity.links !== undefined && segment in lastGraphItemEntity.links) {
                graph.push(lastGraphItemEntity.links[segment]);
            }
            else if (lastGraphItem.isACollection && segment != "") {
                graph.push({
                    isACollection: false,
                    isEntitySet: false,
                    name: segment,
                    type: lastGraphItem.type
                });
            }
        }
    }
    return graph;
}
function combineUrlOptionsWithCurrentUrl(service, urlOptions) {
    var graphFromServiceUrl = constructGraphLinksFromServicePath(service);
    var baseUrl = [];
    while (graphFromServiceUrl.length > 0) {
        var lastSegment = graphFromServiceUrl.shift();
        baseUrl.push(lastSegment.name);
    }
    var baseUrlFinal = "https://graph.microsoft.com/" + service.selectedVersion;
    if (baseUrl.length > 0) {
        baseUrlFinal += "/" + baseUrl.join('/');
    }
    var autocompleteUrls = [];
    for (var urlAutoCompleteSuffix in urlOptions) {
        autocompleteUrls.push(baseUrlFinal + '/' + urlOptions[urlAutoCompleteSuffix]);
    }
    return autocompleteUrls;
}
function getUrlsFromServiceURL(service) {
    var graphFromServiceUrl = constructGraphLinksFromServicePath(service);
    if (graphFromServiceUrl.length > 0) {
        var lastNode = graphFromServiceUrl.pop();
        if (lastNode.isACollection)
            return [];
        var entity = getEntityFromTypeName(service, lastNode.type);
        if (!entity)
            return [];
        return combineUrlOptionsWithCurrentUrl(service, Object.keys(entity.links));
    }
    else {
        var entityContainerData = service.cache.get(service.selectedVersion + "EntitySetData");
        if (entityContainerData === undefined) {
            return [];
        }
        return combineUrlOptionsWithCurrentUrl(service, Object.keys(entityContainerData));
    }
}
function showRequestBodyEditor() {
    s.tabConfig.disableRequestBodyEditor = false;
    s.tabConfig.hideContent = false;
    showRequestHeaders(s);
    $(function () {
        initializeJsonEditor();
        setSelectedTab(1);
    });
}
function setSelectedTab(num) {
    if (num >= 2 || num < 0) {
        return;
    }
    s.tabConfig.selected = num;
    s.tabConfig.previousSelected = s.tabConfig.selected;
}
function handleQueryString(service, actionValue, versionValue, requestValue) {
    if (actionValue) {
        service.selectedOption = actionValue.toUpperCase();
        if (service.selectedOption === 'POST' || service.selectedOption === 'PATCH') {
            if (hello('msft').getAuthResponse() != null)
                showRequestBodyEditor();
        }
    }
    if (versionValue) {
        service.selectedVersion = versionValue;
    }
    if (requestValue) {
        service.text = "https://graph.microsoft.com/" + service.selectedVersion + "/" + requestValue;
    }
}
function getUrlsFromEntityType(service, entity) {
    var entityTypes = service.cache.get(service.selectedVersion + "EntityTypeData");
    var type = entityTypes[entity.name];
    return combineUrlOptionsWithCurrentUrl(service, Object.keys(type.links));
}
function parseMetadata(service) {
    var entitySetData, entityTypeData;
    if (!service.cache.get(service.selectedVersion + "Metadata")) {
        console.log("parsing metadata");
        service.getMetadata().then(function (results) {
            var metadata = results.data;
            service.cache.put(service.selectedVersion + "Metadata", results);
            entitySetData = getEntitySets(metadata);
            service.cache.put(service.selectedVersion + "EntitySetData", entitySetData);
            entityTypeData = getEntityTypes(metadata);
            service.cache.put(service.selectedVersion + "EntityTypeData", entityTypeData);
            console.log("metadata successfully parsed");
        }, function (err, status) {
            console.error("metadata could not be parsed");
        });
    }
}
//# sourceMappingURL=api-explorer-helpers.js.map
// ------------------------------------------------------------------------------
//  Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.  See License in the project root for license information.
// ------------------------------------------------------------------------------

'use strict';

angular.module('ApiExplorer')
.config(function($locationProvider) {
    $locationProvider.html5Mode({
        enabled: true,
        requireBase: false,
        rewriteLinks: false
    });
    
})
.factory('ApiExplorerSvc', [function () {
    var apiExplorerService = {};
    return apiExplorerService;
}]);
// ------------------------------------------------------------------------------
//  Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.  See License in the project root for license information.
// ------------------------------------------------------------------------------

'use strict';

angular.module('ApiExplorer')
    .factory('ApiExplorerSvc', ['$http', '$cacheFactory', function ($http, $cacheFactory) {
        return {
            text: 'https://graph.microsoft.com/v1.0/me/',

            selectedVersion: "v1.0",

            selectedOption: "GET",

            cache: $cacheFactory('myCache'),
            
            performAnonymousQuery: function (queryType) {
                return function (query, postString, requestHeaders) {
                    var headersObj = {
                        "Authorization": "Bearer {token:https://graph.microsoft.com/}",
                        "Accept": "application/json"
                    };

                    if (requestHeaders && requestHeaders["Authorization"]){
                        headersObj["Authorization"] = requestHeaders["Authorization"];
                    }

                    if (requestHeaders && requestHeaders["Accept"]){
                        headersObj["Accept"] = requestHeaders["Accept"];
                    }

                    var request = {
                        url: 'https://proxy.apisandbox.msdn.microsoft.com/svc?url=' + encodeURIComponent(query),
                        method: 'GET',
                        headers: headersObj
                    }

                    if (queryType == "GET_BINARY") {
                        request["responseType"] = "arraybuffer";
                    }

                    if (queryType == "GET_BINARY" || queryType == "GET") {
                        return $http(request);
                    }
                };
            },

            performQuery: function (queryType) {
                return function (query, postString, requestHeaders) {
                    switch(queryType) {
                        case "GET":
                            return $http.get(query, {headers : requestHeaders});
                        case "GET_BINARY":
                            return $http.get(query, {responseType:"arraybuffer"}, {headers : requestHeaders});
                        case "POST":
                            return $http.post(query, postString, {headers : requestHeaders});
                        case "PATCH":
                            return $http.patch(query, postString, {headers : requestHeaders});
                        case "DELETE":
                            return $http.delete(query, {headers : requestHeaders});
                    }
                };
            },
            
            getMetadata: function() {
                return this.performAnonymousQuery("GET")("https://graph.microsoft.com/" + this.selectedVersion + "/$metadata");
            }
        }
    }]);
var s;
var GraphBaseUrl = "https://graph.microsoft.com/";
var GraphVersions = ['beta', 'v1.0'];
angular.module('ApiExplorer')
    .controller('ApiExplorerCtrl', ['$scope', '$http', '$location', 'ApiExplorerSvc', '$timeout', '$templateCache', '$mdDialog', '$sce', function ($scope, $http, $location, apiService, $timeout, $templateCache, $mdDialog, $sce) {
        s = $scope;
        $scope.userInfo = {};
        $scope.getAssetPath = function (relPath) {
            return s.pathToBuildDir + "/" + relPath;
        };
        $scope.finishAdminConsertFlow = function () {
            hello('msft_token_refresh').login({
                display: 'popup',
                response_type: "token",
                redirect_uri: $scope.redirectUrl,
                scope: $scope.scopes + " " + $scope.adminScopes,
                response_mode: 'fragment',
                prompt: 'none',
                domain_hint: 'organizations',
                login_hint: $scope.userInfo.preferred_username
            }, function (res) {
                if (res.authResponse) {
                    var accessToken = res.authResponse.access_token;
                    $http.defaults.headers.common['Authorization'] = 'Bearer ' + accessToken;
                }
            }, function (res) {
                console.error(res);
            });
        };
        hello.on('auth.login', function (auth) {
            var accessToken;
            if (auth.network == "msft_token_refresh") {
                accessToken = hello('msft_token_refresh').getAuthResponse().access_token;
            }
            else if (auth.network == "msft") {
                var authResponse = hello('msft').getAuthResponse();
                accessToken = authResponse.access_token;
            }
            if (accessToken) {
                $http.defaults.headers.common['Authorization'] = 'Bearer ' + accessToken;
                apiService.performQuery("GET")("https://graph.microsoft.com/v1.0/me")
                    .then(function (result) {
                    var resultBody = result.data;
                    $scope.userInfo = {
                        preferred_username: resultBody.mail
                    };
                }, function (res) {
                    console.error(res);
                });
            }
        });
        $scope.tabConfig = {
            disableRequestBodyEditor: true,
            hideContent: true,
            selected: 0
        };
        $scope.showImage = false;
        $scope.tabConfig.previousSelected = $scope.tabConfig.selected;
        $scope.processTabClick = function () {
            var switchingTabs = $scope.tabConfig.previousSelected != $scope.tabConfig.selected;
            if (!switchingTabs)
                $scope.tabConfig.hideContent = !$scope.tabConfig.hideContent;
            $scope.tabConfig.previousSelected = $scope.tabConfig.selected;
        };
        var requestVal = $location.search().request;
        var actionVal = $location.search().method;
        var bodyVal = $location.search().body;
        var versionVal = $location.search().version;
        var headersVal = $location.search().headers;
        handleQueryString(apiService, actionVal, versionVal, requestVal);
        $timeout(function () {
            initializeHeadersEditor(headersVal);
            initializeJsonViewer($scope, apiService);
        });
        parseMetadata(apiService);
        $scope.isAuthenticated = function () {
            var session = hello('msft').getAuthResponse();
            if (session === null)
                return false;
            var currentTime = (new Date()).getTime() / 1000;
            return session && session.access_token && session.expires > currentTime;
        };
        $scope.$watch("getEditor()", function (event, args) {
            initializeJsonEditor(bodyVal);
        });
        $scope.login = function () {
            hello('msft').login({
                display: 'page',
                response_type: "id_token token",
                nonce: 'graph_explorer',
                prompt: 'select_account',
                msafed: 0
            }, function (res) {
            }, function () {
                console.error('error signing in');
            });
        };
        $scope.logout = function () {
            apiService.selectedOption = "GET";
            $scope.tabConfig.disableRequestBodyEditor = true;
            setSelectedTab(0);
            hello('msft').logout(null, { force: true });
            delete $scope.userInfo;
        };
        $scope.getSearchText = function () {
            return apiService.text;
        };
        $scope.getCurrentEntityName = function () {
            if (!apiService.text)
                return null;
            var txt = apiService.text;
            var pathArr = txt.split("/").filter((function (a) { return a.length > 0; }));
            return pathArr.pop();
        };
        $scope.canInsertTemplate = function () {
            return apiService.selectedOption == "POST" && checkCanInsertTemplate(apiService.text);
        };
        $scope.insertPostTemplate = function () {
            var entity = $scope.getCurrentEntityName();
            var strToInsert = JSON.stringify(postTemplates[entity], null, 2).trim();
            var fullUserEmail = $scope.userInfo.preferred_username;
            var domain = fullUserEmail.split("@")[1];
            strToInsert = strToInsert.replace(/AUTHENTICATED_DOMAIN/g, domain);
            strToInsert = strToInsert.replace(/FULL_USER_EMAIL/g, fullUserEmail);
            initializeJsonEditor(strToInsert);
        };
        function checkCanInsertTemplate(URL) {
            s;
            var entity = $scope.getCurrentEntityName();
            var canInsertTemplate = entity in postTemplates;
            return canInsertTemplate;
        }
        $scope.showShareDialog = function (ev) {
            $mdDialog.show({
                controller: ShareDialogController,
                templateUrl: pathToBuildDir + '/assets/views/shareDialog.tmpl.html',
                parent: angular.element(document.body),
                targetEvent: ev,
                clickOutsideToClose: true,
                scope: $scope.$new(),
                locals: {
                    apiService: apiService,
                    $sce: $sce,
                    headers: formatRequestHeaders(getHeadersEditor().getSession().getValue()),
                    body: getJsonViewer().getSession().getValue()
                },
            })
                .then(function (answer) {
                $scope.status = 'You said the information was "' + answer + '".';
            }, function () {
                $scope.status = 'You cancelled the dialog.';
            });
        };
    }]);
angular.module('ApiExplorer')
    .controller('DropdownCtrl', ['$scope', 'ApiExplorerSvc', function ($scope, apiService) {
        $scope.onItemClick = function (choice) {
            if (choice != apiService.selectedOption) {
                apiService.selectedOption = choice;
                apiService.text = apiService.text.replace(/https:\/\/graph.microsoft.com($|\/([\w]|\.)*($|\/))/, ("https://graph.microsoft.com/" + apiService.selectedVersion + "/"));
                if (choice == 'POST' || choice == 'PATCH') {
                    showRequestBodyEditor();
                }
                else if (choice == 'GET' || choice == 'DELETE') {
                    s.tabConfig.disableRequestBodyEditor = true;
                    setSelectedTab(0);
                }
            }
        };
        $scope.items = [
            'GET',
            'POST',
            'PATCH',
            'DELETE'
        ];
        $scope.getServiceOption = function () {
            return apiService.selectedOption;
        };
    }]);
angular.module('ApiExplorer')
    .controller('VersionCtrl', ['$scope', 'ApiExplorerSvc', function ($scope, apiService) {
        $scope.items = GraphVersions;
        $scope.getServiceVersion = function () {
            return apiService.selectedVersion;
        };
        $scope.onItemClick = function (choice) {
            if (apiService.selectedVersion !== choice) {
                apiService.selectedVersion = choice;
                apiService.text = apiService.text.replace(/https:\/\/graph.microsoft.com($|\/([\w]|\.)*($|\/))/, ("https://graph.microsoft.com/" + apiService.selectedVersion + "/"));
                $scope.$parent.$broadcast('updateUrlFromServiceText');
                parseMetadata(apiService);
            }
        };
    }]);
angular.module('ApiExplorer').controller('datalistCtrl', ['$scope', 'ApiExplorerSvc', function ($scope, apiService) {
        $scope.searchTextChange = function (searchText) {
            if (typeof searchText === 'undefined')
                return;
            apiService.text = searchText;
            var graphPathStartingWithVersion = searchText.split(GraphBaseUrl);
            if (graphPathStartingWithVersion.length < 2) {
                return;
            }
            var possibleGraphPathArr = graphPathStartingWithVersion[1].split('/');
            if (possibleGraphPathArr.length == 0) {
                return;
            }
            var possibleVersion = possibleGraphPathArr[0];
            if (GraphVersions.indexOf(possibleVersion) != -1) {
                apiService.selectedVersion = possibleVersion;
                parseMetadata(apiService);
            }
        };
        $scope.getRequestHistory = function () {
            return requestHistory;
        };
        $scope.$on('updateUrlFromServiceText', function (event, data) {
            $scope.text = apiService.text;
        });
        $scope.searchTextChange(apiService.text);
        $scope.searchText = apiService.text;
        $scope.getMatches = function (query) {
            var urls = getUrlsFromServiceURL(apiService);
            return urls.filter(function (option) {
                var queryInOption = (option.indexOf(query) > -1);
                return queryInOption;
            });
        };
        if (window['runTests'])
            runAutoCompleteTests(apiService);
    }]);
angular.module('ApiExplorer').controller('FormCtrl', ['$scope', 'ApiExplorerSvc', function ($scope, apiService) {
        $scope.requestInProgress = false;
        $scope.insufficientPrivileges = false;
        if (hello('msft').getAuthResponse() != null &&
            (apiService.selectedOption === 'POST' || apiService.selectedOption === 'PATCH')) {
            showRequestBodyEditor();
        }
        else {
            setSelectedTab(0);
        }
        $scope.$parent.$on("urlChange", function (event, args) {
            msGraphLinkResolution($scope, getJsonViewer().getSession().getValue(), args, apiService);
        });
        $scope.historyOnClick = function (historyItem) {
            apiService.text = historyItem.urlText;
            $scope.$broadcast('updateUrlFromServiceText');
            apiService.selectedVersion = historyItem.selectedVersion;
            apiService.selectedOption = historyItem.htmlOption;
            parseMetadata(apiService);
            if (historyItem.htmlOption == 'POST' || historyItem.htmlOption == 'PATCH') {
                if (getJsonViewer()) {
                    getJsonViewer().getSession().setValue(historyItem.jsonInput);
                }
                else {
                    console.error("json editor watch event not firing");
                }
            }
            else {
                if (getJsonViewer()) {
                    getJsonViewer().getSession().setValue("");
                }
            }
            $scope.submit();
        };
        $scope.closeAdminConsentBar = function () {
            $scope.insufficientPrivileges = false;
        };
        $scope.getAdminConsent = function () {
            hello('msft_admin_consent').login({
                display: 'popup'
            }).then(function () {
                $scope.finishAdminConsertFlow();
            }, function () {
                $scope.finishAdminConsertFlow();
            });
        };
        $scope.submit = function () {
            $scope.requestInProgress = true;
            var historyObj = {
                urlText: apiService.text,
                selectedVersion: apiService.selectedVersion,
                htmlOption: apiService.selectedOption,
                jsonInput: null
            };
            if (historyObj.htmlOption == 'POST' || historyObj.htmlOption == 'PATCH') {
                historyObj.jsonInput = getRequestBodyEditor().getSession().getValue();
            }
            $scope.showImage = false;
            var postBody;
            if (getRequestBodyEditor() != undefined) {
                postBody = getRequestBodyEditor().getSession().getValue();
            }
            var requestHeaders = "";
            if (getHeadersEditor() != undefined) {
                requestHeaders = getHeadersEditor().getSession().getValue();
                requestHeaders = formatRequestHeaders(requestHeaders);
            }
            var startTime = new Date();
            function handleSuccessfulQueryResponse(result) {
                var status = result.status;
                var headers = result.headers;
                var resultBody = result.data;
                if (isImageResponse(headers)) {
                    handleImageResponse($scope, apiService, startTime, headers, status, handleUnsuccessfulQueryResponse);
                }
                else if (isHtmlResponse(headers)) {
                    handleHtmlResponse($scope, startTime, resultBody, headers, status);
                }
                else if (isXmlResponse(result)) {
                    handleXmlResponse($scope, startTime, resultBody, headers, status);
                }
                else {
                    handleJsonResponse($scope, startTime, resultBody, headers, status);
                }
                historyObj.duration = (new Date()).getTime() - startTime.getTime();
                saveHistoryObject(historyObj, status);
                $scope.insufficientPrivileges = false;
            }
            function handleUnsuccessfulQueryResponse(result) {
                var status = result.status;
                var headers = result.headers;
                handleJsonResponse($scope, startTime, result.data, headers, status);
                historyObj.duration = (new Date()).getTime() - startTime.getTime();
                saveHistoryObject(historyObj, status);
                if (status === 401 || status === 403) {
                    $scope.insufficientPrivileges = true;
                }
            }
            if ($scope.isAuthenticated()) {
                apiService.performQuery(apiService.selectedOption)(apiService.text, postBody, requestHeaders)
                    .then(handleSuccessfulQueryResponse, handleUnsuccessfulQueryResponse);
            }
            else {
                apiService.performAnonymousQuery(apiService.selectedOption)(apiService.text, postBody, requestHeaders)
                    .then(handleSuccessfulQueryResponse, handleUnsuccessfulQueryResponse);
            }
        };
    }]);
//# sourceMappingURL=api-explorer-ctrl.js.map
var scripts = document.getElementsByTagName("script");
var src = scripts[scripts.length - 1].src;
var pathToBuildDir = src.split('/').slice(0, -2).join('/');
angular.module('ApiExplorer')
    .config(function ($sceDelegateProvider, $httpProvider) {
    $sceDelegateProvider.resourceUrlWhitelist([
        'self',
        pathToBuildDir + '/**'
    ]);
    $httpProvider.defaults.useXDomain = true;
    delete $httpProvider.defaults.headers.common['X-Requested-With'];
})
    .directive('apiExplorer', function () {
    return {
        scope: {
            strings: '=',
            language: '=',
            scopes: '=',
            adminScopes: '=',
            clientId: '=',
            redirectUrl: '='
        },
        templateUrl: pathToBuildDir + '/assets/views/explorer.html',
        controller: function ($scope) {
            $scope.pathToBuildDir = pathToBuildDir;
            $scope.str = loc_strings['en_us'];
            if ($scope.language) {
                $scope.str = loc_strings[$scope.language];
            }
            angular.extend($scope.str, $scope.strings);
            hello.init({
                msft: $scope.clientId
            }, {
                scope: $scope.scopes,
                redirect_uri: window.location.pathname
            });
            hello.init({
                msft_admin_consent: $scope.clientId,
                msft_token_refresh: $scope.clientId,
            }, {
                redirect_uri: window.location.pathname
            });
        }
    };
});
//# sourceMappingURL=api-explorer-directive.js.map
function getRequestBodyEditor() {
    var requestBodyEditorElement = document.getElementById("jsonEditor");
    return ace.edit(requestBodyEditorElement);
}
function getHeadersEditor() {
    var requestHeaderEditorElement = document.getElementById("jsonEditorHeaders");
    return ace.edit(requestHeaderEditorElement);
}
function getJsonViewer() {
    var jsonViewerElement = document.getElementById("jsonViewer");
    return ace.edit(jsonViewerElement);
}
function initializeJsonEditor(bodyVal) {
    var editor = getRequestBodyEditor();
    commonAceSetup(editor);
    editor.getSession().setMode("ace/mode/javascript");
    if (bodyVal) {
        editor.getSession().insert({ row: 0, column: 0 }, bodyVal);
    }
}
function initializeHeadersEditor(headersVal) {
    var editor = getHeadersEditor();
    commonAceSetup(editor);
    if (headersVal) {
        editor.getSession().insert(0, headersVal);
    }
    editor.moveCursorTo(1, 0);
}
function commonAceSetup(editor) {
    editor.setShowPrintMargin(false);
    editor.$blockScrolling = Infinity;
    editor.renderer.setOption('showLineNumbers', false);
    editor.commands.bindKey("Tab", null);
}
//# sourceMappingURL=api-explorer-jseditor.js.map
function endsWithSlash(serviceText) {
    return serviceText.charAt(serviceText.length - 1) == '/';
}
function msGraphLinkResolution($scope, body, args, service) {
    if (args.indexOf("https://") == -1) {
        if (service.text.indexOf(args.substr(1)) != -1) {
        }
        else if (service.text.indexOf("/me") != -1 && service.text.indexOf("/me/") == -1 && service.text.indexOf("/memberOf") == -1) {
            service.text = service.text.replace("/me", "") + "/users/" + args.substr(1);
        }
        else {
            var index = body.indexOf(args.substr(1));
            var typeIndex = body.lastIndexOf('@odata.type', index);
            if (typeIndex != -1) {
                var typeIndexEnd = body.indexOf("\n", typeIndex);
                var type = body.substr(typeIndex, typeIndexEnd - typeIndex);
                type = type.replace("@odata.type\": \"#microsoft.graph.", "");
                type = type.replace("\"", "").replace(",", "");
                service.text = "https://graph.microsoft.com/v1.0/" + type + "s/" + args.substr(1);
            }
            else {
                if (service.text.indexOf("?") != -1) {
                    service.text = service.text.substr(0, service.text.indexOf("?"));
                }
                var linkUrl = [service.text, args.substr(1)];
                if (endsWithSlash(service.text))
                    service.text = linkUrl.join("");
                else
                    service.text = linkUrl.join("/");
            }
        }
    }
    else {
        service.text = args.replace("\"", "");
    }
    if (service.text && endsWithSlash(service.text)) {
        service.text += '/';
    }
    $scope.$broadcast('updateUrlFromServiceText');
    $scope.submit();
}
//# sourceMappingURL=api-explorer-msgraph.js.map
hello.init({
    msft: {
        oauth: {
            version: 2,
            auth: 'https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize',
            grant: 'https://login.microsoftonline.com/organizations/oauth2/v2.0/token'
        },
        scope_delim: ' ',
        form: false
    }, msft_admin_consent: {
        oauth: {
            version: 2,
            auth: 'https://login.microsoftonline.com/common/adminconsent',
            grant: 'https://login.microsoftonline.com/common/oauth2/v2.0/token'
        },
        scope_delim: ' ',
        form: false
    }, msft_token_refresh: {
        oauth: {
            version: 2,
            auth: 'https://login.microsoftonline.com/common/oauth2/v2.0/authorize',
            grant: 'https://login.microsoftonline.com/common/oauth2/v2.0/token'
        },
        scope_delim: ' ',
        form: false
    }
});
//# sourceMappingURL=auth.js.map
function createShareLink(fullRequestUrl, action, version) {    
    return window.location.origin + window.location.pathname + "?request=" + extractGraphEndpoint(fullRequestUrl) + "&method=" + action + "&version=" + version;
}

function extractGraphEndpoint(fullRequestUrl) {
    requestUrl = fullRequestUrl.split('.com')
    requestUrl.shift();
    
    var requestUrlComponents = requestUrl[0].split('/');
    requestUrlComponents.shift(); //remove empty item
    requestUrlComponents.shift(); //remove version
    return (requestUrlComponents.join('/'));
}

function isPostOrPatch(option) {
    return  option == "POST" || option == "PATCH";
}

function ShareDialogController($scope, $mdDialog, apiService, $sce, headers, body) {
    var _apiService = apiService;
    $scope.hide = function() {
        $mdDialog.hide();
    };

    $scope.cancel = function() {
        $mdDialog.cancel();
    };
    
    $scope.getShareLink = function() {
        var requestUrl = $scope.getSearchText();
        return createShareLink(requestUrl, _apiService.selectedOption, _apiService.selectedVersion);
    }

    $scope.generateSuperAgentCode = function() {
        var requestUrl = $scope.getSearchText();

        var fullGraphUrl = "https://graph.microsoft.com/" + _apiService.selectedVersion + "/" + extractGraphEndpoint(requestUrl);

        var tab = function() {
            return "<span style='padding-left:15px'></span>";
        }

        var line = function() {
            return "<br>"
        }

        var str = "request";
        str += line() + tab() + "." + _apiService.selectedOption.toLocaleLowerCase() + "(\"" + fullGraphUrl + "\")"

        if (Object.keys(headers).length > 0) {
            str += line() + tab() + ".set(" + JSON.stringify(headers) + ")";
        }

        if (isPostOrPatch( _apiService.selectedOption)) {
            try {
                var bodyObj = JSON.parse(body);
                if (bodyObj) {
                    str += line() + tab() + ".send(" + JSON.stringify(bodyObj) + ")";
                }
            } catch(e) {

            }
        }
 
        str += line() + tab() + ".end(function(err, res) {"
        str += line() + tab() + tab() + "console.log(res);"
        str += line() + tab() + "});"
        return $sce.trustAsHtml(str);
    }
}
function initializeJsonViewer($scope, apiService) {
    $(document).ready(function () {
        var jsonViewer = getJsonViewer();
        commonAceSetup(jsonViewer);
        jsonViewer.getSession().setMode("ace/mode/javascript");
        jsonViewer.setOptions({
            readOnly: true,
            highlightActiveLine: false,
            highlightGutterLine: false,
        });
        jsonViewer.getSession().setUseWorker(false);
        jsonViewer.renderer.$cursorLayer.element.style.opacity = 0;
        define("hoverlink", ["require", "exports"], function (require, exports, module) {
            "use strict";
            var oop = require("ace/lib/oop");
            var event = require("ace/lib/event");
            var Range = require("ace/range").Range;
            var EventEmitter = require("ace/lib/event_emitter").EventEmitter;
            var HoverLink = function (jsonViewer) {
                if (jsonViewer.hoverLink)
                    return;
                jsonViewer.hoverLink = this;
                this.jsonViewer = jsonViewer;
                this.update = this.update.bind(this);
                this.onMouseMove = this.onMouseMove.bind(this);
                this.onMouseOut = this.onMouseOut.bind(this);
                this.onClick = this.onClick.bind(this);
                event.addListener(jsonViewer.renderer.scroller, "mousemove", this.onMouseMove);
                event.addListener(jsonViewer.renderer.content, "mouseout", this.onMouseOut);
                event.addListener(jsonViewer.renderer.content, "click", this.onClick);
            };
            (function () {
                oop.implement(this, EventEmitter);
                this.token = {};
                this.range = new Range();
                this.update = function () {
                    this.$timer = null;
                    var jsonViewer = this.jsonViewer;
                    var renderer = jsonViewer.renderer;
                    var canvasPos = renderer.scroller.getBoundingClientRect();
                    var offset = (this.x + renderer.scrollLeft - canvasPos.left - renderer.$padding) / renderer.characterWidth;
                    var row = Math.floor((this.y + renderer.scrollTop - canvasPos.top) / renderer.lineHeight);
                    var col = Math.round(offset);
                    var screenPos = {
                        row: row,
                        column: col,
                        side: offset - col > 0 ? 1 : -1
                    };
                    var session = jsonViewer.session;
                    var docPos = session.screenToDocumentPosition(screenPos.row, screenPos.column);
                    var selectionRange = jsonViewer.selection.getRange();
                    if (!selectionRange.isEmpty()) {
                        if (selectionRange.start.row <= row && selectionRange.end.row >= row)
                            return this.clear();
                    }
                    var line = jsonViewer.session.getLine(docPos.row);
                    if (docPos.column == line.length) {
                        var clippedPos = jsonViewer.session.documentToScreenPosition(docPos.row, docPos.column);
                        if (clippedPos.column != screenPos.column) {
                            return this.clear();
                        }
                    }
                    var token = this.findLink(docPos.row, docPos.column);
                    this.link = token;
                    if (!token) {
                        return this.clear();
                    }
                    this.isOpen = true;
                    jsonViewer.renderer.setCursorStyle("pointer");
                    session.removeMarker(this.marker);
                    this.range = new Range(token.row, token.start, token.row, token.start + token.value.length);
                    this.marker = session.addMarker(this.range, "ace_link_marker", "text", true);
                };
                this.clear = function () {
                    if (this.isOpen) {
                        this.jsonViewer.session.removeMarker(this.marker);
                        this.jsonViewer.renderer.setCursorStyle("");
                        this.isOpen = false;
                    }
                };
                this.getMatchAround = function (regExp, string, col) {
                    var match;
                    regExp.lastIndex = 0;
                    string.replace(regExp, function (str) {
                        var offset = arguments[arguments.length - 2];
                        var length = str.length;
                        if (offset <= col && offset + length >= col)
                            match = {
                                start: offset,
                                value: str
                            };
                    });
                    return match;
                };
                this.onClick = function () {
                    var jsonViewer = this.jsonViewer;
                    var renderer = jsonViewer.renderer;
                    var canvasPos = renderer.scroller.getBoundingClientRect();
                    var offset = (this.x + renderer.scrollLeft - canvasPos.left - renderer.$padding) / renderer.characterWidth;
                    var row = Math.floor((this.y + renderer.scrollTop - canvasPos.top) / renderer.lineHeight);
                    var col = Math.round(offset);
                    if (this.link) {
                        if (row != this.link.row || !(col > this.link.start && col < this.link.start + this.link.value.length)) {
                            return;
                        }
                        this.link.jsonViewer = this.jsonViewer;
                        this._signal("open", this.link);
                        this.clear();
                    }
                };
                this.findLink = function (row, column) {
                    var jsonViewer = this.jsonViewer;
                    var session = jsonViewer.session;
                    var line = session.getLine(row);
                    var match = this.getMatchAround(/https?:\/\/[^\s"]+/g, line, column);
                    if (!match) {
                        var match = this.getMatchAround(/"id": "[^\s"']+/g, line, column);
                        if (!match)
                            return;
                        match = this.getMatchAround(/"[^\s"']+/g, line, column);
                        if (!match)
                            return;
                    }
                    match.row = row;
                    return match;
                };
                this.onMouseMove = function (e) {
                    if (this.jsonViewer.$mouseHandler.isMousePressed) {
                        if (!this.jsonViewer.selection.isEmpty())
                            this.clear();
                        return;
                    }
                    this.x = e.clientX;
                    this.y = e.clientY;
                    this.update();
                };
                this.onMouseOut = function (e) {
                    this.clear();
                };
                this.destroy = function () {
                    this.onMouseOut();
                    event.removeListener(this.jsonViewer.renderer.scroller, "mousemove", this.onMouseMove);
                    event.removeListener(this.jsonViewer.renderer.content, "mouseout", this.onMouseOut);
                    delete this.jsonViewer.hoverLink;
                };
            }).call(HoverLink.prototype);
            exports.HoverLink = HoverLink;
        });
        require(['hoverlink'], function (hoverlink) {
            var HoverLink = require("hoverlink").HoverLink;
            jsonViewer.hoverLink = new HoverLink(jsonViewer);
            jsonViewer.hoverLink.on("open", function (x) {
                run($scope, x.value, apiService);
            });
        });
    });
}
//# sourceMappingURL=api-explorer-jsviewer.js.map
var requestHistory = [];
var LocalStorageKeyGraphRequestHistory = "GRAPH_REQUEST_HISTORY";
function saveHistoryToLocalStorage() {
    localStorage.setItem(LocalStorageKeyGraphRequestHistory, JSON.stringify(requestHistory));
}
function loadHistoryFromLocalStorage() {
    var possibleHistory = localStorage.getItem(LocalStorageKeyGraphRequestHistory);
    if (possibleHistory == null) {
        return;
    }
    requestHistory = JSON.parse(possibleHistory);
}
function saveHistoryObject(historyObject, statusCode) {
    historyObject.successful = statusCode >= 200 && statusCode < 300;
    historyObject.statusCode = statusCode;
    historyObject.requestId = Math.random().toString(36).replace(/[^a-z]+/g, '').substr(0, 10);
    requestHistory.splice(0, 0, historyObject);
    saveHistoryToLocalStorage();
}
function fetchRequestHistory() {
    return requestHistory;
}
loadHistoryFromLocalStorage();
//# sourceMappingURL=history.js.map
var loc_strings = {};
loc_strings['fr-FR'] = { "To try the explorer, please ": "Pour essayer l’afficheur, veuillez ", "sign in": "se connecter", " with your work or school account from Microsoft.": " avec votre compte scolaire ou professionnel de Microsoft.", "Submit": "Envoyer", "Using demo tenant": "À l’aide du client de démonstration", "sign out": "se déconnecter", "History": "Historique", "Method": "Méthode", "Query": "Requête", "Status Code": "Code d'état", "Duration": "Durée", "Go": "Rechercher", "YES": "OUI", "NO": "NON", "request header": "en-tête de la demande", "request body": "corps de la demande", "response": "réponse" };
loc_strings['es-ES'] = { "To try the explorer, please ": "Para utilizar el probador, ", "sign in": "iniciar sesión", " with your work or school account from Microsoft.": " con su cuenta profesional o educativa de Microsoft.", "Submit": "Enviar", "Using demo tenant": "Uso de inquilinos de demostración", "sign out": "cerrar sesión", "History": "Historial", "Method": "Método", "Query": "Consulta", "Status Code": "Código de estado", "Duration": "Duración", "Go": "Ir", "YES": "SÍ", "NO": "NO", "request header": "encabezado de solicitud", "request body": "cuerpo de solicitud", "response": "respuesta" };
loc_strings['en-US'] = { "To try the explorer, please ": "To try the explorer, please ", "sign in": "sign in", " with your work or school account from Microsoft.": " with your work or school account from Microsoft.", "Submit": "Submit", "Using demo tenant": "Using demo tenant", "sign out": "sign out", "History": "History", "Method": "Method", "Query": "Query", "Status Code": "Status Code", "Duration": "Duration", "Go": "Go", "YES": "YES", "NO": "NO", "request header": "request header", "request body": "request body", "response": "response", "login_to_send_requests": "Login to change the request type", "ShareQuery": "Share Query" };
loc_strings['de-DE'] = { "To try the explorer, please ": "Um den Tester auszuprobieren, ", "sign in": "Anmelden", " with your work or school account from Microsoft.": " mit Ihrem Geschäfts- oder Schulkonto von Microsoft an.", "Submit": "Senden", "Using demo tenant": "Verwenden des Demomandanten", "sign out": "Abmelden", "History": "Verlauf", "Method": "Methode", "Query": "Abfrage", "Status Code": "Statuscode", "Duration": "Dauer", "Go": "OK", "YES": "JA", "NO": "NEIN", "request header": "Anforderungsheader", "request body": "Anforderungstextkörper", "response": "Antwort" };
loc_strings['ru-RU'] = { "To try the explorer, please ": "Чтобы опробовать песочницу, ", "sign in": "войти", " with your work or school account from Microsoft.": " с помощью рабочей или учебной учетной записи от корпорации Майкрософт.", "Submit": "Отправить", "Using demo tenant": "С помощью демонстрационного клиента", "sign out": "выйти", "History": "Журнал", "Method": "Метод", "Query": "Запрос", "Status Code": "Код состояния", "Duration": "Длительность", "Go": "Перейти", "YES": "ДА", "NO": "НЕТ", "request header": "заголовок запроса", "request body": "текст запроса", "response": "ответ" };
loc_strings['ja-JP'] = { "To try the explorer, please ": "エクスプローラーをお試しいただくには、Microsoft の職場または学校アカウントで ", "sign in": "サインイン", " with your work or school account from Microsoft.": " します。", "Submit": "送信", "Using demo tenant": "デモ テナントを使用しています", "sign out": "サインアウト", "History": "履歴", "Method": "メソッド", "Query": "クエリ", "Status Code": "状態コード", "Duration": "期間", "Go": "検索", "YES": "はい", "NO": "いいえ", "request header": "要求ヘッダー", "request body": "要求本文", "response": "応答" };
loc_strings['pt-BR'] = { "To try the explorer, please ": "Para experimentar o Explorador, ", "sign in": "entrar", " with your work or school account from Microsoft.": " com a sua conta corporativa ou de estudante da Microsoft.", "Submit": "Enviar", "Using demo tenant": "Usando o Locatário de Demonstração", "sign out": "sair", "History": "Histórico", "Method": "Método", "Query": "Consulta", "Status Code": "Código de Status", "Duration": "Duração", "Go": "Ir", "YES": "SIM", "NO": "NÃO", "request header": "cabeçalho da solicitação", "request body": "corpo da solicitação", "response": "resposta" };
loc_strings['zh-CN'] = { "To try the explorer, please ": "若要尝试浏览器，请 使用你的 Microsoft 工作或学校帐户", "sign in": "登录", " with your work or school account from Microsoft.": "。", "Submit": "提交", "Using demo tenant": "使用演示租户", "sign out": "注销", "History": "历史记录", "Method": "方法", "Query": "查询", "Status Code": "状态代码", "Duration": "持续时间", "Go": "转到", "YES": "是", "NO": "否", "request header": "请求标题", "request body": "请求正文", "response": "响应" };
//# sourceMappingURL=loc_strings.js.map
var postTemplates = {
    messages: {
        "subject": "Meet for lunch?",
        "body": {
            "contentType": "Text",
            "content": "The new cafeteria is open."
        },
        "toRecipients": [
            {
                "emailAddress": {
                    "address": "garthf@contoso.com"
                }
            }
        ]
    },
    events: {
        "subject": "My event",
        "start": {
            "dateTime": "2017-05-07T16:15:00.0000000",
            "timeZone": "UTC"
        },
        "end": {
            "dateTime": "2017-06-07T16:15:00.0000000",
            "timeZone": "UTC"
        },
    },
    sendMail: {
        "message": {
            "subject": "Meet for lunch?",
            "body": {
                "contentType": "Text",
                "content": "The new cafeteria is open."
            },
            "toRecipients": [
                {
                    "emailAddress": {
                        "address": "garthf@contoso.com"
                    }
                }
            ]
        },
        "saveToSentItems": "false"
    },
    findMeetingTimes: {
        "attendees": [
            {
                "emailAddress": {
                    "address": "FULL_USER_EMAIL",
                    "name": "Alex Darrow"
                },
                "type": "Required"
            }
        ],
        "timeConstraint": {
            "timeslots": [
                {
                    "start": {
                        "dateTime": "2016-10-20T07:00:00",
                        "timeZone": "Pacific Standard Time"
                    },
                    "end": {
                        "dateTime": "2016-10-20T17:00:00",
                        "timeZone": "Pacific Standard Time"
                    }
                }
            ]
        },
        "locationConstraint": {
            "isRequired": "false",
            "suggestLocation": "true",
            "locations": [
                {
                    "displayName": "Conf Room 32/1368",
                    "locationEmailAddress": "conf32room1368@imgeek.onmicrosoft.com"
                }
            ]
        },
        "meetingDuration": "PT1H"
    },
    users: {
        "accountEnabled": true,
        "city": "Seattle",
        "country": "United States",
        "department": "Sales & Marketing",
        "displayName": "Melissa Darrow",
        "givenName": "Melissa",
        "jobTitle": "Marketing Director",
        "mailNickname": "MelissaD",
        "passwordPolicies": "DisablePasswordExpiration",
        "passwordProfile": {
            "password": "Test1234",
            "forceChangePasswordNextSignIn": false
        },
        "officeLocation": "131/1105",
        "postalCode": "98052",
        "preferredLanguage": "en-US",
        "state": "WA",
        "streetAddress": "9256 Towne Center Dr., Suite 400",
        "surname": "Darrow",
        "mobilePhone": "+1 206 555 0110",
        "usageLocation": "US",
        "userPrincipalName": "MelissaD@AUTHENTICATED_DOMAIN",
    },
    groups: {
        "@odata.type": "#Microsoft.Graph.Group",
        "description": "This group is the best ever",
        "displayName": "Unified group 3ef15",
        "groupTypes": [
            "Unified"
        ],
        "mailEnabled": true,
        "mailNickname": "Group911e5",
        "securityEnabled": true
    },
    contacts: {
        "givenName": "Pavel",
        "surname": "Bansky",
        "emailAddresses": [
            {
                "address": "pavelb@fabrikam.onmicrosoft.com",
                "name": "Pavel Bansky"
            }
        ],
        "businessPhones": [
            "+1 732 555 0102"
        ]
    }
};
var templateNames = {
    messages: 'message',
    events: 'event',
    sendMail: 'email'
};
//# sourceMappingURL=postTemplates.js.map
function createShareLink(fullRequestUrl, action, version) {
    return window.location.origin + window.location.pathname + "?request=" + extractGraphEndpoint(fullRequestUrl) + "&method=" + action + "&version=" + version;
}
function extractGraphEndpoint(fullRequestUrl) {
    var requestUrl = fullRequestUrl.split('.com');
    requestUrl.shift();
    var requestUrlComponents = requestUrl[0].split('/');
    requestUrlComponents.shift();
    requestUrlComponents.shift();
    return (requestUrlComponents.join('/'));
}
function isPostOrPatch(option) {
    return option == "POST" || option == "PATCH";
}
function ShareDialogController($scope, $mdDialog, apiService, $sce, headers, body) {
    var _apiService = apiService;
    $scope.hide = function () {
        $mdDialog.hide();
    };
    $scope.cancel = function () {
        $mdDialog.cancel();
    };
    $scope.getShareLink = function () {
        var requestUrl = $scope.getSearchText();
        return createShareLink(requestUrl, _apiService.selectedOption, _apiService.selectedVersion);
    };
    $scope.generateSuperAgentCode = function () {
        var requestUrl = $scope.getSearchText();
        var fullGraphUrl = "https://graph.microsoft.com/" + _apiService.selectedVersion + "/" + extractGraphEndpoint(requestUrl);
        var tab = function () {
            return "<span style='padding-left:15px'></span>";
        };
        var line = function () {
            return "<br>";
        };
        var str = "request";
        str += line() + tab() + "." + _apiService.selectedOption.toLocaleLowerCase() + "(\"" + fullGraphUrl + "\")";
        if (Object.keys(headers).length > 0) {
            str += line() + tab() + ".set(" + JSON.stringify(headers) + ")";
        }
        if (isPostOrPatch(_apiService.selectedOption)) {
            try {
                var bodyObj = JSON.parse(body);
                if (bodyObj) {
                    str += line() + tab() + ".send(" + JSON.stringify(bodyObj) + ")";
                }
            }
            catch (e) {
            }
        }
        str += line() + tab() + ".end(function(err, res) {";
        str += line() + tab() + tab() + "console.log(res);";
        str += line() + tab() + "});";
        return $sce.trustAsHtml(str);
    };
}
//# sourceMappingURL=share-dialog.js.map
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhlbGxvLmFsbC5taW4uanMiLCJhcGktZXhwbG9yZXItaW5pdC5qcyIsImFwaS1leHBsb3Jlci1oZWxwZXJzLmpzIiwiYXBpLWV4cGxvcmVyLWFwcC5qcyIsImFwaS1leHBsb3Jlci1zdmMuanMiLCJhcGktZXhwbG9yZXItY3RybC5qcyIsImFwaS1leHBsb3Jlci1kaXJlY3RpdmUuanMiLCJhcGktZXhwbG9yZXItanNlZGl0b3IuanMiLCJhcGktZXhwbG9yZXItbXNncmFwaC5qcyIsImF1dGguanMiLCJzaGFyZS1kaWFsb2cuanMiLCJhcGktZXhwbG9yZXItanN2aWV3ZXIuanMiLCJoaXN0b3J5LmpzIiwibG9jX3N0cmluZ3MuanMiLCJwb3N0VGVtcGxhdGVzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQ0ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNqREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDbFZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDbEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDckVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDblZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDN0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNsQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDekNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDM0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDckVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM3SkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDVEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBSnJJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiYWxsLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyohIGhlbGxvanMgdjEuMTQuMSB8IChjKSAyMDEyLTIwMTcgQW5kcmV3IERvZHNvbiB8IE1JVCBodHRwczovL2Fkb2Rzb24uY29tL2hlbGxvLmpzL0xJQ0VOU0UgKi9cbk9iamVjdC5jcmVhdGV8fChPYmplY3QuY3JlYXRlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe31yZXR1cm4gZnVuY3Rpb24odCl7aWYoMSE9YXJndW1lbnRzLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoXCJPYmplY3QuY3JlYXRlIGltcGxlbWVudGF0aW9uIG9ubHkgYWNjZXB0cyBvbmUgcGFyYW1ldGVyLlwiKTtyZXR1cm4gZS5wcm90b3R5cGU9dCxuZXcgZX19KCkpLE9iamVjdC5rZXlzfHwoT2JqZWN0LmtleXM9ZnVuY3Rpb24oZSx0LG4pe249W107Zm9yKHQgaW4gZSluLmhhc093blByb3BlcnR5LmNhbGwoZSx0KSYmbi5wdXNoKHQpO3JldHVybiBufSksQXJyYXkucHJvdG90eXBlLmluZGV4T2Z8fChBcnJheS5wcm90b3R5cGUuaW5kZXhPZj1mdW5jdGlvbihlKXtmb3IodmFyIHQ9MDt0PHRoaXMubGVuZ3RoO3QrKylpZih0aGlzW3RdPT09ZSlyZXR1cm4gdDtyZXR1cm4tMX0pLEFycmF5LnByb3RvdHlwZS5mb3JFYWNofHwoQXJyYXkucHJvdG90eXBlLmZvckVhY2g9ZnVuY3Rpb24oZSl7aWYodm9pZCAwPT09dGhpc3x8bnVsbD09PXRoaXMpdGhyb3cgbmV3IFR5cGVFcnJvcjt2YXIgdD1PYmplY3QodGhpcyksbj10Lmxlbmd0aD4+PjA7aWYoXCJmdW5jdGlvblwiIT10eXBlb2YgZSl0aHJvdyBuZXcgVHlwZUVycm9yO2Zvcih2YXIgbz1hcmd1bWVudHMubGVuZ3RoPj0yP2FyZ3VtZW50c1sxXTp2b2lkIDAsaT0wO24+aTtpKyspaSBpbiB0JiZlLmNhbGwobyx0W2ldLGksdCk7cmV0dXJuIHRoaXN9KSxBcnJheS5wcm90b3R5cGUuZmlsdGVyfHwoQXJyYXkucHJvdG90eXBlLmZpbHRlcj1mdW5jdGlvbihlLHQpe3ZhciBuPVtdO3JldHVybiB0aGlzLmZvckVhY2goZnVuY3Rpb24obyxpLHIpe2UuY2FsbCh0fHx2b2lkIDAsbyxpLHIpJiZuLnB1c2gobyl9KSxufSksQXJyYXkucHJvdG90eXBlLm1hcHx8KEFycmF5LnByb3RvdHlwZS5tYXA9ZnVuY3Rpb24oZSx0KXt2YXIgbj1bXTtyZXR1cm4gdGhpcy5mb3JFYWNoKGZ1bmN0aW9uKG8saSxyKXtuLnB1c2goZS5jYWxsKHR8fHZvaWQgMCxvLGkscikpfSksbn0pLEFycmF5LmlzQXJyYXl8fChBcnJheS5pc0FycmF5PWZ1bmN0aW9uKGUpe3JldHVyblwiW29iamVjdCBBcnJheV1cIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlKX0pLFwib2JqZWN0XCIhPXR5cGVvZiB3aW5kb3d8fFwib2JqZWN0XCIhPXR5cGVvZiB3aW5kb3cubG9jYXRpb258fHdpbmRvdy5sb2NhdGlvbi5hc3NpZ258fCh3aW5kb3cubG9jYXRpb24uYXNzaWduPWZ1bmN0aW9uKGUpe3dpbmRvdy5sb2NhdGlvbj1lfSksRnVuY3Rpb24ucHJvdG90eXBlLmJpbmR8fChGdW5jdGlvbi5wcm90b3R5cGUuYmluZD1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KCl7fWlmKFwiZnVuY3Rpb25cIiE9dHlwZW9mIHRoaXMpdGhyb3cgbmV3IFR5cGVFcnJvcihcIkZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kIC0gd2hhdCBpcyB0cnlpbmcgdG8gYmUgYm91bmQgaXMgbm90IGNhbGxhYmxlXCIpO3ZhciBuPVtdLnNsaWNlLG89bi5jYWxsKGFyZ3VtZW50cywxKSxpPXRoaXMscj1mdW5jdGlvbigpe3JldHVybiBpLmFwcGx5KHRoaXMgaW5zdGFuY2VvZiB0P3RoaXM6ZXx8d2luZG93LG8uY29uY2F0KG4uY2FsbChhcmd1bWVudHMpKSl9O3JldHVybiB0LnByb3RvdHlwZT10aGlzLnByb3RvdHlwZSxyLnByb3RvdHlwZT1uZXcgdCxyfSk7dmFyIGhlbGxvPWZ1bmN0aW9uKGUpe3JldHVybiBoZWxsby51c2UoZSl9O2hlbGxvLnV0aWxzPXtleHRlbmQ6ZnVuY3Rpb24oZSl7cmV0dXJuIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKS5mb3JFYWNoKGZ1bmN0aW9uKHQpe2lmKEFycmF5LmlzQXJyYXkoZSkmJkFycmF5LmlzQXJyYXkodCkpQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoZSx0KTtlbHNlIGlmKGUmJihlIGluc3RhbmNlb2YgT2JqZWN0fHxcIm9iamVjdFwiPT10eXBlb2YgZSkmJnQmJih0IGluc3RhbmNlb2YgT2JqZWN0fHxcIm9iamVjdFwiPT10eXBlb2YgdCkmJmUhPT10KWZvcih2YXIgbiBpbiB0KWVbbl09aGVsbG8udXRpbHMuZXh0ZW5kKGVbbl0sdFtuXSk7ZWxzZSBBcnJheS5pc0FycmF5KHQpJiYodD10LnNsaWNlKDApKSxlPXR9KSxlfX0saGVsbG8udXRpbHMuZXh0ZW5kKGhlbGxvLHtzZXR0aW5nczp7cmVkaXJlY3RfdXJpOndpbmRvdy5sb2NhdGlvbi5ocmVmLnNwbGl0KFwiI1wiKVswXSxyZXNwb25zZV90eXBlOlwidG9rZW5cIixkaXNwbGF5OlwicG9wdXBcIixzdGF0ZTpcIlwiLG9hdXRoX3Byb3h5OlwiaHR0cHM6Ly9hdXRoLXNlcnZlci5oZXJva3VhcHAuY29tL3Byb3h5XCIsdGltZW91dDoyZTQscG9wdXA6e3Jlc2l6YWJsZToxLHNjcm9sbGJhcnM6MSx3aWR0aDo1MDAsaGVpZ2h0OjU1MH0sc2NvcGU6W1wiYmFzaWNcIl0sc2NvcGVfbWFwOntiYXNpYzpcIlwifSxkZWZhdWx0X3NlcnZpY2U6bnVsbCxmb3JjZTpudWxsLHBhZ2VfdXJpOndpbmRvdy5sb2NhdGlvbi5ocmVmfSxzZXJ2aWNlczp7fSx1c2U6ZnVuY3Rpb24oZSl7dmFyIHQ9T2JqZWN0LmNyZWF0ZSh0aGlzKTtyZXR1cm4gdC5zZXR0aW5ncz1PYmplY3QuY3JlYXRlKHRoaXMuc2V0dGluZ3MpLGUmJih0LnNldHRpbmdzLmRlZmF1bHRfc2VydmljZT1lKSx0LnV0aWxzLkV2ZW50LmNhbGwodCksdH0saW5pdDpmdW5jdGlvbihlLHQpe3ZhciBuPXRoaXMudXRpbHM7aWYoIWUpcmV0dXJuIHRoaXMuc2VydmljZXM7Zm9yKHZhciBvIGluIGUpZS5oYXNPd25Qcm9wZXJ0eShvKSYmXCJvYmplY3RcIiE9dHlwZW9mIGVbb10mJihlW29dPXtpZDplW29dfSk7cmV0dXJuIG4uZXh0ZW5kKHRoaXMuc2VydmljZXMsZSksdCYmKG4uZXh0ZW5kKHRoaXMuc2V0dGluZ3MsdCksXCJyZWRpcmVjdF91cmlcImluIHQmJih0aGlzLnNldHRpbmdzLnJlZGlyZWN0X3VyaT1uLnVybCh0LnJlZGlyZWN0X3VyaSkuaHJlZikpLHRoaXN9LGxvZ2luOmZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQpe2hlbGxvLmVtaXQoZSx0KX1mdW5jdGlvbiB0KGUpe3JldHVybiBlfWZ1bmN0aW9uIG4oZSl7cmV0dXJuISFlfXZhciBvLGk9dGhpcyxyPWkudXRpbHMsYT1yLmVycm9yLHM9ci5Qcm9taXNlKCksbD1yLmFyZ3Moe25ldHdvcms6XCJzXCIsb3B0aW9uczpcIm9cIixjYWxsYmFjazpcImZcIn0sYXJndW1lbnRzKSx1PXIuZGlmZktleShsLm9wdGlvbnMsaS5zZXR0aW5ncyksYz1sLm9wdGlvbnM9ci5tZXJnZShpLnNldHRpbmdzLGwub3B0aW9uc3x8e30pO2lmKGMucG9wdXA9ci5tZXJnZShpLnNldHRpbmdzLnBvcHVwLGwub3B0aW9ucy5wb3B1cHx8e30pLGwubmV0d29yaz1sLm5ldHdvcmt8fGkuc2V0dGluZ3MuZGVmYXVsdF9zZXJ2aWNlLHMucHJveHkudGhlbihsLmNhbGxiYWNrLGwuY2FsbGJhY2spLHMucHJveHkudGhlbihlLmJpbmQodGhpcyxcImF1dGgubG9naW4gYXV0aFwiKSxlLmJpbmQodGhpcyxcImF1dGguZmFpbGVkIGF1dGhcIikpLFwic3RyaW5nXCIhPXR5cGVvZiBsLm5ldHdvcmt8fCEobC5uZXR3b3JrIGluIGkuc2VydmljZXMpKXJldHVybiBzLnJlamVjdChhKFwiaW52YWxpZF9uZXR3b3JrXCIsXCJUaGUgcHJvdmlkZWQgbmV0d29yayB3YXMgbm90IHJlY29nbml6ZWRcIikpO3ZhciBkPWkuc2VydmljZXNbbC5uZXR3b3JrXSxmPXIuZ2xvYmFsRXZlbnQoZnVuY3Rpb24oZSl7dmFyIHQ7dD1lP0pTT04ucGFyc2UoZSk6YShcImNhbmNlbGxlZFwiLFwiVGhlIGF1dGhlbnRpY2F0aW9uIHdhcyBub3QgY29tcGxldGVkXCIpLHQuZXJyb3I/cy5yZWplY3QodCk6KHIuc3RvcmUodC5uZXR3b3JrLHQpLHMuZnVsZmlsbCh7bmV0d29yazp0Lm5ldHdvcmssYXV0aFJlc3BvbnNlOnR9KSl9KSxwPXIudXJsKGMucmVkaXJlY3RfdXJpKS5ocmVmLG09ZC5vYXV0aC5yZXNwb25zZV90eXBlfHxjLnJlc3BvbnNlX3R5cGU7L1xcYmNvZGVcXGIvLnRlc3QobSkmJiFkLm9hdXRoLmdyYW50JiYobT1tLnJlcGxhY2UoL1xcYmNvZGVcXGIvLFwidG9rZW5cIikpLGwucXM9ci5tZXJnZSh1LHtjbGllbnRfaWQ6ZW5jb2RlVVJJQ29tcG9uZW50KGQuaWQpLHJlc3BvbnNlX3R5cGU6ZW5jb2RlVVJJQ29tcG9uZW50KG0pLHJlZGlyZWN0X3VyaTplbmNvZGVVUklDb21wb25lbnQocCksc3RhdGU6e2NsaWVudF9pZDpkLmlkLG5ldHdvcms6bC5uZXR3b3JrLGRpc3BsYXk6Yy5kaXNwbGF5LGNhbGxiYWNrOmYsc3RhdGU6Yy5zdGF0ZSxyZWRpcmVjdF91cmk6cH19KTt2YXIgaD1yLnN0b3JlKGwubmV0d29yayksZz0vWyxcXHNdKy8sdj1pLnNldHRpbmdzLnNjb3BlP1tpLnNldHRpbmdzLnNjb3BlLnRvU3RyaW5nKCldOltdLHk9ci5tZXJnZShpLnNldHRpbmdzLnNjb3BlX21hcCxkLnNjb3BlfHx7fSk7aWYoYy5zY29wZSYmdi5wdXNoKGMuc2NvcGUudG9TdHJpbmcoKSksaCYmXCJzY29wZVwiaW4gaCYmaC5zY29wZSBpbnN0YW5jZW9mIFN0cmluZyYmdi5wdXNoKGguc2NvcGUpLHY9di5qb2luKFwiLFwiKS5zcGxpdChnKSx2PXIudW5pcXVlKHYpLmZpbHRlcihuKSxsLnFzLnN0YXRlLnNjb3BlPXYuam9pbihcIixcIiksdj12Lm1hcChmdW5jdGlvbihlKXtyZXR1cm4gZSBpbiB5P3lbZV06ZX0pLHY9di5qb2luKFwiLFwiKS5zcGxpdChnKSx2PXIudW5pcXVlKHYpLmZpbHRlcihuKSxsLnFzLnNjb3BlPXYuam9pbihkLnNjb3BlX2RlbGltfHxcIixcIiksYy5mb3JjZT09PSExJiZoJiZcImFjY2Vzc190b2tlblwiaW4gaCYmaC5hY2Nlc3NfdG9rZW4mJlwiZXhwaXJlc1wiaW4gaCYmaC5leHBpcmVzPihuZXcgRGF0ZSkuZ2V0VGltZSgpLzFlMyl7dmFyIHc9ci5kaWZmKChoLnNjb3BlfHxcIlwiKS5zcGxpdChnKSwobC5xcy5zdGF0ZS5zY29wZXx8XCJcIikuc3BsaXQoZykpO2lmKDA9PT13Lmxlbmd0aClyZXR1cm4gcy5mdWxmaWxsKHt1bmNoYW5nZWQ6ITAsbmV0d29yazpsLm5ldHdvcmssYXV0aFJlc3BvbnNlOmh9KSxzfWlmKFwicGFnZVwiPT09Yy5kaXNwbGF5JiZjLnBhZ2VfdXJpJiYobC5xcy5zdGF0ZS5wYWdlX3VyaT1yLnVybChjLnBhZ2VfdXJpKS5ocmVmKSxcImxvZ2luXCJpbiBkJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBkLmxvZ2luJiZkLmxvZ2luKGwpLCghL1xcYnRva2VuXFxiLy50ZXN0KG0pfHxwYXJzZUludChkLm9hdXRoLnZlcnNpb24sMTApPDJ8fFwibm9uZVwiPT09Yy5kaXNwbGF5JiZkLm9hdXRoLmdyYW50JiZoJiZoLnJlZnJlc2hfdG9rZW4pJiYobC5xcy5zdGF0ZS5vYXV0aD1kLm9hdXRoLGwucXMuc3RhdGUub2F1dGhfcHJveHk9Yy5vYXV0aF9wcm94eSksbC5xcy5zdGF0ZT1lbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkobC5xcy5zdGF0ZSkpLDE9PT1wYXJzZUludChkLm9hdXRoLnZlcnNpb24sMTApP289ci5xcyhjLm9hdXRoX3Byb3h5LGwucXMsdCk6XCJub25lXCI9PT1jLmRpc3BsYXkmJmQub2F1dGguZ3JhbnQmJmgmJmgucmVmcmVzaF90b2tlbj8obC5xcy5yZWZyZXNoX3Rva2VuPWgucmVmcmVzaF90b2tlbixvPXIucXMoYy5vYXV0aF9wcm94eSxsLnFzLHQpKTpvPXIucXMoZC5vYXV0aC5hdXRoLGwucXMsdCksZShcImF1dGguaW5pdFwiLGwpLFwibm9uZVwiPT09Yy5kaXNwbGF5KXIuaWZyYW1lKG8scCk7ZWxzZSBpZihcInBvcHVwXCI9PT1jLmRpc3BsYXkpdmFyIF89ci5wb3B1cChvLHAsYy5wb3B1cCksYj1zZXRJbnRlcnZhbChmdW5jdGlvbigpe2lmKCghX3x8Xy5jbG9zZWQpJiYoY2xlYXJJbnRlcnZhbChiKSwhcy5zdGF0ZSkpe3ZhciBlPWEoXCJjYW5jZWxsZWRcIixcIkxvZ2luIGhhcyBiZWVuIGNhbmNlbGxlZFwiKTtffHwoZT1hKFwiYmxvY2tlZFwiLFwiUG9wdXAgd2FzIGJsb2NrZWRcIikpLGUubmV0d29yaz1sLm5ldHdvcmsscy5yZWplY3QoZSl9fSwxMDApO2Vsc2Ugd2luZG93LmxvY2F0aW9uPW87cmV0dXJuIHMucHJveHl9LGxvZ291dDpmdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0KXtoZWxsby5lbWl0KGUsdCl9dmFyIHQ9dGhpcyxuPXQudXRpbHMsbz1uLmVycm9yLGk9bi5Qcm9taXNlKCkscj1uLmFyZ3Moe25hbWU6XCJzXCIsb3B0aW9uczpcIm9cIixjYWxsYmFjazpcImZcIn0sYXJndW1lbnRzKTtpZihyLm9wdGlvbnM9ci5vcHRpb25zfHx7fSxpLnByb3h5LnRoZW4oci5jYWxsYmFjayxyLmNhbGxiYWNrKSxpLnByb3h5LnRoZW4oZS5iaW5kKHRoaXMsXCJhdXRoLmxvZ291dCBhdXRoXCIpLGUuYmluZCh0aGlzLFwiZXJyb3JcIikpLHIubmFtZT1yLm5hbWV8fHRoaXMuc2V0dGluZ3MuZGVmYXVsdF9zZXJ2aWNlLHIuYXV0aFJlc3BvbnNlPW4uc3RvcmUoci5uYW1lKSwhci5uYW1lfHxyLm5hbWUgaW4gdC5zZXJ2aWNlcylpZihyLm5hbWUmJnIuYXV0aFJlc3BvbnNlKXt2YXIgYT1mdW5jdGlvbihlKXtuLnN0b3JlKHIubmFtZSxudWxsKSxpLmZ1bGZpbGwoaGVsbG8udXRpbHMubWVyZ2Uoe25ldHdvcms6ci5uYW1lfSxlfHx7fSkpfSxzPXt9O2lmKHIub3B0aW9ucy5mb3JjZSl7dmFyIGw9dC5zZXJ2aWNlc1tyLm5hbWVdLmxvZ291dDtpZihsKWlmKFwiZnVuY3Rpb25cIj09dHlwZW9mIGwmJihsPWwoYSxyKSksXCJzdHJpbmdcIj09dHlwZW9mIGwpbi5pZnJhbWUobCkscy5mb3JjZT1udWxsLHMubWVzc2FnZT1cIkxvZ291dCBzdWNjZXNzIG9uIHByb3ZpZGVycyBzaXRlIHdhcyBpbmRldGVybWluYXRlXCI7ZWxzZSBpZih2b2lkIDA9PT1sKXJldHVybiBpLnByb3h5fWEocyl9ZWxzZSBpLnJlamVjdChvKFwiaW52YWxpZF9zZXNzaW9uXCIsXCJUaGVyZSB3YXMgbm8gc2Vzc2lvbiB0byByZW1vdmVcIikpO2Vsc2UgaS5yZWplY3QobyhcImludmFsaWRfbmV0d29ya1wiLFwiVGhlIG5ldHdvcmsgd2FzIHVucmVjb2duaXplZFwiKSk7cmV0dXJuIGkucHJveHl9LGdldEF1dGhSZXNwb25zZTpmdW5jdGlvbihlKXtyZXR1cm4gZT1lfHx0aGlzLnNldHRpbmdzLmRlZmF1bHRfc2VydmljZSxlJiZlIGluIHRoaXMuc2VydmljZXM/dGhpcy51dGlscy5zdG9yZShlKXx8bnVsbDpudWxsfSxldmVudHM6e319KSxoZWxsby51dGlscy5leHRlbmQoaGVsbG8udXRpbHMse2Vycm9yOmZ1bmN0aW9uKGUsdCl7cmV0dXJue2Vycm9yOntjb2RlOmUsbWVzc2FnZTp0fX19LHFzOmZ1bmN0aW9uKGUsdCxuKXtpZih0KXtuPW58fGVuY29kZVVSSUNvbXBvbmVudDtmb3IodmFyIG8gaW4gdCl7dmFyIGk9XCIoW1xcXFw/XFxcXCZdKVwiK28rXCI9W15cXFxcJl0qXCIscj1uZXcgUmVnRXhwKGkpO2UubWF0Y2gocikmJihlPWUucmVwbGFjZShyLFwiJDFcIitvK1wiPVwiK24odFtvXSkpLGRlbGV0ZSB0W29dKX19cmV0dXJuIHRoaXMuaXNFbXB0eSh0KT9lOmUrKGUuaW5kZXhPZihcIj9cIik+LTE/XCImXCI6XCI/XCIpK3RoaXMucGFyYW0odCxuKX0scGFyYW06ZnVuY3Rpb24oZSx0KXt2YXIgbixvLGk9e307aWYoXCJzdHJpbmdcIj09dHlwZW9mIGUpe2lmKHQ9dHx8ZGVjb2RlVVJJQ29tcG9uZW50LG89ZS5yZXBsYWNlKC9eW1xcI1xcP10vLFwiXCIpLm1hdGNoKC8oW149XFwvXFwmXSspPShbXlxcJl0rKS9nKSlmb3IodmFyIHI9MDtyPG8ubGVuZ3RoO3IrKyluPW9bcl0ubWF0Y2goLyhbXj1dKyk9KC4qKS8pLGlbblsxXV09dChuWzJdKTtyZXR1cm4gaX10PXR8fGVuY29kZVVSSUNvbXBvbmVudDt2YXIgYT1lO2k9W107Zm9yKHZhciBzIGluIGEpYS5oYXNPd25Qcm9wZXJ0eShzKSYmYS5oYXNPd25Qcm9wZXJ0eShzKSYmaS5wdXNoKFtzLFwiP1wiPT09YVtzXT9cIj9cIjp0KGFbc10pXS5qb2luKFwiPVwiKSk7cmV0dXJuIGkuam9pbihcIiZcIil9LHN0b3JlOmZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe3ZhciBlPXt9O3RyeXtlPUpTT04ucGFyc2Uobi5nZXRJdGVtKFwiaGVsbG9cIikpfHx7fX1jYXRjaCh0KXt9cmV0dXJuIGV9ZnVuY3Rpb24gdChlKXtuLnNldEl0ZW0oXCJoZWxsb1wiLEpTT04uc3RyaW5naWZ5KGUpKX1mb3IodmFyIG4sbz1bXCJsb2NhbFN0b3JhZ2VcIixcInNlc3Npb25TdG9yYWdlXCJdLGk9LTEscj1cInRlc3RcIjtvWysraV07KXRyeXtuPXdpbmRvd1tvW2ldXSxuLnNldEl0ZW0ocitpLGkpLG4ucmVtb3ZlSXRlbShyK2kpO2JyZWFrfWNhdGNoKGEpe249bnVsbH1pZighbil7dmFyIHM9bnVsbDtuPXtnZXRJdGVtOmZ1bmN0aW9uKGUpe2UrPVwiPVwiO2Zvcih2YXIgdD1kb2N1bWVudC5jb29raWUuc3BsaXQoXCI7XCIpLG49MDtuPHQubGVuZ3RoO24rKyl7dmFyIG89dFtuXS5yZXBsYWNlKC8oXlxccyt8XFxzKyQpLyxcIlwiKTtpZihvJiYwPT09by5pbmRleE9mKGUpKXJldHVybiBvLnN1YnN0cihlLmxlbmd0aCl9cmV0dXJuIHN9LHNldEl0ZW06ZnVuY3Rpb24oZSx0KXtzPXQsZG9jdW1lbnQuY29va2llPWUrXCI9XCIrdH19LHM9bi5nZXRJdGVtKFwiaGVsbG9cIil9cmV0dXJuIGZ1bmN0aW9uKG4sbyxpKXt2YXIgcj1lKCk7aWYobiYmdm9pZCAwPT09bylyZXR1cm4gcltuXXx8bnVsbDtpZihuJiZudWxsPT09byl0cnl7ZGVsZXRlIHJbbl19Y2F0Y2goYSl7cltuXT1udWxsfWVsc2V7aWYoIW4pcmV0dXJuIHI7cltuXT1vfXJldHVybiB0KHIpLHJ8fG51bGx9fSgpLGFwcGVuZDpmdW5jdGlvbihlLHQsbil7dmFyIG89XCJzdHJpbmdcIj09dHlwZW9mIGU/ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChlKTplO2lmKFwib2JqZWN0XCI9PXR5cGVvZiB0KWlmKFwidGFnTmFtZVwiaW4gdCluPXQ7ZWxzZSBmb3IodmFyIGkgaW4gdClpZih0Lmhhc093blByb3BlcnR5KGkpKWlmKFwib2JqZWN0XCI9PXR5cGVvZiB0W2ldKWZvcih2YXIgciBpbiB0W2ldKXRbaV0uaGFzT3duUHJvcGVydHkocikmJihvW2ldW3JdPXRbaV1bcl0pO2Vsc2VcImh0bWxcIj09PWk/by5pbm5lckhUTUw9dFtpXTovXm9uLy50ZXN0KGkpP29baV09dFtpXTpvLnNldEF0dHJpYnV0ZShpLHRbaV0pO3JldHVyblwiYm9keVwiPT09bj8hZnVuY3Rpb24gYSgpe2RvY3VtZW50LmJvZHk/ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChvKTpzZXRUaW1lb3V0KGEsMTYpfSgpOlwib2JqZWN0XCI9PXR5cGVvZiBuP24uYXBwZW5kQ2hpbGQobyk6XCJzdHJpbmdcIj09dHlwZW9mIG4mJmRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKG4pWzBdLmFwcGVuZENoaWxkKG8pLG99LGlmcmFtZTpmdW5jdGlvbihlKXt0aGlzLmFwcGVuZChcImlmcmFtZVwiLHtzcmM6ZSxzdHlsZTp7cG9zaXRpb246XCJhYnNvbHV0ZVwiLGxlZnQ6XCItMTAwMHB4XCIsYm90dG9tOjAsaGVpZ2h0OlwiMXB4XCIsd2lkdGg6XCIxcHhcIn19LFwiYm9keVwiKX0sbWVyZ2U6ZnVuY3Rpb24oKXt2YXIgZT1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO3JldHVybiBlLnVuc2hpZnQoe30pLHRoaXMuZXh0ZW5kLmFwcGx5KG51bGwsZSl9LGFyZ3M6ZnVuY3Rpb24oZSx0KXt2YXIgbj17fSxvPTAsaT1udWxsLHI9bnVsbDtmb3IociBpbiBlKWlmKGUuaGFzT3duUHJvcGVydHkocikpYnJlYWs7aWYoMT09PXQubGVuZ3RoJiZcIm9iamVjdFwiPT10eXBlb2YgdFswXSYmXCJvIVwiIT1lW3JdKWZvcihyIGluIHRbMF0paWYoZS5oYXNPd25Qcm9wZXJ0eShyKSYmciBpbiBlKXJldHVybiB0WzBdO2ZvcihyIGluIGUpaWYoZS5oYXNPd25Qcm9wZXJ0eShyKSlpZihpPXR5cGVvZiB0W29dLFwiZnVuY3Rpb25cIj09dHlwZW9mIGVbcl0mJmVbcl0udGVzdCh0W29dKXx8XCJzdHJpbmdcIj09dHlwZW9mIGVbcl0mJihlW3JdLmluZGV4T2YoXCJzXCIpPi0xJiZcInN0cmluZ1wiPT09aXx8ZVtyXS5pbmRleE9mKFwib1wiKT4tMSYmXCJvYmplY3RcIj09PWl8fGVbcl0uaW5kZXhPZihcImlcIik+LTEmJlwibnVtYmVyXCI9PT1pfHxlW3JdLmluZGV4T2YoXCJhXCIpPi0xJiZcIm9iamVjdFwiPT09aXx8ZVtyXS5pbmRleE9mKFwiZlwiKT4tMSYmXCJmdW5jdGlvblwiPT09aSkpbltyXT10W28rK107ZWxzZSBpZihcInN0cmluZ1wiPT10eXBlb2YgZVtyXSYmZVtyXS5pbmRleE9mKFwiIVwiKT4tMSlyZXR1cm4hMTtyZXR1cm4gbn0sdXJsOmZ1bmN0aW9uKGUpe2lmKGUpe2lmKHdpbmRvdy5VUkwmJlVSTCBpbnN0YW5jZW9mIEZ1bmN0aW9uJiYwIT09VVJMLmxlbmd0aClyZXR1cm4gbmV3IFVSTChlLHdpbmRvdy5sb2NhdGlvbik7dmFyIHQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIik7cmV0dXJuIHQuaHJlZj1lLHQuY2xvbmVOb2RlKCExKX1yZXR1cm4gd2luZG93LmxvY2F0aW9ufSxkaWZmOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQuZmlsdGVyKGZ1bmN0aW9uKHQpe3JldHVybi0xPT09ZS5pbmRleE9mKHQpfSl9LGRpZmZLZXk6ZnVuY3Rpb24oZSx0KXtpZihlfHwhdCl7dmFyIG49e307Zm9yKHZhciBvIGluIGUpbyBpbiB0fHwobltvXT1lW29dKTtyZXR1cm4gbn1yZXR1cm4gZX0sdW5pcXVlOmZ1bmN0aW9uKGUpe3JldHVybiBBcnJheS5pc0FycmF5KGUpP2UuZmlsdGVyKGZ1bmN0aW9uKHQsbil7cmV0dXJuIGUuaW5kZXhPZih0KT09PW59KTpbXX0saXNFbXB0eTpmdW5jdGlvbihlKXtpZighZSlyZXR1cm4hMDtpZihBcnJheS5pc0FycmF5KGUpKXJldHVybiFlLmxlbmd0aDtpZihcIm9iamVjdFwiPT10eXBlb2YgZSlmb3IodmFyIHQgaW4gZSlpZihlLmhhc093blByb3BlcnR5KHQpKXJldHVybiExO3JldHVybiEwfSxQcm9taXNlOmZ1bmN0aW9uKCl7dmFyIGU9MCx0PTEsbj0yLG89ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBvPyh0aGlzLmlkPVwiVGhlbmFibGUvMS4wLjZcIix0aGlzLnN0YXRlPWUsdGhpcy5mdWxmaWxsVmFsdWU9dm9pZCAwLHRoaXMucmVqZWN0UmVhc29uPXZvaWQgMCx0aGlzLm9uRnVsZmlsbGVkPVtdLHRoaXMub25SZWplY3RlZD1bXSx0aGlzLnByb3h5PXt0aGVuOnRoaXMudGhlbi5iaW5kKHRoaXMpfSx2b2lkKFwiZnVuY3Rpb25cIj09dHlwZW9mIHQmJnQuY2FsbCh0aGlzLHRoaXMuZnVsZmlsbC5iaW5kKHRoaXMpLHRoaXMucmVqZWN0LmJpbmQodGhpcykpKSk6bmV3IG8odCl9O28ucHJvdG90eXBlPXtmdWxmaWxsOmZ1bmN0aW9uKGUpe3JldHVybiBpKHRoaXMsdCxcImZ1bGZpbGxWYWx1ZVwiLGUpfSxyZWplY3Q6ZnVuY3Rpb24oZSl7cmV0dXJuIGkodGhpcyxuLFwicmVqZWN0UmVhc29uXCIsZSl9LHRoZW46ZnVuY3Rpb24oZSx0KXt2YXIgbj10aGlzLGk9bmV3IG87cmV0dXJuIG4ub25GdWxmaWxsZWQucHVzaChzKGUsaSxcImZ1bGZpbGxcIikpLG4ub25SZWplY3RlZC5wdXNoKHModCxpLFwicmVqZWN0XCIpKSxyKG4pLGkucHJveHl9fTt2YXIgaT1mdW5jdGlvbih0LG4sbyxpKXtyZXR1cm4gdC5zdGF0ZT09PWUmJih0LnN0YXRlPW4sdFtvXT1pLHIodCkpLHR9LHI9ZnVuY3Rpb24oZSl7ZS5zdGF0ZT09PXQ/YShlLFwib25GdWxmaWxsZWRcIixlLmZ1bGZpbGxWYWx1ZSk6ZS5zdGF0ZT09PW4mJmEoZSxcIm9uUmVqZWN0ZWRcIixlLnJlamVjdFJlYXNvbil9LGE9ZnVuY3Rpb24oZSx0LG4pe2lmKDAhPT1lW3RdLmxlbmd0aCl7dmFyIG89ZVt0XTtlW3RdPVtdO3ZhciBpPWZ1bmN0aW9uKCl7Zm9yKHZhciBlPTA7ZTxvLmxlbmd0aDtlKyspb1tlXShuKX07XCJvYmplY3RcIj09dHlwZW9mIHByb2Nlc3MmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHByb2Nlc3MubmV4dFRpY2s/cHJvY2Vzcy5uZXh0VGljayhpKTpcImZ1bmN0aW9uXCI9PXR5cGVvZiBzZXRJbW1lZGlhdGU/c2V0SW1tZWRpYXRlKGkpOnNldFRpbWVvdXQoaSwwKX19LHM9ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBmdW5jdGlvbihvKXtpZihcImZ1bmN0aW9uXCIhPXR5cGVvZiBlKXRbbl0uY2FsbCh0LG8pO2Vsc2V7dmFyIGk7dHJ5e2k9ZShvKX1jYXRjaChyKXtyZXR1cm4gdm9pZCB0LnJlamVjdChyKX1sKHQsaSl9fX0sbD1mdW5jdGlvbihlLHQpe2lmKGU9PT10fHxlLnByb3h5PT09dClyZXR1cm4gdm9pZCBlLnJlamVjdChuZXcgVHlwZUVycm9yKFwiY2Fubm90IHJlc29sdmUgcHJvbWlzZSB3aXRoIGl0c2VsZlwiKSk7dmFyIG47aWYoXCJvYmplY3RcIj09dHlwZW9mIHQmJm51bGwhPT10fHxcImZ1bmN0aW9uXCI9PXR5cGVvZiB0KXRyeXtuPXQudGhlbn1jYXRjaChvKXtyZXR1cm4gdm9pZCBlLnJlamVjdChvKX1pZihcImZ1bmN0aW9uXCIhPXR5cGVvZiBuKWUuZnVsZmlsbCh0KTtlbHNle3ZhciBpPSExO3RyeXtuLmNhbGwodCxmdW5jdGlvbihuKXtpfHwoaT0hMCxuPT09dD9lLnJlamVjdChuZXcgVHlwZUVycm9yKFwiY2lyY3VsYXIgdGhlbmFibGUgY2hhaW5cIikpOmwoZSxuKSl9LGZ1bmN0aW9uKHQpe2l8fChpPSEwLGUucmVqZWN0KHQpKX0pfWNhdGNoKG8pe2l8fGUucmVqZWN0KG8pfX19O3JldHVybiBvfSgpLEV2ZW50OmZ1bmN0aW9uKCl7dmFyIGU9L1tcXHNcXCxdKy87cmV0dXJuIHRoaXMucGFyZW50PXtldmVudHM6dGhpcy5ldmVudHMsZmluZEV2ZW50czp0aGlzLmZpbmRFdmVudHMscGFyZW50OnRoaXMucGFyZW50LHV0aWxzOnRoaXMudXRpbHN9LHRoaXMuZXZlbnRzPXt9LHRoaXMub249ZnVuY3Rpb24odCxuKXtpZihuJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBuKWZvcih2YXIgbz10LnNwbGl0KGUpLGk9MDtpPG8ubGVuZ3RoO2krKyl0aGlzLmV2ZW50c1tvW2ldXT1bbl0uY29uY2F0KHRoaXMuZXZlbnRzW29baV1dfHxbXSk7cmV0dXJuIHRoaXN9LHRoaXMub2ZmPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuZmluZEV2ZW50cyhlLGZ1bmN0aW9uKGUsbil7dCYmdGhpcy5ldmVudHNbZV1bbl0hPT10fHwodGhpcy5ldmVudHNbZV1bbl09bnVsbCl9KSx0aGlzfSx0aGlzLmVtaXQ9ZnVuY3Rpb24oZSl7dmFyIHQ9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpO3QucHVzaChlKTtmb3IodmFyIG49ZnVuY3Rpb24obixvKXt0W3QubGVuZ3RoLTFdPVwiKlwiPT09bj9lOm4sdGhpcy5ldmVudHNbbl1bb10uYXBwbHkodGhpcyx0KX0sbz10aGlzO28mJm8uZmluZEV2ZW50czspby5maW5kRXZlbnRzKGUrXCIsKlwiLG4pLG89by5wYXJlbnQ7cmV0dXJuIHRoaXN9LHRoaXMuZW1pdEFmdGVyPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcyx0PWFyZ3VtZW50cztyZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpe2UuZW1pdC5hcHBseShlLHQpfSwwKSx0aGlzfSx0aGlzLmZpbmRFdmVudHM9ZnVuY3Rpb24odCxuKXt2YXIgbz10LnNwbGl0KGUpO2Zvcih2YXIgaSBpbiB0aGlzLmV2ZW50cylpZih0aGlzLmV2ZW50cy5oYXNPd25Qcm9wZXJ0eShpKSYmby5pbmRleE9mKGkpPi0xKWZvcih2YXIgcj0wO3I8dGhpcy5ldmVudHNbaV0ubGVuZ3RoO3IrKyl0aGlzLmV2ZW50c1tpXVtyXSYmbi5jYWxsKHRoaXMsaSxyKX0sdGhpc30sZ2xvYmFsRXZlbnQ6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdD10fHxcIl9oZWxsb2pzX1wiK3BhcnNlSW50KDFlMTIqTWF0aC5yYW5kb20oKSwxMCkudG9TdHJpbmcoMzYpLHdpbmRvd1t0XT1mdW5jdGlvbigpe3RyeXtlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSYmZGVsZXRlIHdpbmRvd1t0XX1jYXRjaChuKXtjb25zb2xlLmVycm9yKG4pfX0sdH0scG9wdXA6ZnVuY3Rpb24oZSx0LG4pe3ZhciBvPWRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtpZihuLmhlaWdodCl7dmFyIGk9dm9pZCAwIT09d2luZG93LnNjcmVlblRvcD93aW5kb3cuc2NyZWVuVG9wOnNjcmVlbi50b3Ascj1zY3JlZW4uaGVpZ2h0fHx3aW5kb3cuaW5uZXJIZWlnaHR8fG8uY2xpZW50SGVpZ2h0O24udG9wPXBhcnNlSW50KChyLW4uaGVpZ2h0KS8yLDEwKStpfWlmKG4ud2lkdGgpe3ZhciBhPXZvaWQgMCE9PXdpbmRvdy5zY3JlZW5MZWZ0P3dpbmRvdy5zY3JlZW5MZWZ0OnNjcmVlbi5sZWZ0LHM9c2NyZWVuLndpZHRofHx3aW5kb3cuaW5uZXJXaWR0aHx8by5jbGllbnRXaWR0aDtuLmxlZnQ9cGFyc2VJbnQoKHMtbi53aWR0aCkvMiwxMCkrYX12YXIgbD1bXTtPYmplY3Qua2V5cyhuKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe3ZhciB0PW5bZV07bC5wdXNoKGUrKG51bGwhPT10P1wiPVwiK3Q6XCJcIikpfSksLTEhPT1uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoXCJTYWZhcmlcIikmJi0xPT09bmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKFwiQ2hyb21lXCIpJiYoZT10K1wiI29hdXRoX3JlZGlyZWN0PVwiK2VuY29kZVVSSUNvbXBvbmVudChlbmNvZGVVUklDb21wb25lbnQoZSkpKTt2YXIgdT13aW5kb3cub3BlbihlLFwiX2JsYW5rXCIsbC5qb2luKFwiLFwiKSk7cmV0dXJuIHUmJnUuZm9jdXMmJnUuZm9jdXMoKSx1fSxyZXNwb25zZUhhbmRsZXI6ZnVuY3Rpb24oZSx0KXtmdW5jdGlvbiBuKGUsdCxuKXt2YXIgcj1lLmNhbGxiYWNrLHM9ZS5uZXR3b3JrO2lmKGEuc3RvcmUocyxlKSwhKFwiZGlzcGxheVwiaW4gZSYmXCJwYWdlXCI9PT1lLmRpc3BsYXkpKXtpZihuJiZyJiZyIGluIG4pe3RyeXtkZWxldGUgZS5jYWxsYmFja31jYXRjaChsKXt9YS5zdG9yZShzLGUpO3ZhciB1PUpTT04uc3RyaW5naWZ5KGUpO3RyeXtvKG4scikodSl9Y2F0Y2gobCl7fX1pKCl9fWZ1bmN0aW9uIG8oZSx0KXtyZXR1cm4gMCE9PXQuaW5kZXhPZihcIl9oZWxsb2pzX1wiKT9mdW5jdGlvbigpe3Rocm93XCJDb3VsZCBub3QgZXhlY3V0ZSBjYWxsYmFjayBcIit0fTplW3RdfWZ1bmN0aW9uIGkoKXtpZihlLmZyYW1lRWxlbWVudCl0LmRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZS5mcmFtZUVsZW1lbnQpO2Vsc2V7dHJ5e2UuY2xvc2UoKX1jYXRjaChuKXt9ZS5hZGRFdmVudExpc3RlbmVyJiZlLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsZnVuY3Rpb24oKXtlLmNsb3NlKCl9KX19dmFyIHIsYT10aGlzLHM9ZS5sb2NhdGlvbjtpZihyPWEucGFyYW0ocy5zZWFyY2gpLHImJnIuc3RhdGUmJihyLmNvZGV8fHIub2F1dGhfdG9rZW4pKXt2YXIgbD1KU09OLnBhcnNlKHIuc3RhdGUpO3IucmVkaXJlY3RfdXJpPWwucmVkaXJlY3RfdXJpfHxzLmhyZWYucmVwbGFjZSgvW1xcP1xcI10uKiQvLFwiXCIpO3ZhciB1PWwub2F1dGhfcHJveHkrXCI/XCIrYS5wYXJhbShyKTtyZXR1cm4gdm9pZCBzLmFzc2lnbih1KX1pZihyPWEubWVyZ2UoYS5wYXJhbShzLnNlYXJjaHx8XCJcIiksYS5wYXJhbShzLmhhc2h8fFwiXCIpKSxyJiZcInN0YXRlXCJpbiByKXt0cnl7dmFyIGM9SlNPTi5wYXJzZShyLnN0YXRlKTthLmV4dGVuZChyLGMpfWNhdGNoKGQpe2NvbnNvbGUuZXJyb3IoXCJDb3VsZCBub3QgZGVjb2RlIHN0YXRlIHBhcmFtZXRlclwiKX1pZihcImFjY2Vzc190b2tlblwiaW4gciYmci5hY2Nlc3NfdG9rZW4mJnIubmV0d29yaylyLmV4cGlyZXNfaW4mJjAhPT1wYXJzZUludChyLmV4cGlyZXNfaW4sMTApfHwoci5leHBpcmVzX2luPTApLHIuZXhwaXJlc19pbj1wYXJzZUludChyLmV4cGlyZXNfaW4sMTApLHIuZXhwaXJlcz0obmV3IERhdGUpLmdldFRpbWUoKS8xZTMrKHIuZXhwaXJlc19pbnx8MzE1MzZlMyksbihyLGUsdCk7ZWxzZSBpZihcImVycm9yXCJpbiByJiZyLmVycm9yJiZyLm5ldHdvcmspci5lcnJvcj17Y29kZTpyLmVycm9yLG1lc3NhZ2U6ci5lcnJvcl9tZXNzYWdlfHxyLmVycm9yX2Rlc2NyaXB0aW9ufSxuKHIsZSx0KTtlbHNlIGlmKHIuY2FsbGJhY2smJnIuY2FsbGJhY2sgaW4gdCl7dmFyIGY9XCJyZXN1bHRcImluIHImJnIucmVzdWx0P0pTT04ucGFyc2Uoci5yZXN1bHQpOiExO28odCxyLmNhbGxiYWNrKShmKSxpKCl9ci5wYWdlX3VyaSYmcy5hc3NpZ24oci5wYWdlX3VyaSl9ZWxzZSBpZihcIm9hdXRoX3JlZGlyZWN0XCJpbiByKXJldHVybiB2b2lkIHMuYXNzaWduKGRlY29kZVVSSUNvbXBvbmVudChyLm9hdXRoX3JlZGlyZWN0KSl9fSksaGVsbG8udXRpbHMuRXZlbnQuY2FsbChoZWxsbyksZnVuY3Rpb24oZSl7dmFyIHQ9e30sbj17fTtlLm9uKFwiYXV0aC5sb2dpbiwgYXV0aC5sb2dvdXRcIixmdW5jdGlvbihuKXtuJiZcIm9iamVjdFwiPT10eXBlb2YgbiYmbi5uZXR3b3JrJiYodFtuLm5ldHdvcmtdPWUudXRpbHMuc3RvcmUobi5uZXR3b3JrKXx8e30pfSksZnVuY3Rpb24gbygpe3ZhciBpPShuZXcgRGF0ZSkuZ2V0VGltZSgpLzFlMyxyPWZ1bmN0aW9uKHQpe2UuZW1pdChcImF1dGguXCIrdCx7bmV0d29yazphLGF1dGhSZXNwb25zZTpzfSl9O2Zvcih2YXIgYSBpbiBlLnNlcnZpY2VzKWlmKGUuc2VydmljZXMuaGFzT3duUHJvcGVydHkoYSkpe2lmKCFlLnNlcnZpY2VzW2FdLmlkKWNvbnRpbnVlO3ZhciBzPWUudXRpbHMuc3RvcmUoYSl8fHt9LGw9ZS5zZXJ2aWNlc1thXSx1PXRbYV18fHt9O2lmKHMmJlwiY2FsbGJhY2tcImluIHMpe3ZhciBjPXMuY2FsbGJhY2s7dHJ5e2RlbGV0ZSBzLmNhbGxiYWNrfWNhdGNoKGQpe31lLnV0aWxzLnN0b3JlKGEscyk7dHJ5e3dpbmRvd1tjXShzKX1jYXRjaChkKXt9fWlmKHMmJlwiZXhwaXJlc1wiaW4gcyYmcy5leHBpcmVzPGkpe3ZhciBmPWwucmVmcmVzaHx8cy5yZWZyZXNoX3Rva2VuOyFmfHxhIGluIG4mJiEoblthXTxpKT9mfHxhIGluIG58fChyKFwiZXhwaXJlZFwiKSxuW2FdPSEwKTooZS5lbWl0KFwibm90aWNlXCIsYStcIiBoYXMgZXhwaXJlZCB0cnlpbmcgdG8gcmVzaWduaW5cIiksZS5sb2dpbihhLHtkaXNwbGF5Olwibm9uZVwiLGZvcmNlOiExfSksblthXT1pKzYwMCk7Y29udGludWV9aWYodS5hY2Nlc3NfdG9rZW49PT1zLmFjY2Vzc190b2tlbiYmdS5leHBpcmVzPT09cy5leHBpcmVzKWNvbnRpbnVlOyFzLmFjY2Vzc190b2tlbiYmdS5hY2Nlc3NfdG9rZW4/cihcImxvZ291dFwiKTpzLmFjY2Vzc190b2tlbiYmIXUuYWNjZXNzX3Rva2VuP3IoXCJsb2dpblwiKTpzLmV4cGlyZXMhPT11LmV4cGlyZXMmJnIoXCJ1cGRhdGVcIiksdFthXT1zLGEgaW4gbiYmZGVsZXRlIG5bYV19c2V0VGltZW91dChvLDFlMyl9KCl9KGhlbGxvKSxoZWxsby5hcGk9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUpe2U9ZS5yZXBsYWNlKC9cXEBcXHsoW2EtelxcX1xcLV0rKShcXHwuKj8pP1xcfS9naSxmdW5jdGlvbihlLHQsbil7dmFyIGE9bj9uLnJlcGxhY2UoL15cXHwvLFwiXCIpOlwiXCI7cmV0dXJuIHQgaW4gci5xdWVyeT8oYT1yLnF1ZXJ5W3RdLGRlbGV0ZSByLnF1ZXJ5W3RdKTpyLmRhdGEmJnQgaW4gci5kYXRhPyhhPXIuZGF0YVt0XSxkZWxldGUgci5kYXRhW3RdKTpufHxpLnJlamVjdChvKFwibWlzc2luZ19hdHRyaWJ1dGVcIixcIlRoZSBhdHRyaWJ1dGUgXCIrdCtcIiBpcyBtaXNzaW5nIGZyb20gdGhlIHJlcXVlc3RcIikpLGF9KSxlLm1hdGNoKC9eaHR0cHM/OlxcL1xcLy8pfHwoZT11LmJhc2UrZSksci51cmw9ZSxuLnJlcXVlc3QocixmdW5jdGlvbihlLHQpe2lmKCFyLmZvcm1hdFJlc3BvbnNlKXJldHVybiB2b2lkKChcIm9iamVjdFwiPT10eXBlb2YgdD90LnN0YXR1c0NvZGU+PTQwMDpcIm9iamVjdFwiPT10eXBlb2YgZSYmXCJlcnJvclwiaW4gZSk/aS5yZWplY3QoZSk6aS5mdWxmaWxsKGUpKTtpZihlPT09ITA/ZT17c3VjY2VzczohMH06ZXx8KGU9e30pLFwiZGVsZXRlXCI9PT1yLm1ldGhvZCYmKGU9IWV8fG4uaXNFbXB0eShlKT97c3VjY2VzczohMH06ZSksdS53cmFwJiYoci5wYXRoIGluIHUud3JhcHx8XCJkZWZhdWx0XCJpbiB1LndyYXApKXt2YXIgbz1yLnBhdGggaW4gdS53cmFwP3IucGF0aDpcImRlZmF1bHRcIixhPSgobmV3IERhdGUpLmdldFRpbWUoKSx1LndyYXBbb10oZSx0LHIpKTthJiYoZT1hKX1lJiZcInBhZ2luZ1wiaW4gZSYmZS5wYWdpbmcubmV4dCYmKFwiP1wiPT09ZS5wYWdpbmcubmV4dFswXT9lLnBhZ2luZy5uZXh0PXIucGF0aCtlLnBhZ2luZy5uZXh0OmUucGFnaW5nLm5leHQrPVwiI1wiK3IucGF0aCksIWV8fFwiZXJyb3JcImluIGU/aS5yZWplY3QoZSk6aS5mdWxmaWxsKGUpfSl9dmFyIHQ9dGhpcyxuPXQudXRpbHMsbz1uLmVycm9yLGk9bi5Qcm9taXNlKCkscj1uLmFyZ3Moe3BhdGg6XCJzIVwiLHF1ZXJ5Olwib1wiLG1ldGhvZDpcInNcIixkYXRhOlwib1wiLHRpbWVvdXQ6XCJpXCIsY2FsbGJhY2s6XCJmXCJ9LGFyZ3VtZW50cyk7ci5tZXRob2Q9KHIubWV0aG9kfHxcImdldFwiKS50b0xvd2VyQ2FzZSgpLHIuaGVhZGVycz1yLmhlYWRlcnN8fHt9LHIucXVlcnk9ci5xdWVyeXx8e30sXCJnZXRcIiE9PXIubWV0aG9kJiZcImRlbGV0ZVwiIT09ci5tZXRob2R8fChuLmV4dGVuZChyLnF1ZXJ5LHIuZGF0YSksci5kYXRhPXt9KTt2YXIgYT1yLmRhdGE9ci5kYXRhfHx7fTtpZihpLnRoZW4oci5jYWxsYmFjayxyLmNhbGxiYWNrKSwhci5wYXRoKXJldHVybiBpLnJlamVjdChvKFwiaW52YWxpZF9wYXRoXCIsXCJNaXNzaW5nIHRoZSBwYXRoIHBhcmFtZXRlciBmcm9tIHRoZSByZXF1ZXN0XCIpKTtyLnBhdGg9ci5wYXRoLnJlcGxhY2UoL15cXC8rLyxcIlwiKTt2YXIgcz0oci5wYXRoLnNwbGl0KC9bXFwvXFw6XS8sMil8fFtdKVswXS50b0xvd2VyQ2FzZSgpO2lmKHMgaW4gdC5zZXJ2aWNlcyl7ci5uZXR3b3JrPXM7dmFyIGw9bmV3IFJlZ0V4cChcIl5cIitzK1wiOj8vP1wiKTtyLnBhdGg9ci5wYXRoLnJlcGxhY2UobCxcIlwiKX1yLm5ldHdvcms9dC5zZXR0aW5ncy5kZWZhdWx0X3NlcnZpY2U9ci5uZXR3b3JrfHx0LnNldHRpbmdzLmRlZmF1bHRfc2VydmljZTt2YXIgdT10LnNlcnZpY2VzW3IubmV0d29ya107aWYoIXUpcmV0dXJuIGkucmVqZWN0KG8oXCJpbnZhbGlkX25ldHdvcmtcIixcIkNvdWxkIG5vdCBtYXRjaCB0aGUgc2VydmljZSByZXF1ZXN0ZWQ6IFwiK3IubmV0d29yaykpO2lmKHIubWV0aG9kIGluIHUmJnIucGF0aCBpbiB1W3IubWV0aG9kXSYmdVtyLm1ldGhvZF1bci5wYXRoXT09PSExKXJldHVybiBpLnJlamVjdChvKFwiaW52YWxpZF9wYXRoXCIsXCJUaGUgcHJvdmlkZWQgcGF0aCBpcyBub3QgYXZhaWxhYmxlIG9uIHRoZSBzZWxlY3RlZCBuZXR3b3JrXCIpKTtyLm9hdXRoX3Byb3h5fHwoci5vYXV0aF9wcm94eT10LnNldHRpbmdzLm9hdXRoX3Byb3h5KSxcInByb3h5XCJpbiByfHwoci5wcm94eT1yLm9hdXRoX3Byb3h5JiZ1Lm9hdXRoJiYxPT09cGFyc2VJbnQodS5vYXV0aC52ZXJzaW9uLDEwKSksXCJ0aW1lb3V0XCJpbiByfHwoci50aW1lb3V0PXQuc2V0dGluZ3MudGltZW91dCksXCJmb3JtYXRSZXNwb25zZVwiaW4gcnx8KHIuZm9ybWF0UmVzcG9uc2U9ITApLHIuYXV0aFJlc3BvbnNlPXQuZ2V0QXV0aFJlc3BvbnNlKHIubmV0d29yayksci5hdXRoUmVzcG9uc2UmJnIuYXV0aFJlc3BvbnNlLmFjY2Vzc190b2tlbiYmKHIucXVlcnkuYWNjZXNzX3Rva2VuPXIuYXV0aFJlc3BvbnNlLmFjY2Vzc190b2tlbik7dmFyIGMsZD1yLnBhdGg7ci5vcHRpb25zPW4uY2xvbmUoci5xdWVyeSksci5kYXRhPW4uY2xvbmUoYSk7dmFyIGY9dVt7XCJkZWxldGVcIjpcImRlbFwifVtyLm1ldGhvZF18fHIubWV0aG9kXXx8e307aWYoXCJnZXRcIj09PXIubWV0aG9kKXt2YXIgcD1kLnNwbGl0KC9bXFw/I10vKVsxXTtwJiYobi5leHRlbmQoci5xdWVyeSxuLnBhcmFtKHApKSxkPWQucmVwbGFjZSgvXFw/Lio/KCN8JCkvLFwiJDFcIikpfXJldHVybihjPWQubWF0Y2goLyMoLispLyxcIlwiKSk/KGQ9ZC5zcGxpdChcIiNcIilbMF0sci5wYXRoPWNbMV0pOmQgaW4gZj8oci5wYXRoPWQsZD1mW2RdKTpcImRlZmF1bHRcImluIGYmJihkPWZbXCJkZWZhdWx0XCJdKSxyLnJlZGlyZWN0X3VyaT10LnNldHRpbmdzLnJlZGlyZWN0X3VyaSxyLnhocj11LnhocixyLmpzb25wPXUuanNvbnAsci5mb3JtPXUuZm9ybSxcImZ1bmN0aW9uXCI9PXR5cGVvZiBkP2QocixlKTplKGQpLGkucHJveHl9LGhlbGxvLnV0aWxzLmV4dGVuZChoZWxsby51dGlscyx7cmVxdWVzdDpmdW5jdGlvbihlLHQpe2Z1bmN0aW9uIG4oZSx0KXt2YXIgbjtlLmF1dGhSZXNwb25zZSYmZS5hdXRoUmVzcG9uc2Uub2F1dGgmJjE9PT1wYXJzZUludChlLmF1dGhSZXNwb25zZS5vYXV0aC52ZXJzaW9uLDEwKSYmKG49ZS5xdWVyeS5hY2Nlc3NfdG9rZW4sZGVsZXRlIGUucXVlcnkuYWNjZXNzX3Rva2VuLGUucHJveHk9ITApLCFlLmRhdGF8fFwiZ2V0XCIhPT1lLm1ldGhvZCYmXCJkZWxldGVcIiE9PWUubWV0aG9kfHwoby5leHRlbmQoZS5xdWVyeSxlLmRhdGEpLGUuZGF0YT1udWxsKTt2YXIgaT1vLnFzKGUudXJsLGUucXVlcnkpO2UucHJveHkmJihpPW8ucXMoZS5vYXV0aF9wcm94eSx7cGF0aDppLGFjY2Vzc190b2tlbjpufHxcIlwiLHRoZW46ZS5wcm94eV9yZXNwb25zZV90eXBlfHwoXCJnZXRcIj09PWUubWV0aG9kLnRvTG93ZXJDYXNlKCk/XCJyZWRpcmVjdFwiOlwicHJveHlcIiksbWV0aG9kOmUubWV0aG9kLnRvTG93ZXJDYXNlKCksc3VwcHJlc3NfcmVzcG9uc2VfY29kZXM6ITB9KSksdChpKX12YXIgbz10aGlzLGk9by5lcnJvcjtvLmlzRW1wdHkoZS5kYXRhKXx8XCJGaWxlTGlzdFwiaW4gd2luZG93fHwhby5oYXNCaW5hcnkoZS5kYXRhKXx8KGUueGhyPSExLGUuanNvbnA9ITEpO3ZhciByPXRoaXMucmVxdWVzdF9jb3JzKGZ1bmN0aW9uKCl7cmV0dXJuIHZvaWQgMD09PWUueGhyfHxlLnhociYmKFwiZnVuY3Rpb25cIiE9dHlwZW9mIGUueGhyfHxlLnhocihlLGUucXVlcnkpKX0pO2lmKHIpcmV0dXJuIHZvaWQgbihlLGZ1bmN0aW9uKG4pe3ZhciBpPW8ueGhyKGUubWV0aG9kLG4sZS5oZWFkZXJzLGUuZGF0YSx0KTtpLm9ucHJvZ3Jlc3M9ZS5vbnByb2dyZXNzfHxudWxsLGkudXBsb2FkJiZlLm9udXBsb2FkcHJvZ3Jlc3MmJihpLnVwbG9hZC5vbnByb2dyZXNzPWUub251cGxvYWRwcm9ncmVzcyl9KTt2YXIgYT1lLnF1ZXJ5O2lmKGUucXVlcnk9by5jbG9uZShlLnF1ZXJ5KSxlLmNhbGxiYWNrSUQ9by5nbG9iYWxFdmVudCgpLGUuanNvbnAhPT0hMSl7aWYoZS5xdWVyeS5jYWxsYmFjaz1lLmNhbGxiYWNrSUQsXCJmdW5jdGlvblwiPT10eXBlb2YgZS5qc29ucCYmZS5qc29ucChlLGUucXVlcnkpLFwiZ2V0XCI9PT1lLm1ldGhvZClyZXR1cm4gdm9pZCBuKGUsZnVuY3Rpb24obil7by5qc29ucChuLHQsZS5jYWxsYmFja0lELGUudGltZW91dCl9KTtlLnF1ZXJ5PWF9aWYoZS5mb3JtIT09ITEpe2UucXVlcnkucmVkaXJlY3RfdXJpPWUucmVkaXJlY3RfdXJpLGUucXVlcnkuc3RhdGU9SlNPTi5zdHJpbmdpZnkoe2NhbGxiYWNrOmUuY2FsbGJhY2tJRH0pO3ZhciBzO2lmKFwiZnVuY3Rpb25cIj09dHlwZW9mIGUuZm9ybSYmKHM9ZS5mb3JtKGUsZS5xdWVyeSkpLFwicG9zdFwiPT09ZS5tZXRob2QmJnMhPT0hMSlyZXR1cm4gdm9pZCBuKGUsZnVuY3Rpb24obil7by5wb3N0KG4sZS5kYXRhLHMsdCxlLmNhbGxiYWNrSUQsZS50aW1lb3V0KX0pfXQoaShcImludmFsaWRfcmVxdWVzdFwiLFwiVGhlcmUgd2FzIG5vIG1lY2hhbmlzbSBmb3IgaGFuZGxpbmcgdGhpcyByZXF1ZXN0XCIpKX0scmVxdWVzdF9jb3JzOmZ1bmN0aW9uKGUpe3JldHVyblwid2l0aENyZWRlbnRpYWxzXCJpbiBuZXcgWE1MSHR0cFJlcXVlc3QmJmUoKX0sZG9tSW5zdGFuY2U6ZnVuY3Rpb24oZSx0KXt2YXIgbj1cIkhUTUxcIisoZXx8XCJcIikucmVwbGFjZSgvXlthLXpdLyxmdW5jdGlvbihlKXtyZXR1cm4gZS50b1VwcGVyQ2FzZSgpfSkrXCJFbGVtZW50XCI7cmV0dXJuIHQ/d2luZG93W25dP3QgaW5zdGFuY2VvZiB3aW5kb3dbbl06d2luZG93LkVsZW1lbnQ/dCBpbnN0YW5jZW9mIHdpbmRvdy5FbGVtZW50JiYoIWV8fHQudGFnTmFtZSYmdC50YWdOYW1lLnRvTG93ZXJDYXNlKCk9PT1lKTohKHQgaW5zdGFuY2VvZiBPYmplY3R8fHQgaW5zdGFuY2VvZiBBcnJheXx8dCBpbnN0YW5jZW9mIFN0cmluZ3x8dCBpbnN0YW5jZW9mIE51bWJlcikmJnQudGFnTmFtZSYmdC50YWdOYW1lLnRvTG93ZXJDYXNlKCk9PT1lOiExfSxjbG9uZTpmdW5jdGlvbihlKXtpZihudWxsPT09ZXx8XCJvYmplY3RcIiE9dHlwZW9mIGV8fGUgaW5zdGFuY2VvZiBEYXRlfHxcIm5vZGVOYW1lXCJpbiBlfHx0aGlzLmlzQmluYXJ5KGUpfHxcImZ1bmN0aW9uXCI9PXR5cGVvZiBGb3JtRGF0YSYmZSBpbnN0YW5jZW9mIEZvcm1EYXRhKXJldHVybiBlO2lmKEFycmF5LmlzQXJyYXkoZSkpcmV0dXJuIGUubWFwKHRoaXMuY2xvbmUuYmluZCh0aGlzKSk7dmFyIHQ9e307Zm9yKHZhciBuIGluIGUpdFtuXT10aGlzLmNsb25lKGVbbl0pO3JldHVybiB0fSx4aHI6ZnVuY3Rpb24oZSx0LG4sbyxpKXtmdW5jdGlvbiByKGUpe2Zvcih2YXIgdCxuPXt9LG89LyhbYS16XFwtXSspOlxccz8oLiopOz8vZ2k7dD1vLmV4ZWMoZSk7KW5bdFsxXV09dFsyXTtyZXR1cm4gbn12YXIgYT1uZXcgWE1MSHR0cFJlcXVlc3Qscz10aGlzLmVycm9yLGw9ITE7XCJibG9iXCI9PT1lJiYobD1lLGU9XCJHRVRcIiksZT1lLnRvVXBwZXJDYXNlKCksYS5vbmxvYWQ9ZnVuY3Rpb24odCl7dmFyIG49YS5yZXNwb25zZTt0cnl7bj1KU09OLnBhcnNlKGEucmVzcG9uc2VUZXh0KX1jYXRjaChvKXs0MDE9PT1hLnN0YXR1cyYmKG49cyhcImFjY2Vzc19kZW5pZWRcIixhLnN0YXR1c1RleHQpKX12YXIgbD1yKGEuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkpO2wuc3RhdHVzQ29kZT1hLnN0YXR1cyxpKG58fChcIkdFVFwiPT09ZT9zKFwiZW1wdHlfcmVzcG9uc2VcIixcIkNvdWxkIG5vdCBnZXQgcmVzb3VyY2VcIik6e30pLGwpfSxhLm9uZXJyb3I9ZnVuY3Rpb24oZSl7dmFyIHQ9YS5yZXNwb25zZVRleHQ7dHJ5e3Q9SlNPTi5wYXJzZShhLnJlc3BvbnNlVGV4dCl9Y2F0Y2gobil7fWkodHx8cyhcImFjY2Vzc19kZW5pZWRcIixcIkNvdWxkIG5vdCBnZXQgcmVzb3VyY2VcIikpfTt2YXIgdTtpZihcIkdFVFwiPT09ZXx8XCJERUxFVEVcIj09PWUpbz1udWxsO2Vsc2UgaWYobyYmXCJzdHJpbmdcIiE9dHlwZW9mIG8mJiEobyBpbnN0YW5jZW9mIEZvcm1EYXRhKSYmIShvIGluc3RhbmNlb2YgRmlsZSkmJiEobyBpbnN0YW5jZW9mIEJsb2IpKXt2YXIgYz1uZXcgRm9ybURhdGE7Zm9yKHUgaW4gbylvLmhhc093blByb3BlcnR5KHUpJiYob1t1XWluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudD9cImZpbGVzXCJpbiBvW3VdJiZvW3VdLmZpbGVzLmxlbmd0aD4wJiZjLmFwcGVuZCh1LG9bdV0uZmlsZXNbMF0pOm9bdV1pbnN0YW5jZW9mIEJsb2I/Yy5hcHBlbmQodSxvW3VdLG8ubmFtZSk6Yy5hcHBlbmQodSxvW3VdKSk7bz1jfWlmKGEub3BlbihlLHQsITApLGwmJihcInJlc3BvbnNlVHlwZVwiaW4gYT9hLnJlc3BvbnNlVHlwZT1sOmEub3ZlcnJpZGVNaW1lVHlwZShcInRleHQvcGxhaW47IGNoYXJzZXQ9eC11c2VyLWRlZmluZWRcIikpLG4pZm9yKHUgaW4gbilhLnNldFJlcXVlc3RIZWFkZXIodSxuW3VdKTtyZXR1cm4gYS5zZW5kKG8pLGF9LGpzb25wOmZ1bmN0aW9uKGUsdCxuLG8pe3ZhciBpLHI9dGhpcyxhPXIuZXJyb3Iscz0wLGw9ZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJoZWFkXCIpWzBdLHU9YShcInNlcnZlcl9lcnJvclwiLFwic2VydmVyX2Vycm9yXCIpLGM9ZnVuY3Rpb24oKXtzKyt8fHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dCh1KSxsLnJlbW92ZUNoaWxkKGQpfSwwKX07bj1yLmdsb2JhbEV2ZW50KGZ1bmN0aW9uKGUpe3JldHVybiB1PWUsITB9LG4pLGU9ZS5yZXBsYWNlKG5ldyBSZWdFeHAoXCI9XFxcXD8oJnwkKVwiKSxcIj1cIituK1wiJDFcIik7dmFyIGQ9ci5hcHBlbmQoXCJzY3JpcHRcIix7aWQ6bixuYW1lOm4sc3JjOmUsYXN5bmM6ITAsb25sb2FkOmMsb25lcnJvcjpjLG9ucmVhZHlzdGF0ZWNoYW5nZTpmdW5jdGlvbigpey9sb2FkZWR8Y29tcGxldGUvaS50ZXN0KHRoaXMucmVhZHlTdGF0ZSkmJmMoKX19KTt3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLmluZGV4T2YoXCJvcGVyYVwiKT4tMSYmKGk9ci5hcHBlbmQoXCJzY3JpcHRcIix7dGV4dDpcImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdcIituK1wiJykub25lcnJvcigpO1wifSksZC5hc3luYz0hMSksbyYmd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKXt1PWEoXCJ0aW1lb3V0XCIsXCJ0aW1lb3V0XCIpLGMoKX0sbyksbC5hcHBlbmRDaGlsZChkKSxpJiZsLmFwcGVuZENoaWxkKGkpfSxwb3N0OmZ1bmN0aW9uKGUsdCxuLG8saSxyKXt2YXIgYSxzPXRoaXMsbD1zLmVycm9yLHU9ZG9jdW1lbnQsYz1udWxsLGQ9W10sZj0wLHA9bnVsbCxtPTAsaD1mdW5jdGlvbihlKXttKyt8fG8oZSl9O3MuZ2xvYmFsRXZlbnQoaCxpKTt2YXIgZzt0cnl7Zz11LmNyZWF0ZUVsZW1lbnQoJzxpZnJhbWUgbmFtZT1cIicraSsnXCI+Jyl9Y2F0Y2godil7Zz11LmNyZWF0ZUVsZW1lbnQoXCJpZnJhbWVcIil9aWYoZy5uYW1lPWksZy5pZD1pLGcuc3R5bGUuZGlzcGxheT1cIm5vbmVcIixuJiZuLmNhbGxiYWNrb25sb2FkJiYoZy5vbmxvYWQ9ZnVuY3Rpb24oKXtoKHtyZXNwb25zZTpcInBvc3RlZFwiLG1lc3NhZ2U6XCJDb250ZW50IHdhcyBwb3N0ZWRcIn0pfSksciYmc2V0VGltZW91dChmdW5jdGlvbigpe2gobChcInRpbWVvdXRcIixcIlRoZSBwb3N0IG9wZXJhdGlvbiB0aW1lZCBvdXRcIikpfSxyKSx1LmJvZHkuYXBwZW5kQ2hpbGQoZykscy5kb21JbnN0YW5jZShcImZvcm1cIix0KSl7Zm9yKGM9dC5mb3JtLGY9MDtmPGMuZWxlbWVudHMubGVuZ3RoO2YrKyljLmVsZW1lbnRzW2ZdIT09dCYmYy5lbGVtZW50c1tmXS5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCEwKTt0PWN9aWYocy5kb21JbnN0YW5jZShcImZvcm1cIix0KSlmb3IoYz10LGY9MDtmPGMuZWxlbWVudHMubGVuZ3RoO2YrKyljLmVsZW1lbnRzW2ZdLmRpc2FibGVkfHxcImZpbGVcIiE9PWMuZWxlbWVudHNbZl0udHlwZXx8KGMuZW5jb2Rpbmc9Yy5lbmN0eXBlPVwibXVsdGlwYXJ0L2Zvcm0tZGF0YVwiLGMuZWxlbWVudHNbZl0uc2V0QXR0cmlidXRlKFwibmFtZVwiLFwiZmlsZVwiKSk7ZWxzZXtmb3IocCBpbiB0KXQuaGFzT3duUHJvcGVydHkocCkmJnMuZG9tSW5zdGFuY2UoXCJpbnB1dFwiLHRbcF0pJiZcImZpbGVcIj09PXRbcF0udHlwZSYmKGM9dFtwXS5mb3JtLGMuZW5jb2Rpbmc9Yy5lbmN0eXBlPVwibXVsdGlwYXJ0L2Zvcm0tZGF0YVwiKTtjfHwoYz11LmNyZWF0ZUVsZW1lbnQoXCJmb3JtXCIpLHUuYm9keS5hcHBlbmRDaGlsZChjKSxhPWMpO3ZhciB5O2ZvcihwIGluIHQpaWYodC5oYXNPd25Qcm9wZXJ0eShwKSl7dmFyIHc9cy5kb21JbnN0YW5jZShcImlucHV0XCIsdFtwXSl8fHMuZG9tSW5zdGFuY2UoXCJ0ZXh0QXJlYVwiLHRbcF0pfHxzLmRvbUluc3RhbmNlKFwic2VsZWN0XCIsdFtwXSk7aWYodyYmdFtwXS5mb3JtPT09Yyl3JiZ0W3BdLm5hbWUhPT1wJiYodFtwXS5zZXRBdHRyaWJ1dGUoXCJuYW1lXCIscCksdFtwXS5uYW1lPXApO2Vsc2V7dmFyIF89Yy5lbGVtZW50c1twXTtpZih5KWZvcihfIGluc3RhbmNlb2YgTm9kZUxpc3R8fChfPVtfXSksZj0wO2Y8Xy5sZW5ndGg7ZisrKV9bZl0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChfW2ZdKTt5PXUuY3JlYXRlRWxlbWVudChcImlucHV0XCIpLHkuc2V0QXR0cmlidXRlKFwidHlwZVwiLFwiaGlkZGVuXCIpLHkuc2V0QXR0cmlidXRlKFwibmFtZVwiLHApLHc/eS52YWx1ZT10W3BdLnZhbHVlOnMuZG9tSW5zdGFuY2UobnVsbCx0W3BdKT95LnZhbHVlPXRbcF0uaW5uZXJIVE1MfHx0W3BdLmlubmVyVGV4dDp5LnZhbHVlPXRbcF0sYy5hcHBlbmRDaGlsZCh5KX19Zm9yKGY9MDtmPGMuZWxlbWVudHMubGVuZ3RoO2YrKyl5PWMuZWxlbWVudHNbZl0seS5uYW1lIGluIHR8fHkuZ2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIik9PT0hMHx8KHkuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwhMCksZC5wdXNoKHkpKX1jLnNldEF0dHJpYnV0ZShcIm1ldGhvZFwiLFwiUE9TVFwiKSxjLnNldEF0dHJpYnV0ZShcInRhcmdldFwiLGkpLGMudGFyZ2V0PWksYy5zZXRBdHRyaWJ1dGUoXCJhY3Rpb25cIixlKSxzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7Yy5zdWJtaXQoKSxzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dHJ5e2EmJmEucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChhKX1jYXRjaChlKXt0cnl7Y29uc29sZS5lcnJvcihcIkhlbGxvSlM6IGNvdWxkIG5vdCByZW1vdmUgaWZyYW1lXCIpfWNhdGNoKHQpe319Zm9yKHZhciBuPTA7bjxkLmxlbmd0aDtuKyspZFtuXSYmKGRbbl0uc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwhMSksZFtuXS5kaXNhYmxlZD0hMSl9LDApfSwxMDApfSxoYXNCaW5hcnk6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0IGluIGUpaWYoZS5oYXNPd25Qcm9wZXJ0eSh0KSYmdGhpcy5pc0JpbmFyeShlW3RdKSlyZXR1cm4hMDtyZXR1cm4hMX0saXNCaW5hcnk6ZnVuY3Rpb24oZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBPYmplY3QmJih0aGlzLmRvbUluc3RhbmNlKFwiaW5wdXRcIixlKSYmXCJmaWxlXCI9PT1lLnR5cGV8fFwiRmlsZUxpc3RcImluIHdpbmRvdyYmZSBpbnN0YW5jZW9mIHdpbmRvdy5GaWxlTGlzdHx8XCJGaWxlXCJpbiB3aW5kb3cmJmUgaW5zdGFuY2VvZiB3aW5kb3cuRmlsZXx8XCJCbG9iXCJpbiB3aW5kb3cmJmUgaW5zdGFuY2VvZiB3aW5kb3cuQmxvYil9LHRvQmxvYjpmdW5jdGlvbihlKXt2YXIgdD0vXmRhdGFcXDooW147LF0rKFxcO2NoYXJzZXQ9W147LF0rKT8pKFxcO2Jhc2U2NCk/LC9pLG49ZS5tYXRjaCh0KTtpZighbilyZXR1cm4gZTtmb3IodmFyIG89YXRvYihlLnJlcGxhY2UodCxcIlwiKSksaT1bXSxyPTA7cjxvLmxlbmd0aDtyKyspaS5wdXNoKG8uY2hhckNvZGVBdChyKSk7cmV0dXJuIG5ldyBCbG9iKFtuZXcgVWludDhBcnJheShpKV0se3R5cGU6blsxXX0pfX0pLGZ1bmN0aW9uKGUpe3ZhciB0PWUuYXBpLG49ZS51dGlscztuLmV4dGVuZChuLHtkYXRhVG9KU09OOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj13aW5kb3csbz1lLmRhdGE7aWYodC5kb21JbnN0YW5jZShcImZvcm1cIixvKT9vPXQubm9kZUxpc3RUb0pTT04oby5lbGVtZW50cyk6XCJOb2RlTGlzdFwiaW4gbiYmbyBpbnN0YW5jZW9mIE5vZGVMaXN0P289dC5ub2RlTGlzdFRvSlNPTihvKTp0LmRvbUluc3RhbmNlKFwiaW5wdXRcIixvKSYmKG89dC5ub2RlTGlzdFRvSlNPTihbb10pKSwoXCJGaWxlXCJpbiBuJiZvIGluc3RhbmNlb2Ygbi5GaWxlfHxcIkJsb2JcImluIG4mJm8gaW5zdGFuY2VvZiBuLkJsb2J8fFwiRmlsZUxpc3RcImluIG4mJm8gaW5zdGFuY2VvZiBuLkZpbGVMaXN0KSYmKG89e2ZpbGU6b30pLCEoXCJGb3JtRGF0YVwiaW4gbiYmbyBpbnN0YW5jZW9mIG4uRm9ybURhdGEpKWZvcih2YXIgaSBpbiBvKWlmKG8uaGFzT3duUHJvcGVydHkoaSkpaWYoXCJGaWxlTGlzdFwiaW4gbiYmb1tpXWluc3RhbmNlb2Ygbi5GaWxlTGlzdCkxPT09b1tpXS5sZW5ndGgmJihvW2ldPW9baV1bMF0pO2Vsc2V7aWYodC5kb21JbnN0YW5jZShcImlucHV0XCIsb1tpXSkmJlwiZmlsZVwiPT09b1tpXS50eXBlKWNvbnRpbnVlO3QuZG9tSW5zdGFuY2UoXCJpbnB1dFwiLG9baV0pfHx0LmRvbUluc3RhbmNlKFwic2VsZWN0XCIsb1tpXSl8fHQuZG9tSW5zdGFuY2UoXCJ0ZXh0QXJlYVwiLG9baV0pP29baV09b1tpXS52YWx1ZTp0LmRvbUluc3RhbmNlKG51bGwsb1tpXSkmJihvW2ldPW9baV0uaW5uZXJIVE1MfHxvW2ldLmlubmVyVGV4dCl9cmV0dXJuIGUuZGF0YT1vLG99LG5vZGVMaXN0VG9KU09OOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD17fSxuPTA7bjxlLmxlbmd0aDtuKyspe3ZhciBvPWVbbl07IW8uZGlzYWJsZWQmJm8ubmFtZSYmKFwiZmlsZVwiPT09by50eXBlP3Rbby5uYW1lXT1vOnRbby5uYW1lXT1vLnZhbHVlfHxvLmlubmVySFRNTCl9cmV0dXJuIHR9fSksZS5hcGk9ZnVuY3Rpb24oKXt2YXIgZT1uLmFyZ3Moe3BhdGg6XCJzIVwiLG1ldGhvZDpcInNcIixkYXRhOlwib1wiLHRpbWVvdXQ6XCJpXCIsY2FsbGJhY2s6XCJmXCJ9LGFyZ3VtZW50cyk7cmV0dXJuIGUuZGF0YSYmbi5kYXRhVG9KU09OKGUpLHQuY2FsbCh0aGlzLGUpfX0oaGVsbG8pLGhlbGxvLnV0aWxzLnJlc3BvbnNlSGFuZGxlcih3aW5kb3csd2luZG93Lm9wZW5lcnx8d2luZG93LnBhcmVudCksXCJvYmplY3RcIj09dHlwZW9mIGNocm9tZSYmXCJvYmplY3RcIj09dHlwZW9mIGNocm9tZS5pZGVudGl0eSYmY2hyb21lLmlkZW50aXR5LmxhdW5jaFdlYkF1dGhGbG93JiYhZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQsbil7dmFyIG89e2Nsb3NlZDohMX07cmV0dXJuIGNocm9tZS5pZGVudGl0eS5sYXVuY2hXZWJBdXRoRmxvdyh7dXJsOnQsaW50ZXJhY3RpdmU6bn0sZnVuY3Rpb24odCl7aWYodm9pZCAwPT09dClyZXR1cm4gdm9pZChvLmNsb3NlZD0hMCk7dmFyIG49aGVsbG8udXRpbHMudXJsKHQpLGk9e2xvY2F0aW9uOnthc3NpZ246ZnVuY3Rpb24odCl7ZSh0LCExKX0sc2VhcmNoOm4uc2VhcmNoLGhhc2g6bi5oYXNoLGhyZWY6bi5ocmVmfSxjbG9zZTpmdW5jdGlvbigpe319O2hlbGxvLnV0aWxzLnJlc3BvbnNlSGFuZGxlcihpLHdpbmRvdyl9KSxvfWhlbGxvLnV0aWxzLnBvcHVwPWZ1bmN0aW9uKHQpe3JldHVybiBlKHQsITApfSxoZWxsby51dGlscy5pZnJhbWU9ZnVuY3Rpb24odCl7ZSh0LCExKX0saGVsbG8udXRpbHMucmVxdWVzdF9jb3JzPWZ1bmN0aW9uKGUpe3JldHVybiBlKCksITB9O3ZhciB0PXt9O2Nocm9tZS5zdG9yYWdlLmxvY2FsLmdldChcImhlbGxvXCIsZnVuY3Rpb24oZSl7dD1lLmhlbGxvfHx7fX0pLGhlbGxvLnV0aWxzLnN0b3JlPWZ1bmN0aW9uKGUsbil7cmV0dXJuIDA9PT1hcmd1bWVudHMubGVuZ3RoP3Q6MT09PWFyZ3VtZW50cy5sZW5ndGg/dFtlXXx8bnVsbDpuPyh0W2VdPW4sY2hyb21lLnN0b3JhZ2UubG9jYWwuc2V0KHtoZWxsbzp0fSksbik6bnVsbD09PW4/KGRlbGV0ZSB0W2VdLGNocm9tZS5zdG9yYWdlLmxvY2FsLnNldCh7aGVsbG86dH0pLG51bGwpOnZvaWQgMH19KCksZnVuY3Rpb24oKXtpZigvXmZpbGU6XFwvezN9W15cXC9dLy50ZXN0KHdpbmRvdy5sb2NhdGlvbi5ocmVmKSYmd2luZG93LmNvcmRvdmEpe2hlbGxvLnV0aWxzLmlmcmFtZT1mdW5jdGlvbihlLHQpe2hlbGxvLnV0aWxzLnBvcHVwKGUsdCx7aGlkZGVuOlwieWVzXCJ9KX07dmFyIGU9aGVsbG8udXRpbHMucG9wdXA7aGVsbG8udXRpbHMucG9wdXA9ZnVuY3Rpb24odCxuLG8pe3ZhciBpPWUuY2FsbCh0aGlzLHQsbixvKTt0cnl7aWYoaSYmaS5hZGRFdmVudExpc3RlbmVyKXt2YXIgcj1oZWxsby51dGlscy51cmwobiksYT1yLm9yaWdpbnx8ci5wcm90b2NvbCtcIi8vXCIrci5ob3N0bmFtZTtpLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2Fkc3RhcnRcIixmdW5jdGlvbihlKXt2YXIgdD1lLnVybDtpZigwPT09dC5pbmRleE9mKGEpKXt2YXIgbj1oZWxsby51dGlscy51cmwodCksbz17bG9jYXRpb246e2Fzc2lnbjpmdW5jdGlvbihlKXtpLmV4ZWN1dGVTY3JpcHQoe2NvZGU6J3dpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCInK2UrJztcIid9KX0sc2VhcmNoOm4uc2VhcmNoLGhhc2g6bi5oYXNoLGhyZWY6bi5ocmVmfSxjbG9zZTpmdW5jdGlvbigpe2lmKGkuY2xvc2Upe2kuY2xvc2UoKTt0cnl7aS5jbG9zZWQ9ITB9Y2F0Y2goZSl7fX19fTtoZWxsby51dGlscy5yZXNwb25zZUhhbmRsZXIobyx3aW5kb3cpfX0pfX1jYXRjaChzKXt9cmV0dXJuIGl9fX0oKSxmdW5jdGlvbihlKXtmdW5jdGlvbiB0KGUpe2UmJlwiZXJyb3JcImluIGUmJihlLmVycm9yPXtjb2RlOlwic2VydmVyX2Vycm9yXCIsbWVzc2FnZTplLmVycm9yLm1lc3NhZ2V8fGUuZXJyb3J9KX1mdW5jdGlvbiBuKHQsbixvKXtpZighKFwib2JqZWN0XCIhPXR5cGVvZiB0fHxcInVuZGVmaW5lZFwiIT10eXBlb2YgQmxvYiYmdCBpbnN0YW5jZW9mIEJsb2J8fFwidW5kZWZpbmVkXCIhPXR5cGVvZiBBcnJheUJ1ZmZlciYmdCBpbnN0YW5jZW9mIEFycmF5QnVmZmVyfHxcImVycm9yXCJpbiB0KSl7dmFyIGk9KFwiYXBwX2ZvbGRlclwiIT09dC5yb290P3Qucm9vdDpcIlwiKSt0LnBhdGgucmVwbGFjZSgvXFwmL2csXCIlMjZcIik7aT1pLnJlcGxhY2UoL15cXC8vLFwiXCIpLHQudGh1bWJfZXhpc3RzJiYodC50aHVtYm5haWw9by5vYXV0aF9wcm94eStcIj9wYXRoPVwiK2VuY29kZVVSSUNvbXBvbmVudChcImh0dHBzOi8vYXBpLWNvbnRlbnQuZHJvcGJveC5jb20vMS90aHVtYm5haWxzL2F1dG8vXCIraStcIj9mb3JtYXQ9anBlZyZzaXplPW1cIikrXCImYWNjZXNzX3Rva2VuPVwiK28ub3B0aW9ucy5hY2Nlc3NfdG9rZW4pLHQudHlwZT10LmlzX2Rpcj9cImZvbGRlclwiOnQubWltZV90eXBlLHQubmFtZT10LnBhdGgucmVwbGFjZSgvLipcXC8vZyxcIlwiKSx0LmlzX2Rpcj90LmZpbGVzPWkucmVwbGFjZSgvXlxcLy8sXCJcIik6KHQuZG93bmxvYWRMaW5rPWUuc2V0dGluZ3Mub2F1dGhfcHJveHkrXCI/cGF0aD1cIitlbmNvZGVVUklDb21wb25lbnQoXCJodHRwczovL2FwaS1jb250ZW50LmRyb3Bib3guY29tLzEvZmlsZXMvYXV0by9cIitpKStcIiZhY2Nlc3NfdG9rZW49XCIrby5vcHRpb25zLmFjY2Vzc190b2tlbix0LmZpbGU9XCJodHRwczovL2FwaS1jb250ZW50LmRyb3Bib3guY29tLzEvZmlsZXMvYXV0by9cIitpKSx0LmlkfHwodC5pZD10LnBhdGgucmVwbGFjZSgvXlxcLy8sXCJcIikpfX1mdW5jdGlvbiBvKGUpe3JldHVybiBmdW5jdGlvbih0LG4pe2RlbGV0ZSB0LnF1ZXJ5LmxpbWl0LG4oZSl9fXZhciBpPXt2ZXJzaW9uOlwiMS4wXCIsYXV0aDpcImh0dHBzOi8vd3d3LmRyb3Bib3guY29tLzEvb2F1dGgvYXV0aG9yaXplXCIscmVxdWVzdDpcImh0dHBzOi8vYXBpLmRyb3Bib3guY29tLzEvb2F1dGgvcmVxdWVzdF90b2tlblwiLHRva2VuOlwiaHR0cHM6Ly9hcGkuZHJvcGJveC5jb20vMS9vYXV0aC9hY2Nlc3NfdG9rZW5cIn0scj17dmVyc2lvbjoyLGF1dGg6XCJodHRwczovL3d3dy5kcm9wYm94LmNvbS8xL29hdXRoMi9hdXRob3JpemVcIixncmFudDpcImh0dHBzOi8vYXBpLmRyb3Bib3guY29tLzEvb2F1dGgyL3Rva2VuXCJ9O2UuaW5pdCh7ZHJvcGJveDp7bmFtZTpcIkRyb3Bib3hcIixvYXV0aDpyLGxvZ2luOmZ1bmN0aW9uKHQpe3QucXMuc2NvcGU9XCJcIjt2YXIgbj1kZWNvZGVVUklDb21wb25lbnQodC5xcy5yZWRpcmVjdF91cmkpOzA9PT1uLmluZGV4T2YoXCJodHRwOlwiKSYmMCE9PW4uaW5kZXhPZihcImh0dHA6Ly9sb2NhbGhvc3QvXCIpP2Uuc2VydmljZXMuZHJvcGJveC5vYXV0aD1pOmUuc2VydmljZXMuZHJvcGJveC5vYXV0aD1yLHQub3B0aW9ucy5wb3B1cC53aWR0aD0xZTMsdC5vcHRpb25zLnBvcHVwLmhlaWdodD0xZTN9LGJhc2U6XCJodHRwczovL2FwaS5kcm9wYm94LmNvbS8xL1wiLHJvb3Q6XCJzYW5kYm94XCIsZ2V0OnttZTpcImFjY291bnQvaW5mb1wiLFwibWUvZmlsZXNcIjpvKFwibWV0YWRhdGEvYXV0by9Ae3BhcmVudHx9XCIpLFwibWUvZm9sZGVyXCI6byhcIm1ldGFkYXRhL2F1dG8vQHtpZH1cIiksXCJtZS9mb2xkZXJzXCI6byhcIm1ldGFkYXRhL2F1dG8vXCIpLFwiZGVmYXVsdFwiOmZ1bmN0aW9uKGUsdCl7ZS5wYXRoLm1hdGNoKFwiaHR0cHM6Ly9hcGktY29udGVudC5kcm9wYm94LmNvbS8xL2ZpbGVzL1wiKSYmKGUubWV0aG9kPVwiYmxvYlwiKSx0KGUucGF0aCl9fSxwb3N0OntcIm1lL2ZpbGVzXCI6ZnVuY3Rpb24odCxuKXt2YXIgbz10LmRhdGEucGFyZW50LGk9dC5kYXRhLm5hbWU7dC5kYXRhPXtmaWxlOnQuZGF0YS5maWxlfSxcInN0cmluZ1wiPT10eXBlb2YgdC5kYXRhLmZpbGUmJih0LmRhdGEuZmlsZT1lLnV0aWxzLnRvQmxvYih0LmRhdGEuZmlsZSkpLG4oXCJodHRwczovL2FwaS1jb250ZW50LmRyb3Bib3guY29tLzEvZmlsZXNfcHV0L2F1dG8vXCIrbytcIi9cIitpKX0sXCJtZS9mb2xkZXJzXCI6ZnVuY3Rpb24odCxuKXt2YXIgbz10LmRhdGEubmFtZTt0LmRhdGE9e30sbihcImZpbGVvcHMvY3JlYXRlX2ZvbGRlcj9yb290PUB7cm9vdHxzYW5kYm94fSZcIitlLnV0aWxzLnBhcmFtKHtwYXRoOm99KSl9fSxkZWw6e1wibWUvZmlsZXNcIjpcImZpbGVvcHMvZGVsZXRlP3Jvb3Q9QHtyb290fHNhbmRib3h9JnBhdGg9QHtpZH1cIixcIm1lL2ZvbGRlclwiOlwiZmlsZW9wcy9kZWxldGU/cm9vdD1Ae3Jvb3R8c2FuZGJveH0mcGF0aD1Ae2lkfVwifSx3cmFwOnttZTpmdW5jdGlvbihlKXtpZih0KGUpLCFlLnVpZClyZXR1cm4gZTtlLm5hbWU9ZS5kaXNwbGF5X25hbWU7dmFyIG49ZS5uYW1lLnNwbGl0KFwiIFwiKTtyZXR1cm4gZS5maXJzdF9uYW1lPW4uc2hpZnQoKSxlLmxhc3RfbmFtZT1uLmpvaW4oXCIgXCIpLGUuaWQ9ZS51aWQsZGVsZXRlIGUudWlkLGRlbGV0ZSBlLmRpc3BsYXlfbmFtZSxlfSxcImRlZmF1bHRcIjpmdW5jdGlvbihlLG8saSl7cmV0dXJuIHQoZSksZS5pc19kaXImJmUuY29udGVudHMmJihlLmRhdGE9ZS5jb250ZW50cyxkZWxldGUgZS5jb250ZW50cyxlLmRhdGEuZm9yRWFjaChmdW5jdGlvbih0KXt0LnJvb3Q9ZS5yb290LG4odCxvLGkpfSkpLG4oZSxvLGkpLGUuaXNfZGVsZXRlZCYmKGUuc3VjY2Vzcz0hMCksZX19LHhocjpmdW5jdGlvbihlKXtpZihlLmRhdGEmJmUuZGF0YS5maWxlKXt2YXIgdD1lLmRhdGEuZmlsZTt0JiYodC5maWxlcz9lLmRhdGE9dC5maWxlc1swXTplLmRhdGE9dCl9cmV0dXJuXCJkZWxldGVcIj09PWUubWV0aG9kJiYoZS5tZXRob2Q9XCJwb3N0XCIpLCEwfSxmb3JtOmZ1bmN0aW9uKGUsdCl7ZGVsZXRlIHQuc3RhdGUsZGVsZXRlIHQucmVkaXJlY3RfdXJpfX19KX0oaGVsbG8pLGZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoZSl7cmV0dXJuIGUuaWQmJihlLnRodW1ibmFpbD1lLnBpY3R1cmU9XCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS9cIitlLmlkK1wiL3BpY3R1cmVcIiksZX1mdW5jdGlvbiBuKGUpe3JldHVyblwiZGF0YVwiaW4gZSYmZS5kYXRhLmZvckVhY2godCksZX1mdW5jdGlvbiBvKGUsdCxuKXtpZihcImJvb2xlYW5cIj09dHlwZW9mIGUmJihlPXtzdWNjZXNzOmV9KSxlJiZcImRhdGFcImluIGUpe3ZhciBvPW4ucXVlcnkuYWNjZXNzX3Rva2VuO2lmKCEoZS5kYXRhIGluc3RhbmNlb2YgQXJyYXkpKXt2YXIgcj1lLmRhdGE7ZGVsZXRlIGUuZGF0YSxlLmRhdGE9W3JdfWUuZGF0YS5mb3JFYWNoKGZ1bmN0aW9uKGUpe2UucGljdHVyZSYmKGUudGh1bWJuYWlsPWUucGljdHVyZSksZS5waWN0dXJlcz0oZS5pbWFnZXN8fFtdKS5zb3J0KGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUud2lkdGgtdC53aWR0aH0pLGUuY292ZXJfcGhvdG8mJmUuY292ZXJfcGhvdG8uaWQmJihlLnRodW1ibmFpbD1pK2UuY292ZXJfcGhvdG8uaWQrXCIvcGljdHVyZT9hY2Nlc3NfdG9rZW49XCIrbyksXCJhbGJ1bVwiPT09ZS50eXBlJiYoZS5maWxlcz1lLnBob3Rvcz1pK2UuaWQrXCIvcGhvdG9zXCIpLGUuY2FuX3VwbG9hZCYmKGUudXBsb2FkX2xvY2F0aW9uPWkrZS5pZCtcIi9waG90b3NcIil9KX1yZXR1cm4gZX1lLmluaXQoe2ZhY2Vib29rOntuYW1lOlwiRmFjZWJvb2tcIixvYXV0aDp7dmVyc2lvbjoyLGF1dGg6XCJodHRwczovL3d3dy5mYWNlYm9vay5jb20vZGlhbG9nL29hdXRoL1wiLGdyYW50OlwiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vb2F1dGgvYWNjZXNzX3Rva2VuXCJcbn0sc2NvcGU6e2Jhc2ljOlwicHVibGljX3Byb2ZpbGVcIixlbWFpbDpcImVtYWlsXCIsc2hhcmU6XCJ1c2VyX3Bvc3RzXCIsYmlydGhkYXk6XCJ1c2VyX2JpcnRoZGF5XCIsZXZlbnRzOlwidXNlcl9ldmVudHNcIixwaG90b3M6XCJ1c2VyX3Bob3Rvc1wiLHZpZGVvczpcInVzZXJfdmlkZW9zXCIsZnJpZW5kczpcInVzZXJfZnJpZW5kc1wiLGZpbGVzOlwidXNlcl9waG90b3MsdXNlcl92aWRlb3NcIixwdWJsaXNoX2ZpbGVzOlwidXNlcl9waG90b3MsdXNlcl92aWRlb3MscHVibGlzaF9hY3Rpb25zXCIscHVibGlzaDpcInB1Ymxpc2hfYWN0aW9uc1wiLG9mZmxpbmVfYWNjZXNzOlwiXCJ9LHJlZnJlc2g6ITEsbG9naW46ZnVuY3Rpb24oZSl7ZS5vcHRpb25zLmZvcmNlJiYoZS5xcy5hdXRoX3R5cGU9XCJyZWF1dGhlbnRpY2F0ZVwiKSxlLnFzLmRpc3BsYXk9ZS5vcHRpb25zLmRpc3BsYXl8fFwicG9wdXBcIn0sbG9nb3V0OmZ1bmN0aW9uKHQsbil7dmFyIG89ZS51dGlscy5nbG9iYWxFdmVudCh0KSxpPWVuY29kZVVSSUNvbXBvbmVudChlLnNldHRpbmdzLnJlZGlyZWN0X3VyaStcIj9cIitlLnV0aWxzLnBhcmFtKHtjYWxsYmFjazpvLHJlc3VsdDpKU09OLnN0cmluZ2lmeSh7Zm9yY2U6ITB9KSxzdGF0ZTpcInt9XCJ9KSkscj0obi5hdXRoUmVzcG9uc2V8fHt9KS5hY2Nlc3NfdG9rZW47cmV0dXJuIGUudXRpbHMuaWZyYW1lKFwiaHR0cHM6Ly93d3cuZmFjZWJvb2suY29tL2xvZ291dC5waHA/bmV4dD1cIitpK1wiJmFjY2Vzc190b2tlbj1cIityKSxyP3ZvaWQgMDohMX0sYmFzZTpcImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL3YyLjcvXCIsZ2V0OnttZTpcIm1lP2ZpZWxkcz1lbWFpbCxmaXJzdF9uYW1lLGxhc3RfbmFtZSxuYW1lLHRpbWV6b25lLHZlcmlmaWVkXCIsXCJtZS9mcmllbmRzXCI6XCJtZS9mcmllbmRzXCIsXCJtZS9mb2xsb3dpbmdcIjpcIm1lL2ZyaWVuZHNcIixcIm1lL2ZvbGxvd2Vyc1wiOlwibWUvZnJpZW5kc1wiLFwibWUvc2hhcmVcIjpcIm1lL2ZlZWRcIixcIm1lL2xpa2VcIjpcIm1lL2xpa2VzXCIsXCJtZS9maWxlc1wiOlwibWUvYWxidW1zXCIsXCJtZS9hbGJ1bXNcIjpcIm1lL2FsYnVtcz9maWVsZHM9Y292ZXJfcGhvdG8sbmFtZVwiLFwibWUvYWxidW1cIjpcIkB7aWR9L3Bob3Rvcz9maWVsZHM9cGljdHVyZVwiLFwibWUvcGhvdG9zXCI6XCJtZS9waG90b3NcIixcIm1lL3Bob3RvXCI6XCJAe2lkfVwiLFwiZnJpZW5kL2FsYnVtc1wiOlwiQHtpZH0vYWxidW1zXCIsXCJmcmllbmQvcGhvdG9zXCI6XCJAe2lkfS9waG90b3NcIn0scG9zdDp7XCJtZS9zaGFyZVwiOlwibWUvZmVlZFwiLFwibWUvcGhvdG9cIjpcIkB7aWR9XCJ9LHdyYXA6e21lOnQsXCJtZS9mcmllbmRzXCI6bixcIm1lL2ZvbGxvd2luZ1wiOm4sXCJtZS9mb2xsb3dlcnNcIjpuLFwibWUvYWxidW1zXCI6byxcIm1lL3Bob3Rvc1wiOm8sXCJtZS9maWxlc1wiOm8sXCJkZWZhdWx0XCI6b30seGhyOmZ1bmN0aW9uKHQsbil7cmV0dXJuXCJnZXRcIiE9PXQubWV0aG9kJiZcInBvc3RcIiE9PXQubWV0aG9kfHwobi5zdXBwcmVzc19yZXNwb25zZV9jb2Rlcz0hMCksXCJwb3N0XCI9PT10Lm1ldGhvZCYmdC5kYXRhJiZcInN0cmluZ1wiPT10eXBlb2YgdC5kYXRhLmZpbGUmJih0LmRhdGEuZmlsZT1lLnV0aWxzLnRvQmxvYih0LmRhdGEuZmlsZSkpLCEwfSxqc29ucDpmdW5jdGlvbih0LG4pe3ZhciBvPXQubWV0aG9kO1wiZ2V0XCI9PT1vfHxlLnV0aWxzLmhhc0JpbmFyeSh0LmRhdGEpP1wiZGVsZXRlXCI9PT10Lm1ldGhvZCYmKG4ubWV0aG9kPVwiZGVsZXRlXCIsdC5tZXRob2Q9XCJwb3N0XCIpOih0LmRhdGEubWV0aG9kPW8sdC5tZXRob2Q9XCJnZXRcIil9LGZvcm06ZnVuY3Rpb24oZSl7cmV0dXJue2NhbGxiYWNrb25sb2FkOiEwfX19fSk7dmFyIGk9XCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS9cIn0oaGVsbG8pLGZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQodCxuLG8pe3ZhciBpPShvP1wiXCI6XCJmbGlja3I6XCIpK1wiP21ldGhvZD1cIit0K1wiJmFwaV9rZXk9XCIrZS5zZXJ2aWNlcy5mbGlja3IuaWQrXCImZm9ybWF0PWpzb25cIjtmb3IodmFyIHIgaW4gbiluLmhhc093blByb3BlcnR5KHIpJiYoaSs9XCImXCIrcitcIj1cIituW3JdKTtyZXR1cm4gaX1mdW5jdGlvbiBuKHQpe3ZhciBuPWUuZ2V0QXV0aFJlc3BvbnNlKFwiZmxpY2tyXCIpO3QobiYmbi51c2VyX25zaWQ/bi51c2VyX25zaWQ6bnVsbCl9ZnVuY3Rpb24gbyhlLG8pe3JldHVybiBvfHwobz17fSksZnVuY3Rpb24oaSxyKXtuKGZ1bmN0aW9uKG4pe28udXNlcl9pZD1uLHIodChlLG8sITApKX0pfX1mdW5jdGlvbiBpKGUsdCl7dmFyIG49XCJodHRwczovL3d3dy5mbGlja3IuY29tL2ltYWdlcy9idWRkeWljb24uZ2lmXCI7cmV0dXJuIGUubnNpZCYmZS5pY29uc2VydmVyJiZlLmljb25mYXJtJiYobj1cImh0dHBzOi8vZmFybVwiK2UuaWNvbmZhcm0rXCIuc3RhdGljZmxpY2tyLmNvbS9cIitlLmljb25zZXJ2ZXIrXCIvYnVkZHlpY29ucy9cIitlLm5zaWQrKHQ/XCJfXCIrdDpcIlwiKStcIi5qcGdcIiksbn1mdW5jdGlvbiByKGUsdCxuLG8saSl7cmV0dXJuIGk9aT9cIl9cIitpOlwiXCIsXCJodHRwczovL2Zhcm1cIit0K1wiLnN0YXRpY2ZsaWNrci5jb20vXCIrbitcIi9cIitlK1wiX1wiK28raStcIi5qcGdcIn1mdW5jdGlvbiBhKGUpe2UmJmUuc3RhdCYmXCJva1wiIT1lLnN0YXQudG9Mb3dlckNhc2UoKSYmKGUuZXJyb3I9e2NvZGU6XCJpbnZhbGlkX3JlcXVlc3RcIixtZXNzYWdlOmUubWVzc2FnZX0pfWZ1bmN0aW9uIHMoZSl7aWYoZS5waG90b3NldHx8ZS5waG90b3Mpe3ZhciB0PVwicGhvdG9zZXRcImluIGU/XCJwaG90b3NldFwiOlwicGhvdG9zXCI7ZT11KGUsdCksZChlKSxlLmRhdGE9ZS5waG90byxkZWxldGUgZS5waG90bztmb3IodmFyIG49MDtuPGUuZGF0YS5sZW5ndGg7bisrKXt2YXIgbz1lLmRhdGFbbl07by5uYW1lPW8udGl0bGUsby5waWN0dXJlPXIoby5pZCxvLmZhcm0sby5zZXJ2ZXIsby5zZWNyZXQsXCJcIiksby5waWN0dXJlcz1sKG8uaWQsby5mYXJtLG8uc2VydmVyLG8uc2VjcmV0KSxvLnNvdXJjZT1yKG8uaWQsby5mYXJtLG8uc2VydmVyLG8uc2VjcmV0LFwiYlwiKSxvLnRodW1ibmFpbD1yKG8uaWQsby5mYXJtLG8uc2VydmVyLG8uc2VjcmV0LFwibVwiKX19cmV0dXJuIGV9ZnVuY3Rpb24gbChlLHQsbixvKXt2YXIgaT0yMDQ4LGE9W3tpZDpcInRcIixtYXg6MTAwfSx7aWQ6XCJtXCIsbWF4OjI0MH0se2lkOlwiblwiLG1heDozMjB9LHtpZDpcIlwiLG1heDo1MDB9LHtpZDpcInpcIixtYXg6NjQwfSx7aWQ6XCJjXCIsbWF4OjgwMH0se2lkOlwiYlwiLG1heDoxMDI0fSx7aWQ6XCJoXCIsbWF4OjE2MDB9LHtpZDpcImtcIixtYXg6MjA0OH0se2lkOlwib1wiLG1heDppfV07cmV0dXJuIGEubWFwKGZ1bmN0aW9uKGkpe3JldHVybntzb3VyY2U6cihlLHQsbixvLGkuaWQpLHdpZHRoOmkubWF4LGhlaWdodDppLm1heH19KX1mdW5jdGlvbiB1KGUsdCl7cmV0dXJuIHQgaW4gZT9lPWVbdF06XCJlcnJvclwiaW4gZXx8KGUuZXJyb3I9e2NvZGU6XCJpbnZhbGlkX3JlcXVlc3RcIixtZXNzYWdlOmUubWVzc2FnZXx8XCJGYWlsZWQgdG8gZ2V0IGRhdGEgZnJvbSBGbGlja3JcIn0pLGV9ZnVuY3Rpb24gYyhlKXtpZihhKGUpLGUuY29udGFjdHMpe2U9dShlLFwiY29udGFjdHNcIiksZChlKSxlLmRhdGE9ZS5jb250YWN0LGRlbGV0ZSBlLmNvbnRhY3Q7Zm9yKHZhciB0PTA7dDxlLmRhdGEubGVuZ3RoO3QrKyl7dmFyIG49ZS5kYXRhW3RdO24uaWQ9bi5uc2lkLG4ubmFtZT1uLnJlYWxuYW1lfHxuLnVzZXJuYW1lLG4udGh1bWJuYWlsPWkobixcIm1cIil9fXJldHVybiBlfWZ1bmN0aW9uIGQoZSl7ZS5wYWdlJiZlLnBhZ2VzJiZlLnBhZ2UhPT1lLnBhZ2VzJiYoZS5wYWdpbmc9e25leHQ6XCI/cGFnZT1cIisgKytlLnBhZ2V9KX1lLmluaXQoe2ZsaWNrcjp7bmFtZTpcIkZsaWNrclwiLG9hdXRoOnt2ZXJzaW9uOlwiMS4wYVwiLGF1dGg6XCJodHRwczovL3d3dy5mbGlja3IuY29tL3NlcnZpY2VzL29hdXRoL2F1dGhvcml6ZT9wZXJtcz1yZWFkXCIscmVxdWVzdDpcImh0dHBzOi8vd3d3LmZsaWNrci5jb20vc2VydmljZXMvb2F1dGgvcmVxdWVzdF90b2tlblwiLHRva2VuOlwiaHR0cHM6Ly93d3cuZmxpY2tyLmNvbS9zZXJ2aWNlcy9vYXV0aC9hY2Nlc3NfdG9rZW5cIn0sYmFzZTpcImh0dHBzOi8vYXBpLmZsaWNrci5jb20vc2VydmljZXMvcmVzdFwiLGdldDp7bWU6byhcImZsaWNrci5wZW9wbGUuZ2V0SW5mb1wiKSxcIm1lL2ZyaWVuZHNcIjpvKFwiZmxpY2tyLmNvbnRhY3RzLmdldExpc3RcIix7cGVyX3BhZ2U6XCJAe2xpbWl0fDUwfVwifSksXCJtZS9mb2xsb3dpbmdcIjpvKFwiZmxpY2tyLmNvbnRhY3RzLmdldExpc3RcIix7cGVyX3BhZ2U6XCJAe2xpbWl0fDUwfVwifSksXCJtZS9mb2xsb3dlcnNcIjpvKFwiZmxpY2tyLmNvbnRhY3RzLmdldExpc3RcIix7cGVyX3BhZ2U6XCJAe2xpbWl0fDUwfVwifSksXCJtZS9hbGJ1bXNcIjpvKFwiZmxpY2tyLnBob3Rvc2V0cy5nZXRMaXN0XCIse3Blcl9wYWdlOlwiQHtsaW1pdHw1MH1cIn0pLFwibWUvYWxidW1cIjpvKFwiZmxpY2tyLnBob3Rvc2V0cy5nZXRQaG90b3NcIix7cGhvdG9zZXRfaWQ6XCJAe2lkfVwifSksXCJtZS9waG90b3NcIjpvKFwiZmxpY2tyLnBlb3BsZS5nZXRQaG90b3NcIix7cGVyX3BhZ2U6XCJAe2xpbWl0fDUwfVwifSl9LHdyYXA6e21lOmZ1bmN0aW9uKGUpe2lmKGEoZSksZT11KGUsXCJwZXJzb25cIiksZS5pZCl7aWYoZS5yZWFsbmFtZSl7ZS5uYW1lPWUucmVhbG5hbWUuX2NvbnRlbnQ7dmFyIHQ9ZS5uYW1lLnNwbGl0KFwiIFwiKTtlLmZpcnN0X25hbWU9dC5zaGlmdCgpLGUubGFzdF9uYW1lPXQuam9pbihcIiBcIil9ZS50aHVtYm5haWw9aShlLFwibFwiKSxlLnBpY3R1cmU9aShlLFwibFwiKX1yZXR1cm4gZX0sXCJtZS9mcmllbmRzXCI6YyxcIm1lL2ZvbGxvd2Vyc1wiOmMsXCJtZS9mb2xsb3dpbmdcIjpjLFwibWUvYWxidW1zXCI6ZnVuY3Rpb24oZSl7cmV0dXJuIGEoZSksZT11KGUsXCJwaG90b3NldHNcIiksZChlKSxlLnBob3Rvc2V0JiYoZS5kYXRhPWUucGhvdG9zZXQsZS5kYXRhLmZvckVhY2goZnVuY3Rpb24oZSl7ZS5uYW1lPWUudGl0bGUuX2NvbnRlbnQsZS5waG90b3M9XCJodHRwczovL2FwaS5mbGlja3IuY29tL3NlcnZpY2VzL3Jlc3RcIit0KFwiZmxpY2tyLnBob3Rvc2V0cy5nZXRQaG90b3NcIix7cGhvdG9zZXRfaWQ6ZS5pZH0sITApfSksZGVsZXRlIGUucGhvdG9zZXQpLGV9LFwibWUvcGhvdG9zXCI6ZnVuY3Rpb24oZSl7cmV0dXJuIGEoZSkscyhlKX0sXCJkZWZhdWx0XCI6ZnVuY3Rpb24oZSl7cmV0dXJuIGEoZSkscyhlKX19LHhocjohMSxqc29ucDpmdW5jdGlvbihlLHQpe1wiZ2V0XCI9PWUubWV0aG9kJiYoZGVsZXRlIHQuY2FsbGJhY2ssdC5qc29uY2FsbGJhY2s9ZS5jYWxsYmFja0lEKX19fSl9KGhlbGxvKSxmdW5jdGlvbihlKXtmdW5jdGlvbiB0KGUpeyFlLm1ldGF8fDQwMCE9PWUubWV0YS5jb2RlJiY0MDEhPT1lLm1ldGEuY29kZXx8KGUuZXJyb3I9e2NvZGU6XCJhY2Nlc3NfZGVuaWVkXCIsbWVzc2FnZTplLm1ldGEuZXJyb3JEZXRhaWx9KX1mdW5jdGlvbiBuKGUpe2UmJmUuaWQmJihlLnRodW1ibmFpbD1lLnBob3RvLnByZWZpeCtcIjEwMHgxMDBcIitlLnBob3RvLnN1ZmZpeCxlLm5hbWU9ZS5maXJzdE5hbWUrXCIgXCIrZS5sYXN0TmFtZSxlLmZpcnN0X25hbWU9ZS5maXJzdE5hbWUsZS5sYXN0X25hbWU9ZS5sYXN0TmFtZSxlLmNvbnRhY3QmJmUuY29udGFjdC5lbWFpbCYmKGUuZW1haWw9ZS5jb250YWN0LmVtYWlsKSl9ZnVuY3Rpb24gbyhlLHQpe3ZhciBuPXQuYWNjZXNzX3Rva2VuO3JldHVybiBkZWxldGUgdC5hY2Nlc3NfdG9rZW4sdC5vYXV0aF90b2tlbj1uLHQudj0yMDEyMTEyNSwhMH1lLmluaXQoe2ZvdXJzcXVhcmU6e25hbWU6XCJGb3Vyc3F1YXJlXCIsb2F1dGg6e3ZlcnNpb246MixhdXRoOlwiaHR0cHM6Ly9mb3Vyc3F1YXJlLmNvbS9vYXV0aDIvYXV0aGVudGljYXRlXCIsZ3JhbnQ6XCJodHRwczovL2ZvdXJzcXVhcmUuY29tL29hdXRoMi9hY2Nlc3NfdG9rZW5cIn0scmVmcmVzaDohMCxiYXNlOlwiaHR0cHM6Ly9hcGkuZm91cnNxdWFyZS5jb20vdjIvXCIsZ2V0OnttZTpcInVzZXJzL3NlbGZcIixcIm1lL2ZyaWVuZHNcIjpcInVzZXJzL3NlbGYvZnJpZW5kc1wiLFwibWUvZm9sbG93ZXJzXCI6XCJ1c2Vycy9zZWxmL2ZyaWVuZHNcIixcIm1lL2ZvbGxvd2luZ1wiOlwidXNlcnMvc2VsZi9mcmllbmRzXCJ9LHdyYXA6e21lOmZ1bmN0aW9uKGUpe3JldHVybiB0KGUpLGUmJmUucmVzcG9uc2UmJihlPWUucmVzcG9uc2UudXNlcixuKGUpKSxlfSxcImRlZmF1bHRcIjpmdW5jdGlvbihlKXtyZXR1cm4gdChlKSxlJiZcInJlc3BvbnNlXCJpbiBlJiZcImZyaWVuZHNcImluIGUucmVzcG9uc2UmJlwiaXRlbXNcImluIGUucmVzcG9uc2UuZnJpZW5kcyYmKGUuZGF0YT1lLnJlc3BvbnNlLmZyaWVuZHMuaXRlbXMsZS5kYXRhLmZvckVhY2gobiksZGVsZXRlIGUucmVzcG9uc2UpLGV9fSx4aHI6byxqc29ucDpvfX0pfShoZWxsbyksZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdChlLHQpe3ZhciBuPXQ/dC5zdGF0dXNDb2RlOmUmJlwibWV0YVwiaW4gZSYmXCJzdGF0dXNcImluIGUubWV0YSYmZS5tZXRhLnN0YXR1czs0MDEhPT1uJiY0MDMhPT1ufHwoZS5lcnJvcj17Y29kZTpcImFjY2Vzc19kZW5pZWRcIixtZXNzYWdlOmUubWVzc2FnZXx8KGUuZGF0YT9lLmRhdGEubWVzc2FnZTpcIkNvdWxkIG5vdCBnZXQgcmVzcG9uc2VcIil9LGRlbGV0ZSBlLm1lc3NhZ2UpfWZ1bmN0aW9uIG4oZSl7ZS5pZCYmKGUudGh1bWJuYWlsPWUucGljdHVyZT1lLmF2YXRhcl91cmwsZS5uYW1lPWUubG9naW4pfWZ1bmN0aW9uIG8oZSx0LG4pe2lmKGUuZGF0YSYmZS5kYXRhLmxlbmd0aCYmdCYmdC5MaW5rKXt2YXIgbz10LkxpbmsubWF0Y2goLzwoLio/KT47XFxzKnJlbD1cXFwibmV4dFxcXCIvKTtvJiYoZS5wYWdpbmc9e25leHQ6b1sxXX0pfX1lLmluaXQoe2dpdGh1Yjp7bmFtZTpcIkdpdEh1YlwiLG9hdXRoOnt2ZXJzaW9uOjIsYXV0aDpcImh0dHBzOi8vZ2l0aHViLmNvbS9sb2dpbi9vYXV0aC9hdXRob3JpemVcIixncmFudDpcImh0dHBzOi8vZ2l0aHViLmNvbS9sb2dpbi9vYXV0aC9hY2Nlc3NfdG9rZW5cIixyZXNwb25zZV90eXBlOlwiY29kZVwifSxzY29wZTp7ZW1haWw6XCJ1c2VyOmVtYWlsXCJ9LGJhc2U6XCJodHRwczovL2FwaS5naXRodWIuY29tL1wiLGdldDp7bWU6XCJ1c2VyXCIsXCJtZS9mcmllbmRzXCI6XCJ1c2VyL2ZvbGxvd2luZz9wZXJfcGFnZT1Ae2xpbWl0fDEwMH1cIixcIm1lL2ZvbGxvd2luZ1wiOlwidXNlci9mb2xsb3dpbmc/cGVyX3BhZ2U9QHtsaW1pdHwxMDB9XCIsXCJtZS9mb2xsb3dlcnNcIjpcInVzZXIvZm9sbG93ZXJzP3Blcl9wYWdlPUB7bGltaXR8MTAwfVwiLFwibWUvbGlrZVwiOlwidXNlci9zdGFycmVkP3Blcl9wYWdlPUB7bGltaXR8MTAwfVwifSx3cmFwOnttZTpmdW5jdGlvbihlLG8pe3JldHVybiB0KGUsbyksbihlKSxlfSxcImRlZmF1bHRcIjpmdW5jdGlvbihlLGkscil7cmV0dXJuIHQoZSxpKSxBcnJheS5pc0FycmF5KGUpJiYoZT17ZGF0YTplfSksZS5kYXRhJiYobyhlLGksciksZS5kYXRhLmZvckVhY2gobikpLGV9fSx4aHI6ZnVuY3Rpb24oZSl7cmV0dXJuXCJnZXRcIiE9PWUubWV0aG9kJiZlLmRhdGEmJihlLmhlYWRlcnM9ZS5oZWFkZXJzfHx7fSxlLmhlYWRlcnNbXCJDb250ZW50LVR5cGVcIl09XCJhcHBsaWNhdGlvbi9qc29uXCIsXCJvYmplY3RcIj09dHlwZW9mIGUuZGF0YSYmKGUuZGF0YT1KU09OLnN0cmluZ2lmeShlLmRhdGEpKSksITB9fX0pfShoZWxsbyksZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdChlKXtyZXR1cm4gcGFyc2VJbnQoZSwxMCl9ZnVuY3Rpb24gbihlKXtyZXR1cm4gYyhlKSxlLmRhdGE9ZS5pdGVtcyxkZWxldGUgZS5pdGVtcyxlfWZ1bmN0aW9uIG8oZSl7cmV0dXJuIGUuZXJyb3I/dm9pZCAwOihlLm5hbWV8fChlLm5hbWU9ZS50aXRsZXx8ZS5tZXNzYWdlKSxlLnBpY3R1cmV8fChlLnBpY3R1cmU9ZS50aHVtYm5haWxMaW5rKSxlLnRodW1ibmFpbHx8KGUudGh1bWJuYWlsPWUudGh1bWJuYWlsTGluayksXCJhcHBsaWNhdGlvbi92bmQuZ29vZ2xlLWFwcHMuZm9sZGVyXCI9PT1lLm1pbWVUeXBlJiYoZS50eXBlPVwiZm9sZGVyXCIsZS5maWxlcz1cImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2RyaXZlL3YyL2ZpbGVzP3E9JTIyXCIrZS5pZCtcIiUyMitpbitwYXJlbnRzXCIpLGUpfWZ1bmN0aW9uIGkoZSl7cmV0dXJue3NvdXJjZTplLnVybCx3aWR0aDplLndpZHRoLGhlaWdodDplLmhlaWdodH19ZnVuY3Rpb24gcihlKXtlLmRhdGE9ZS5mZWVkLmVudHJ5Lm1hcCh1KSxkZWxldGUgZS5mZWVkfWZ1bmN0aW9uIGEoZSl7aWYoYyhlKSxcImZlZWRcImluIGUmJlwiZW50cnlcImluIGUuZmVlZCllLmRhdGE9ZS5mZWVkLmVudHJ5Lm1hcCh1KSxkZWxldGUgZS5mZWVkO2Vsc2V7aWYoXCJlbnRyeVwiaW4gZSlyZXR1cm4gdShlLmVudHJ5KTtcIml0ZW1zXCJpbiBlPyhlLmRhdGE9ZS5pdGVtcy5tYXAobyksZGVsZXRlIGUuaXRlbXMpOm8oZSl9cmV0dXJuIGV9ZnVuY3Rpb24gcyhlKXtlLm5hbWU9ZS5kaXNwbGF5TmFtZXx8ZS5uYW1lLGUucGljdHVyZT1lLnBpY3R1cmV8fChlLmltYWdlP2UuaW1hZ2UudXJsOm51bGwpLGUudGh1bWJuYWlsPWUucGljdHVyZX1mdW5jdGlvbiBsKGUsdCxuKXtjKGUpO2lmKFwiZmVlZFwiaW4gZSYmXCJlbnRyeVwiaW4gZS5mZWVkKXtmb3IodmFyIG89bi5xdWVyeS5hY2Nlc3NfdG9rZW4saT0wO2k8ZS5mZWVkLmVudHJ5Lmxlbmd0aDtpKyspe3ZhciByPWUuZmVlZC5lbnRyeVtpXTtpZihyLmlkPXIuaWQuJHQsci5uYW1lPXIudGl0bGUuJHQsZGVsZXRlIHIudGl0bGUsci5nZCRlbWFpbCYmKHIuZW1haWw9ci5nZCRlbWFpbCYmci5nZCRlbWFpbC5sZW5ndGg+MD9yLmdkJGVtYWlsWzBdLmFkZHJlc3M6bnVsbCxyLmVtYWlscz1yLmdkJGVtYWlsLGRlbGV0ZSByLmdkJGVtYWlsKSxyLnVwZGF0ZWQmJihyLnVwZGF0ZWQ9ci51cGRhdGVkLiR0KSxyLmxpbmspe3ZhciBhPXIubGluay5sZW5ndGg+MD9yLmxpbmtbMF0uaHJlZjpudWxsO2EmJnIubGlua1swXS5nZCRldGFnJiYoYSs9KGEuaW5kZXhPZihcIj9cIik+LTE/XCImXCI6XCI/XCIpK1wiYWNjZXNzX3Rva2VuPVwiK28sci5waWN0dXJlPWEsci50aHVtYm5haWw9YSksZGVsZXRlIHIubGlua31yLmNhdGVnb3J5JiZkZWxldGUgci5jYXRlZ29yeX1lLmRhdGE9ZS5mZWVkLmVudHJ5LGRlbGV0ZSBlLmZlZWR9cmV0dXJuIGV9ZnVuY3Rpb24gdShlKXt2YXIgdCxuPWUubWVkaWEkZ3JvdXAsbz1uLm1lZGlhJGNvbnRlbnQubGVuZ3RoP24ubWVkaWEkY29udGVudFswXTp7fSxyPW4ubWVkaWEkY29udGVudHx8W10sYT1uLm1lZGlhJHRodW1ibmFpbHx8W10scz1yLmNvbmNhdChhKS5tYXAoaSkuc29ydChmdW5jdGlvbihlLHQpe3JldHVybiBlLndpZHRoLXQud2lkdGh9KSxsPTAsdT17aWQ6ZS5pZC4kdCxuYW1lOmUudGl0bGUuJHQsZGVzY3JpcHRpb246ZS5zdW1tYXJ5LiR0LHVwZGF0ZWRfdGltZTplLnVwZGF0ZWQuJHQsY3JlYXRlZF90aW1lOmUucHVibGlzaGVkLiR0LHBpY3R1cmU6bz9vLnVybDpudWxsLHBpY3R1cmVzOnMsaW1hZ2VzOltdLHRodW1ibmFpbDpvP28udXJsOm51bGwsd2lkdGg6by53aWR0aCxoZWlnaHQ6by5oZWlnaHR9O2lmKFwibGlua1wiaW4gZSlmb3IobD0wO2w8ZS5saW5rLmxlbmd0aDtsKyspe3ZhciBjPWUubGlua1tsXTtpZihjLnJlbC5tYXRjaCgvXFwjZmVlZCQvKSl7dS51cGxvYWRfbG9jYXRpb249dS5maWxlcz11LnBob3Rvcz1jLmhyZWY7YnJlYWt9fWlmKFwiY2F0ZWdvcnlcImluIGUmJmUuY2F0ZWdvcnkubGVuZ3RoKWZvcih0PWUuY2F0ZWdvcnksbD0wO2w8dC5sZW5ndGg7bCsrKXRbbF0uc2NoZW1lJiZ0W2xdLnNjaGVtZS5tYXRjaCgvXFwja2luZCQvKSYmKHUudHlwZT10W2xdLnRlcm0ucmVwbGFjZSgvXi4qP1xcIy8sXCJcIikpO3JldHVyblwibWVkaWEkdGh1bWJuYWlsXCJpbiBuJiZuLm1lZGlhJHRodW1ibmFpbC5sZW5ndGgmJih0PW4ubWVkaWEkdGh1bWJuYWlsLHUudGh1bWJuYWlsPXRbMF0udXJsLHUuaW1hZ2VzPXQubWFwKGkpKSx0PW4ubWVkaWEkY29udGVudCx0JiZ0Lmxlbmd0aCYmdS5pbWFnZXMucHVzaChpKHRbMF0pKSx1fWZ1bmN0aW9uIGMoZSl7aWYoXCJmZWVkXCJpbiBlJiZlLmZlZWQub3BlblNlYXJjaCRpdGVtc1BlclBhZ2Upe3ZhciBuPXQoZS5mZWVkLm9wZW5TZWFyY2gkaXRlbXNQZXJQYWdlLiR0KSxvPXQoZS5mZWVkLm9wZW5TZWFyY2gkc3RhcnRJbmRleC4kdCksaT10KGUuZmVlZC5vcGVuU2VhcmNoJHRvdGFsUmVzdWx0cy4kdCk7aT5vK24mJihlLnBhZ2luZz17bmV4dDpcIj9zdGFydD1cIisobytuKX0pfWVsc2VcIm5leHRQYWdlVG9rZW5cImluIGUmJihlLnBhZ2luZz17bmV4dDpcIj9wYWdlVG9rZW49XCIrZS5uZXh0UGFnZVRva2VufSl9ZnVuY3Rpb24gZCgpe2Z1bmN0aW9uIGUoZSl7dmFyIG49bmV3IEZpbGVSZWFkZXI7bi5vbmxvYWQ9ZnVuY3Rpb24obil7dChidG9hKG4udGFyZ2V0LnJlc3VsdCksZS50eXBlK3IrXCJDb250ZW50LVRyYW5zZmVyLUVuY29kaW5nOiBiYXNlNjRcIil9LG4ucmVhZEFzQmluYXJ5U3RyaW5nKGUpfWZ1bmN0aW9uIHQoZSx0KXtuLnB1c2gocitcIkNvbnRlbnQtVHlwZTogXCIrdCtyK3IrZSksaS0tLHMoKX12YXIgbj1bXSxvPSgxZTEwKk1hdGgucmFuZG9tKCkpLnRvU3RyaW5nKDMyKSxpPTAscj1cIlxcclxcblwiLGE9citcIi0tXCIrbyxzPWZ1bmN0aW9uKCl7fSxsPS9eZGF0YVxcOihbXjssXSsoXFw7Y2hhcnNldD1bXjssXSspPykoXFw7YmFzZTY0KT8sL2k7dGhpcy5hcHBlbmQ9ZnVuY3Rpb24obixvKXtcInN0cmluZ1wiIT10eXBlb2YgbiYmXCJsZW5ndGhcImluIE9iamVjdChuKXx8KG49W25dKTtmb3IodmFyIGE9MDthPG4ubGVuZ3RoO2ErKyl7aSsrO3ZhciBzPW5bYV07aWYoXCJ1bmRlZmluZWRcIiE9dHlwZW9mIEZpbGUmJnMgaW5zdGFuY2VvZiBGaWxlfHxcInVuZGVmaW5lZFwiIT10eXBlb2YgQmxvYiYmcyBpbnN0YW5jZW9mIEJsb2IpZShzKTtlbHNlIGlmKFwic3RyaW5nXCI9PXR5cGVvZiBzJiZzLm1hdGNoKGwpKXt2YXIgdT1zLm1hdGNoKGwpO3Qocy5yZXBsYWNlKGwsXCJcIiksdVsxXStyK1wiQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogYmFzZTY0XCIpfWVsc2UgdChzLG8pfX0sdGhpcy5vbnJlYWR5PWZ1bmN0aW9uKGUpeyhzPWZ1bmN0aW9uKCl7MD09PWkmJihuLnVuc2hpZnQoXCJcIiksbi5wdXNoKFwiLS1cIiksZShuLmpvaW4oYSksbyksbj1bXSl9KSgpfX1mdW5jdGlvbiBmKGUsdCl7dmFyIG49e307ZS5kYXRhJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgSFRNTElucHV0RWxlbWVudCYmZS5kYXRhIGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCYmKGUuZGF0YT17ZmlsZTplLmRhdGF9KSwhZS5kYXRhLm5hbWUmJk9iamVjdChPYmplY3QoZS5kYXRhLmZpbGUpLmZpbGVzKS5sZW5ndGgmJlwicG9zdFwiPT09ZS5tZXRob2QmJihlLmRhdGEubmFtZT1lLmRhdGEuZmlsZS5maWxlc1swXS5uYW1lKSxcInBvc3RcIj09PWUubWV0aG9kP2UuZGF0YT17dGl0bGU6ZS5kYXRhLm5hbWUscGFyZW50czpbe2lkOmUuZGF0YS5wYXJlbnR8fFwicm9vdFwifV0sZmlsZTplLmRhdGEuZmlsZX06KG49ZS5kYXRhLGUuZGF0YT17fSxuLnBhcmVudCYmKGUuZGF0YS5wYXJlbnRzPVt7aWQ6ZS5kYXRhLnBhcmVudHx8XCJyb290XCJ9XSksbi5maWxlJiYoZS5kYXRhLmZpbGU9bi5maWxlKSxuLm5hbWUmJihlLmRhdGEudGl0bGU9bi5uYW1lKSk7dmFyIG87aWYoXCJmaWxlXCJpbiBlLmRhdGEmJihvPWUuZGF0YS5maWxlLGRlbGV0ZSBlLmRhdGEuZmlsZSxcIm9iamVjdFwiPT10eXBlb2YgbyYmXCJmaWxlc1wiaW4gbyYmKG89by5maWxlcyksIW98fCFvLmxlbmd0aCkpcmV0dXJuIHZvaWQgdCh7ZXJyb3I6e2NvZGU6XCJyZXF1ZXN0X2ludmFsaWRcIixtZXNzYWdlOlwiVGhlcmUgd2VyZSBubyBmaWxlcyBhdHRhY2hlZCB3aXRoIHRoaXMgcmVxdWVzdCB0byB1cGxvYWRcIn19KTt2YXIgaT1uZXcgZDtpLmFwcGVuZChKU09OLnN0cmluZ2lmeShlLmRhdGEpLFwiYXBwbGljYXRpb24vanNvblwiKSxvJiZpLmFwcGVuZChvKSxpLm9ucmVhZHkoZnVuY3Rpb24obyxpKXtlLmhlYWRlcnNbXCJjb250ZW50LXR5cGVcIl09J211bHRpcGFydC9yZWxhdGVkOyBib3VuZGFyeT1cIicraSsnXCInLGUuZGF0YT1vLHQoXCJ1cGxvYWQvZHJpdmUvdjIvZmlsZXNcIisobi5pZD9cIi9cIituLmlkOlwiXCIpK1wiP3VwbG9hZFR5cGU9bXVsdGlwYXJ0XCIpfSl9ZnVuY3Rpb24gcChlKXtpZihcIm9iamVjdFwiPT10eXBlb2YgZS5kYXRhKXRyeXtlLmRhdGE9SlNPTi5zdHJpbmdpZnkoZS5kYXRhKSxlLmhlYWRlcnNbXCJjb250ZW50LXR5cGVcIl09XCJhcHBsaWNhdGlvbi9qc29uXCJ9Y2F0Y2godCl7fX12YXIgbT1cImh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vbTgvZmVlZHMvY29udGFjdHMvZGVmYXVsdC9mdWxsP3Y9My4wJmFsdD1qc29uJm1heC1yZXN1bHRzPUB7bGltaXR8MTAwMH0mc3RhcnQtaW5kZXg9QHtzdGFydHwxfVwiO2UuaW5pdCh7Z29vZ2xlOntuYW1lOlwiR29vZ2xlIFBsdXNcIixvYXV0aDp7dmVyc2lvbjoyLGF1dGg6XCJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20vby9vYXV0aDIvYXV0aFwiLGdyYW50OlwiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL28vb2F1dGgyL3Rva2VuXCJ9LHNjb3BlOntiYXNpYzpcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvcGx1cy5tZSBwcm9maWxlXCIsZW1haWw6XCJlbWFpbFwiLGJpcnRoZGF5OlwiXCIsZXZlbnRzOlwiXCIscGhvdG9zOlwiaHR0cHM6Ly9waWNhc2F3ZWIuZ29vZ2xlLmNvbS9kYXRhL1wiLHZpZGVvczpcImh0dHA6Ly9nZGF0YS55b3V0dWJlLmNvbVwiLGZyaWVuZHM6XCJodHRwczovL3d3dy5nb29nbGUuY29tL204L2ZlZWRzLCBodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL3BsdXMubG9naW5cIixmaWxlczpcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvZHJpdmUucmVhZG9ubHlcIixwdWJsaXNoOlwiXCIscHVibGlzaF9maWxlczpcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvZHJpdmVcIixzaGFyZTpcIlwiLGNyZWF0ZV9ldmVudDpcIlwiLG9mZmxpbmVfYWNjZXNzOlwiXCJ9LHNjb3BlX2RlbGltOlwiIFwiLGxvZ2luOmZ1bmN0aW9uKGUpe1wiY29kZVwiPT09ZS5xcy5yZXNwb25zZV90eXBlJiYoZS5xcy5hY2Nlc3NfdHlwZT1cIm9mZmxpbmVcIiksZS5vcHRpb25zLmZvcmNlJiYoZS5xcy5hcHByb3ZhbF9wcm9tcHQ9XCJmb3JjZVwiKX0sYmFzZTpcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL1wiLGdldDp7bWU6XCJwbHVzL3YxL3Blb3BsZS9tZVwiLFwibWUvZnJpZW5kc1wiOlwicGx1cy92MS9wZW9wbGUvbWUvcGVvcGxlL3Zpc2libGU/bWF4UmVzdWx0cz1Ae2xpbWl0fDEwMH1cIixcIm1lL2ZvbGxvd2luZ1wiOm0sXCJtZS9mb2xsb3dlcnNcIjptLFwibWUvY29udGFjdHNcIjptLFwibWUvc2hhcmVcIjpcInBsdXMvdjEvcGVvcGxlL21lL2FjdGl2aXRpZXMvcHVibGljP21heFJlc3VsdHM9QHtsaW1pdHwxMDB9XCIsXCJtZS9mZWVkXCI6XCJwbHVzL3YxL3Blb3BsZS9tZS9hY3Rpdml0aWVzL3B1YmxpYz9tYXhSZXN1bHRzPUB7bGltaXR8MTAwfVwiLFwibWUvYWxidW1zXCI6XCJodHRwczovL3BpY2FzYXdlYi5nb29nbGUuY29tL2RhdGEvZmVlZC9hcGkvdXNlci9kZWZhdWx0P2FsdD1qc29uJm1heC1yZXN1bHRzPUB7bGltaXR8MTAwfSZzdGFydC1pbmRleD1Ae3N0YXJ0fDF9XCIsXCJtZS9hbGJ1bVwiOmZ1bmN0aW9uKGUsdCl7dmFyIG49ZS5xdWVyeS5pZDtkZWxldGUgZS5xdWVyeS5pZCx0KG4ucmVwbGFjZShcIi9lbnRyeS9cIixcIi9mZWVkL1wiKSl9LFwibWUvcGhvdG9zXCI6XCJodHRwczovL3BpY2FzYXdlYi5nb29nbGUuY29tL2RhdGEvZmVlZC9hcGkvdXNlci9kZWZhdWx0P2FsdD1qc29uJmtpbmQ9cGhvdG8mbWF4LXJlc3VsdHM9QHtsaW1pdHwxMDB9JnN0YXJ0LWluZGV4PUB7c3RhcnR8MX1cIixcIm1lL2ZpbGVcIjpcImRyaXZlL3YyL2ZpbGVzL0B7aWR9XCIsXCJtZS9maWxlc1wiOlwiZHJpdmUvdjIvZmlsZXM/cT0lMjJAe3BhcmVudHxyb290fSUyMitpbitwYXJlbnRzK2FuZCt0cmFzaGVkPWZhbHNlJm1heFJlc3VsdHM9QHtsaW1pdHwxMDB9XCIsXCJtZS9mb2xkZXJzXCI6XCJkcml2ZS92Mi9maWxlcz9xPSUyMkB7aWR8cm9vdH0lMjIraW4rcGFyZW50cythbmQrbWltZVR5cGUrPSslMjJhcHBsaWNhdGlvbi92bmQuZ29vZ2xlLWFwcHMuZm9sZGVyJTIyK2FuZCt0cmFzaGVkPWZhbHNlJm1heFJlc3VsdHM9QHtsaW1pdHwxMDB9XCIsXCJtZS9mb2xkZXJcIjpcImRyaXZlL3YyL2ZpbGVzP3E9JTIyQHtpZHxyb290fSUyMitpbitwYXJlbnRzK2FuZCt0cmFzaGVkPWZhbHNlJm1heFJlc3VsdHM9QHtsaW1pdHwxMDB9XCJ9LHBvc3Q6e1wibWUvZmlsZXNcIjpmLFwibWUvZm9sZGVyc1wiOmZ1bmN0aW9uKGUsdCl7ZS5kYXRhPXt0aXRsZTplLmRhdGEubmFtZSxwYXJlbnRzOlt7aWQ6ZS5kYXRhLnBhcmVudHx8XCJyb290XCJ9XSxtaW1lVHlwZTpcImFwcGxpY2F0aW9uL3ZuZC5nb29nbGUtYXBwcy5mb2xkZXJcIn0sdChcImRyaXZlL3YyL2ZpbGVzXCIpfX0scHV0OntcIm1lL2ZpbGVzXCI6Zn0sZGVsOntcIm1lL2ZpbGVzXCI6XCJkcml2ZS92Mi9maWxlcy9Ae2lkfVwiLFwibWUvZm9sZGVyXCI6XCJkcml2ZS92Mi9maWxlcy9Ae2lkfVwifSxwYXRjaDp7XCJtZS9maWxlXCI6XCJkcml2ZS92Mi9maWxlcy9Ae2lkfVwifSx3cmFwOnttZTpmdW5jdGlvbihlKXtyZXR1cm4gZS5pZCYmKGUubGFzdF9uYW1lPWUuZmFtaWx5X25hbWV8fChlLm5hbWU/ZS5uYW1lLmZhbWlseU5hbWU6bnVsbCksZS5maXJzdF9uYW1lPWUuZ2l2ZW5fbmFtZXx8KGUubmFtZT9lLm5hbWUuZ2l2ZW5OYW1lOm51bGwpLGUuZW1haWxzJiZlLmVtYWlscy5sZW5ndGgmJihlLmVtYWlsPWUuZW1haWxzWzBdLnZhbHVlKSxzKGUpKSxlfSxcIm1lL2ZyaWVuZHNcIjpmdW5jdGlvbihlKXtyZXR1cm4gZS5pdGVtcyYmKGMoZSksZS5kYXRhPWUuaXRlbXMsZS5kYXRhLmZvckVhY2gocyksZGVsZXRlIGUuaXRlbXMpLGV9LFwibWUvY29udGFjdHNcIjpsLFwibWUvZm9sbG93ZXJzXCI6bCxcIm1lL2ZvbGxvd2luZ1wiOmwsXCJtZS9zaGFyZVwiOm4sXCJtZS9mZWVkXCI6bixcIm1lL2FsYnVtc1wiOmEsXCJtZS9waG90b3NcIjpyLFwiZGVmYXVsdFwiOmF9LHhocjpmdW5jdGlvbih0KXtyZXR1cm5cInBvc3RcIj09PXQubWV0aG9kfHxcInB1dFwiPT09dC5tZXRob2Q/cCh0KTpcInBhdGNoXCI9PT10Lm1ldGhvZCYmKGUudXRpbHMuZXh0ZW5kKHQucXVlcnksdC5kYXRhKSx0LmRhdGE9bnVsbCksITB9LGZvcm06ITF9fSl9KGhlbGxvKSxmdW5jdGlvbihlKXtmdW5jdGlvbiB0KGUpe3JldHVybntzb3VyY2U6ZS51cmwsd2lkdGg6ZS53aWR0aCxoZWlnaHQ6ZS5oZWlnaHR9fWZ1bmN0aW9uIG4oZSl7cmV0dXJuXCJzdHJpbmdcIj09dHlwZW9mIGU/e2Vycm9yOntjb2RlOlwiaW52YWxpZF9yZXF1ZXN0XCIsbWVzc2FnZTplfX06KGUmJlwibWV0YVwiaW4gZSYmXCJlcnJvcl90eXBlXCJpbiBlLm1ldGEmJihlLmVycm9yPXtjb2RlOmUubWV0YS5lcnJvcl90eXBlLG1lc3NhZ2U6ZS5tZXRhLmVycm9yX21lc3NhZ2V9KSxlKX1mdW5jdGlvbiBvKGUpe3JldHVybiByKGUpLGUmJlwiZGF0YVwiaW4gZSYmZS5kYXRhLmZvckVhY2goaSksZX1mdW5jdGlvbiBpKGUpe2UuaWQmJihlLnRodW1ibmFpbD1lLnByb2ZpbGVfcGljdHVyZSxlLm5hbWU9ZS5mdWxsX25hbWV8fGUudXNlcm5hbWUpfWZ1bmN0aW9uIHIoZSl7XCJwYWdpbmF0aW9uXCJpbiBlJiYoZS5wYWdpbmc9e25leHQ6ZS5wYWdpbmF0aW9uLm5leHRfdXJsfSxkZWxldGUgZS5wYWdpbmF0aW9uKX1lLmluaXQoe2luc3RhZ3JhbTp7bmFtZTpcIkluc3RhZ3JhbVwiLG9hdXRoOnt2ZXJzaW9uOjIsYXV0aDpcImh0dHBzOi8vaW5zdGFncmFtLmNvbS9vYXV0aC9hdXRob3JpemUvXCIsZ3JhbnQ6XCJodHRwczovL2FwaS5pbnN0YWdyYW0uY29tL29hdXRoL2FjY2Vzc190b2tlblwifSxyZWZyZXNoOiEwLHNjb3BlOntiYXNpYzpcImJhc2ljXCIscGhvdG9zOlwiXCIsZnJpZW5kczpcInJlbGF0aW9uc2hpcHNcIixwdWJsaXNoOlwibGlrZXMgY29tbWVudHNcIixlbWFpbDpcIlwiLHNoYXJlOlwiXCIscHVibGlzaF9maWxlczpcIlwiLGZpbGVzOlwiXCIsdmlkZW9zOlwiXCIsb2ZmbGluZV9hY2Nlc3M6XCJcIn0sc2NvcGVfZGVsaW06XCIgXCIsYmFzZTpcImh0dHBzOi8vYXBpLmluc3RhZ3JhbS5jb20vdjEvXCIsZ2V0OnttZTpcInVzZXJzL3NlbGZcIixcIm1lL2ZlZWRcIjpcInVzZXJzL3NlbGYvZmVlZD9jb3VudD1Ae2xpbWl0fDEwMH1cIixcIm1lL3Bob3Rvc1wiOlwidXNlcnMvc2VsZi9tZWRpYS9yZWNlbnQ/bWluX2lkPTAmY291bnQ9QHtsaW1pdHwxMDB9XCIsXCJtZS9mcmllbmRzXCI6XCJ1c2Vycy9zZWxmL2ZvbGxvd3M/Y291bnQ9QHtsaW1pdHwxMDB9XCIsXCJtZS9mb2xsb3dpbmdcIjpcInVzZXJzL3NlbGYvZm9sbG93cz9jb3VudD1Ae2xpbWl0fDEwMH1cIixcIm1lL2ZvbGxvd2Vyc1wiOlwidXNlcnMvc2VsZi9mb2xsb3dlZC1ieT9jb3VudD1Ae2xpbWl0fDEwMH1cIixcImZyaWVuZC9waG90b3NcIjpcInVzZXJzL0B7aWR9L21lZGlhL3JlY2VudD9taW5faWQ9MCZjb3VudD1Ae2xpbWl0fDEwMH1cIn0scG9zdDp7XCJtZS9saWtlXCI6ZnVuY3Rpb24oZSx0KXt2YXIgbj1lLmRhdGEuaWQ7ZS5kYXRhPXt9LHQoXCJtZWRpYS9cIituK1wiL2xpa2VzXCIpfX0sZGVsOntcIm1lL2xpa2VcIjpcIm1lZGlhL0B7aWR9L2xpa2VzXCJ9LHdyYXA6e21lOmZ1bmN0aW9uKGUpe3JldHVybiBuKGUpLFwiZGF0YVwiaW4gZSYmKGUuaWQ9ZS5kYXRhLmlkLGUudGh1bWJuYWlsPWUuZGF0YS5wcm9maWxlX3BpY3R1cmUsZS5uYW1lPWUuZGF0YS5mdWxsX25hbWV8fGUuZGF0YS51c2VybmFtZSksZX0sXCJtZS9mcmllbmRzXCI6byxcIm1lL2ZvbGxvd2luZ1wiOm8sXCJtZS9mb2xsb3dlcnNcIjpvLFwibWUvcGhvdG9zXCI6ZnVuY3Rpb24oZSl7cmV0dXJuIG4oZSkscihlKSxcImRhdGFcImluIGUmJihlLmRhdGE9ZS5kYXRhLmZpbHRlcihmdW5jdGlvbihlKXtyZXR1cm5cImltYWdlXCI9PT1lLnR5cGV9KSxlLmRhdGEuZm9yRWFjaChmdW5jdGlvbihlKXtlLm5hbWU9ZS5jYXB0aW9uP2UuY2FwdGlvbi50ZXh0Om51bGwsZS50aHVtYm5haWw9ZS5pbWFnZXMudGh1bWJuYWlsLnVybCxlLnBpY3R1cmU9ZS5pbWFnZXMuc3RhbmRhcmRfcmVzb2x1dGlvbi51cmwsZS5waWN0dXJlcz1PYmplY3Qua2V5cyhlLmltYWdlcykubWFwKGZ1bmN0aW9uKG4pe3ZhciBvPWUuaW1hZ2VzW25dO3JldHVybiB0KG8pfSkuc29ydChmdW5jdGlvbihlLHQpe3JldHVybiBlLndpZHRoLXQud2lkdGh9KX0pKSxlfSxcImRlZmF1bHRcIjpmdW5jdGlvbihlKXtyZXR1cm4gZT1uKGUpLHIoZSksZX19LHhocjpmdW5jdGlvbihlLHQpe3ZhciBuPWUubWV0aG9kLG89XCJnZXRcIiE9PW47cmV0dXJuIG8mJihcInBvc3RcIiE9PW4mJlwicHV0XCIhPT1ufHwhZS5xdWVyeS5hY2Nlc3NfdG9rZW58fChlLmRhdGEuYWNjZXNzX3Rva2VuPWUucXVlcnkuYWNjZXNzX3Rva2VuLGRlbGV0ZSBlLnF1ZXJ5LmFjY2Vzc190b2tlbiksZS5wcm94eT1vKSxvfSxmb3JtOiExfX0pfShoZWxsbyksZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdChlLHQpe3ZhciBuLGk7cmV0dXJuIGUmJlwiTWVzc2FnZVwiaW4gZSYmKGk9ZS5NZXNzYWdlLGRlbGV0ZSBlLk1lc3NhZ2UsXCJFcnJvckNvZGVcImluIGU/KG49ZS5FcnJvckNvZGUsZGVsZXRlIGUuRXJyb3JDb2RlKTpuPW8odCksZS5lcnJvcj17Y29kZTpuLG1lc3NhZ2U6aSxkZXRhaWxzOmV9KSxlfWZ1bmN0aW9uIG4oZSx0KXt2YXIgbj10LmFjY2Vzc190b2tlbjtyZXR1cm4gZGVsZXRlIHQuYWNjZXNzX3Rva2VuLGUuaGVhZGVycy5BdXRob3JpemF0aW9uPVwiQmVhcmVyIFwiK24sXCJnZXRcIiE9PWUubWV0aG9kJiZlLmRhdGEmJihlLmhlYWRlcnNbXCJDb250ZW50LVR5cGVcIl09XCJhcHBsaWNhdGlvbi9qc29uXCIsXCJvYmplY3RcIj09dHlwZW9mIGUuZGF0YSYmKGUuZGF0YT1KU09OLnN0cmluZ2lmeShlLmRhdGEpKSksXCJwdXRcIj09PWUubWV0aG9kJiYoZS5tZXRob2Q9XCJwYXRjaFwiKSwhMH1mdW5jdGlvbiBvKGUpe3N3aXRjaChlLnN0YXR1c0NvZGUpe2Nhc2UgNDAwOnJldHVyblwiaW52YWxpZF9yZXF1ZXN0XCI7Y2FzZSA0MDM6cmV0dXJuXCJzdGFsZV90b2tlblwiO2Nhc2UgNDAxOnJldHVyblwiaW52YWxpZF90b2tlblwiO2Nhc2UgNTAwOnJldHVyblwic2VydmVyX2Vycm9yXCI7ZGVmYXVsdDpyZXR1cm5cInNlcnZlcl9lcnJvclwifX1lLmluaXQoe2pvaW5tZTp7bmFtZTpcImpvaW4ubWVcIixvYXV0aDp7dmVyc2lvbjoyLGF1dGg6XCJodHRwczovL3NlY3VyZS5qb2luLm1lL2FwaS9wdWJsaWMvdjEvYXV0aC9vYXV0aDJcIixncmFudDpcImh0dHBzOi8vc2VjdXJlLmpvaW4ubWUvYXBpL3B1YmxpYy92MS9hdXRoL29hdXRoMlwifSxyZWZyZXNoOiExLHNjb3BlOntiYXNpYzpcInVzZXJfaW5mb1wiLHVzZXI6XCJ1c2VyX2luZm9cIixzY2hlZHVsZXI6XCJzY2hlZHVsZXJcIixzdGFydDpcInN0YXJ0X21lZXRpbmdcIixlbWFpbDpcIlwiLGZyaWVuZHM6XCJcIixzaGFyZTpcIlwiLHB1Ymxpc2g6XCJcIixwaG90b3M6XCJcIixwdWJsaXNoX2ZpbGVzOlwiXCIsZmlsZXM6XCJcIix2aWRlb3M6XCJcIixvZmZsaW5lX2FjY2VzczpcIlwifSxzY29wZV9kZWxpbTpcIiBcIixsb2dpbjpmdW5jdGlvbihlKXtlLm9wdGlvbnMucG9wdXAud2lkdGg9NDAwLGUub3B0aW9ucy5wb3B1cC5oZWlnaHQ9NzAwfSxiYXNlOlwiaHR0cHM6Ly9hcGkuam9pbi5tZS92MS9cIixnZXQ6e21lOlwidXNlclwiLG1lZXRpbmdzOlwibWVldGluZ3NcIixcIm1lZXRpbmdzL2luZm9cIjpcIm1lZXRpbmdzL0B7aWR9XCJ9LHBvc3Q6e1wibWVldGluZ3Mvc3RhcnQvYWRob2NcIjpmdW5jdGlvbihlLHQpe3QoXCJtZWV0aW5ncy9zdGFydFwiKX0sXCJtZWV0aW5ncy9zdGFydC9zY2hlZHVsZWRcIjpmdW5jdGlvbihlLHQpe3ZhciBuPWUuZGF0YS5tZWV0aW5nSWQ7ZS5kYXRhPXt9LHQoXCJtZWV0aW5ncy9cIituK1wiL3N0YXJ0XCIpfSxcIm1lZXRpbmdzL3NjaGVkdWxlXCI6ZnVuY3Rpb24oZSx0KXt0KFwibWVldGluZ3NcIil9fSxwYXRjaDp7XCJtZWV0aW5ncy91cGRhdGVcIjpmdW5jdGlvbihlLHQpe3QoXCJtZWV0aW5ncy9cIitlLmRhdGEubWVldGluZ0lkKX19LGRlbDp7XCJtZWV0aW5ncy9kZWxldGVcIjpcIm1lZXRpbmdzL0B7aWR9XCJ9LHdyYXA6e21lOmZ1bmN0aW9uKGUsbil7cmV0dXJuIHQoZSxuKSxlLmVtYWlsPyhlLm5hbWU9ZS5mdWxsTmFtZSxlLmZpcnN0X25hbWU9ZS5uYW1lLnNwbGl0KFwiIFwiKVswXSxlLmxhc3RfbmFtZT1lLm5hbWUuc3BsaXQoXCIgXCIpWzFdLGUuaWQ9ZS5lbWFpbCxlKTplfSxcImRlZmF1bHRcIjpmdW5jdGlvbihlLG4pe3JldHVybiB0KGUsbiksZX19LHhocjpufX0pfShoZWxsbyksZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdChlKXtlJiZcImVycm9yQ29kZVwiaW4gZSYmKGUuZXJyb3I9e2NvZGU6ZS5zdGF0dXMsbWVzc2FnZTplLm1lc3NhZ2V9KX1mdW5jdGlvbiBuKGUpe3JldHVybiBlLmVycm9yP3ZvaWQgMDooZS5maXJzdF9uYW1lPWUuZmlyc3ROYW1lLGUubGFzdF9uYW1lPWUubGFzdE5hbWUsZS5uYW1lPWUuZm9ybWF0dGVkTmFtZXx8ZS5maXJzdF9uYW1lK1wiIFwiK2UubGFzdF9uYW1lLGUudGh1bWJuYWlsPWUucGljdHVyZVVybCxlLmVtYWlsPWUuZW1haWxBZGRyZXNzLGUpfWZ1bmN0aW9uIG8oZSl7cmV0dXJuIHQoZSksaShlKSxlLnZhbHVlcyYmKGUuZGF0YT1lLnZhbHVlcy5tYXAobiksZGVsZXRlIGUudmFsdWVzKSxlfWZ1bmN0aW9uIGkoZSl7XCJfY291bnRcImluIGUmJlwiX3N0YXJ0XCJpbiBlJiZlLl9jb3VudCtlLl9zdGFydDxlLl90b3RhbCYmKGUucGFnaW5nPXtuZXh0OlwiP3N0YXJ0PVwiKyhlLl9zdGFydCtlLl9jb3VudCkrXCImY291bnQ9XCIrZS5fY291bnR9KX1mdW5jdGlvbiByKGUsdCl7XCJ7fVwiPT09SlNPTi5zdHJpbmdpZnkoZSkmJjIwMD09PXQuc3RhdHVzQ29kZSYmKGUuc3VjY2Vzcz0hMCl9ZnVuY3Rpb24gYShlKXtlLmFjY2Vzc190b2tlbiYmKGUub2F1dGgyX2FjY2Vzc190b2tlbj1lLmFjY2Vzc190b2tlbixkZWxldGUgZS5hY2Nlc3NfdG9rZW4pfWZ1bmN0aW9uIHMoZSx0KXtlLmhlYWRlcnNbXCJ4LWxpLWZvcm1hdFwiXT1cImpzb25cIjt2YXIgbj1lLmRhdGEuaWQ7ZS5kYXRhPShcImRlbGV0ZVwiIT09ZS5tZXRob2QpLnRvU3RyaW5nKCksZS5tZXRob2Q9XCJwdXRcIix0KFwicGVvcGxlL34vbmV0d29yay91cGRhdGVzL2tleT1cIituK1wiL2lzLWxpa2VkXCIpfWUuaW5pdCh7bGlua2VkaW46e29hdXRoOnt2ZXJzaW9uOjIscmVzcG9uc2VfdHlwZTpcImNvZGVcIixhdXRoOlwiaHR0cHM6Ly93d3cubGlua2VkaW4uY29tL3Vhcy9vYXV0aDIvYXV0aG9yaXphdGlvblwiLGdyYW50OlwiaHR0cHM6Ly93d3cubGlua2VkaW4uY29tL3Vhcy9vYXV0aDIvYWNjZXNzVG9rZW5cIn0scmVmcmVzaDohMCxzY29wZTp7YmFzaWM6XCJyX2Jhc2ljcHJvZmlsZVwiLGVtYWlsOlwicl9lbWFpbGFkZHJlc3NcIixmaWxlczpcIlwiLGZyaWVuZHM6XCJcIixwaG90b3M6XCJcIixwdWJsaXNoOlwid19zaGFyZVwiLHB1Ymxpc2hfZmlsZXM6XCJ3X3NoYXJlXCIsc2hhcmU6XCJcIix2aWRlb3M6XCJcIixvZmZsaW5lX2FjY2VzczpcIlwifSxzY29wZV9kZWxpbTpcIiBcIixiYXNlOlwiaHR0cHM6Ly9hcGkubGlua2VkaW4uY29tL3YxL1wiLGdldDp7bWU6XCJwZW9wbGUvfjoocGljdHVyZS11cmwsZmlyc3QtbmFtZSxsYXN0LW5hbWUsaWQsZm9ybWF0dGVkLW5hbWUsZW1haWwtYWRkcmVzcylcIixcIm1lL3NoYXJlXCI6XCJwZW9wbGUvfi9uZXR3b3JrL3VwZGF0ZXM/Y291bnQ9QHtsaW1pdHwyNTB9XCJ9LHBvc3Q6e1wibWUvc2hhcmVcIjpmdW5jdGlvbihlLHQpe3ZhciBuPXt2aXNpYmlsaXR5Ontjb2RlOlwiYW55b25lXCJ9fTtlLmRhdGEuaWQ/bi5hdHRyaWJ1dGlvbj17c2hhcmU6e2lkOmUuZGF0YS5pZH19OihuLmNvbW1lbnQ9ZS5kYXRhLm1lc3NhZ2UsZS5kYXRhLnBpY3R1cmUmJmUuZGF0YS5saW5rJiYobi5jb250ZW50PXtcInN1Ym1pdHRlZC11cmxcIjplLmRhdGEubGluayxcInN1Ym1pdHRlZC1pbWFnZS11cmxcIjplLmRhdGEucGljdHVyZX0pKSxlLmRhdGE9SlNPTi5zdHJpbmdpZnkobiksdChcInBlb3BsZS9+L3NoYXJlcz9mb3JtYXQ9anNvblwiKX0sXCJtZS9saWtlXCI6c30sZGVsOntcIm1lL2xpa2VcIjpzfSx3cmFwOnttZTpmdW5jdGlvbihlKXtyZXR1cm4gdChlKSxuKGUpLGV9LFwibWUvZnJpZW5kc1wiOm8sXCJtZS9mb2xsb3dpbmdcIjpvLFwibWUvZm9sbG93ZXJzXCI6byxcIm1lL3NoYXJlXCI6ZnVuY3Rpb24oZSl7cmV0dXJuIHQoZSksaShlKSxlLnZhbHVlcyYmKGUuZGF0YT1lLnZhbHVlcy5tYXAobiksZS5kYXRhLmZvckVhY2goZnVuY3Rpb24oZSl7ZS5tZXNzYWdlPWUuaGVhZGxpbmV9KSxkZWxldGUgZS52YWx1ZXMpLGV9LFwiZGVmYXVsdFwiOmZ1bmN0aW9uKGUsbil7dChlKSxyKGUsbiksaShlKX19LGpzb25wOmZ1bmN0aW9uKGUsdCl7YSh0KSxcImdldFwiPT09ZS5tZXRob2QmJih0LmZvcm1hdD1cImpzb25wXCIsdFtcImVycm9yLWNhbGxiYWNrXCJdPWUuY2FsbGJhY2tJRCl9LHhocjpmdW5jdGlvbihlLHQpe3JldHVyblwiZ2V0XCIhPT1lLm1ldGhvZD8oYSh0KSxlLmhlYWRlcnNbXCJDb250ZW50LVR5cGVcIl09XCJhcHBsaWNhdGlvbi9qc29uXCIsZS5oZWFkZXJzW1wieC1saS1mb3JtYXRcIl09XCJqc29uXCIsZS5wcm94eT0hMCwhMCk6ITF9fX0pfShoZWxsbyksZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdChlLHQpe3ZhciBuPXQuYWNjZXNzX3Rva2VuO3JldHVybiBkZWxldGUgdC5hY2Nlc3NfdG9rZW4sdC5vYXV0aF90b2tlbj1uLHRbXCJfc3RhdHVzX2NvZGVfbWFwWzMwMl1cIl09MjAwLCEwfWZ1bmN0aW9uIG4oZSl7cmV0dXJuIGUuaWQmJihlLnBpY3R1cmU9ZS5hdmF0YXJfdXJsLGUudGh1bWJuYWlsPWUuYXZhdGFyX3VybCxlLm5hbWU9ZS51c2VybmFtZXx8ZS5mdWxsX25hbWUpLGV9ZnVuY3Rpb24gbyhlKXtcIm5leHRfaHJlZlwiaW4gZSYmKGUucGFnaW5nPXtuZXh0OmUubmV4dF9ocmVmfSl9ZS5pbml0KHtzb3VuZGNsb3VkOntuYW1lOlwiU291bmRDbG91ZFwiLG9hdXRoOnt2ZXJzaW9uOjIsYXV0aDpcImh0dHBzOi8vc291bmRjbG91ZC5jb20vY29ubmVjdFwiLGdyYW50OlwiaHR0cHM6Ly9zb3VuZGNsb3VkLmNvbS9vYXV0aDIvdG9rZW5cIn0sYmFzZTpcImh0dHBzOi8vYXBpLnNvdW5kY2xvdWQuY29tL1wiLGdldDp7bWU6XCJtZS5qc29uXCIsXCJtZS9mcmllbmRzXCI6XCJtZS9mb2xsb3dpbmdzLmpzb25cIixcIm1lL2ZvbGxvd2Vyc1wiOlwibWUvZm9sbG93ZXJzLmpzb25cIixcIm1lL2ZvbGxvd2luZ1wiOlwibWUvZm9sbG93aW5ncy5qc29uXCIsXCJkZWZhdWx0XCI6ZnVuY3Rpb24oZSx0KXt0KGUucGF0aCtcIi5qc29uXCIpfX0sd3JhcDp7bWU6ZnVuY3Rpb24oZSl7cmV0dXJuIG4oZSksZX0sXCJkZWZhdWx0XCI6ZnVuY3Rpb24oZSl7cmV0dXJuIEFycmF5LmlzQXJyYXkoZSkmJihlPXtkYXRhOmUubWFwKG4pfSksbyhlKSxlfX0seGhyOnQsanNvbnA6dH19KX0oaGVsbG8pLGZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoZSl7aWYoZS5pZCl7aWYoZS5uYW1lKXt2YXIgdD1lLm5hbWUuc3BsaXQoXCIgXCIpO2UuZmlyc3RfbmFtZT10LnNoaWZ0KCksZS5sYXN0X25hbWU9dC5qb2luKFwiIFwiKX1lLnRodW1ibmFpbD1lLnByb2ZpbGVfaW1hZ2VfdXJsX2h0dHBzfHxlLnByb2ZpbGVfaW1hZ2VfdXJsfXJldHVybiBlfWZ1bmN0aW9uIG4oZSl7cmV0dXJuIG8oZSksaShlKSxlLnVzZXJzJiYoZS5kYXRhPWUudXNlcnMubWFwKHQpLGRlbGV0ZSBlLnVzZXJzKSxlfWZ1bmN0aW9uIG8oZSl7aWYoZS5lcnJvcnMpe3ZhciB0PWUuZXJyb3JzWzBdO2UuZXJyb3I9e2NvZGU6XCJyZXF1ZXN0X2ZhaWxlZFwiLG1lc3NhZ2U6dC5tZXNzYWdlfX19ZnVuY3Rpb24gaShlKXtcIm5leHRfY3Vyc29yX3N0clwiaW4gZSYmKGUucGFnaW5nPXtuZXh0OlwiP2N1cnNvcj1cIitlLm5leHRfY3Vyc29yX3N0cn0pfWZ1bmN0aW9uIHIoZSl7cmV0dXJuIEFycmF5LmlzQXJyYXkoZSk/e2RhdGE6ZX06ZX12YXIgYT1cImh0dHBzOi8vYXBpLnR3aXR0ZXIuY29tL1wiO2UuaW5pdCh7dHdpdHRlcjp7b2F1dGg6e3ZlcnNpb246XCIxLjBhXCIsYXV0aDphK1wib2F1dGgvYXV0aGVudGljYXRlXCIscmVxdWVzdDphK1wib2F1dGgvcmVxdWVzdF90b2tlblwiLHRva2VuOmErXCJvYXV0aC9hY2Nlc3NfdG9rZW5cIn0sbG9naW46ZnVuY3Rpb24oZSl7dmFyIHQ9XCI/Zm9yY2VfbG9naW49dHJ1ZVwiO3RoaXMub2F1dGguYXV0aD10aGlzLm9hdXRoLmF1dGgucmVwbGFjZSh0LFwiXCIpKyhlLm9wdGlvbnMuZm9yY2U/dDpcIlwiKX0sYmFzZTphK1wiMS4xL1wiLGdldDp7bWU6XCJhY2NvdW50L3ZlcmlmeV9jcmVkZW50aWFscy5qc29uXCIsXCJtZS9mcmllbmRzXCI6XCJmcmllbmRzL2xpc3QuanNvbj9jb3VudD1Ae2xpbWl0fDIwMH1cIixcIm1lL2ZvbGxvd2luZ1wiOlwiZnJpZW5kcy9saXN0Lmpzb24/Y291bnQ9QHtsaW1pdHwyMDB9XCIsXCJtZS9mb2xsb3dlcnNcIjpcImZvbGxvd2Vycy9saXN0Lmpzb24/Y291bnQ9QHtsaW1pdHwyMDB9XCIsXCJtZS9zaGFyZVwiOlwic3RhdHVzZXMvdXNlcl90aW1lbGluZS5qc29uP2NvdW50PUB7bGltaXR8MjAwfVwiLFwibWUvbGlrZVwiOlwiZmF2b3JpdGVzL2xpc3QuanNvbj9jb3VudD1Ae2xpbWl0fDIwMH1cIn0scG9zdDp7XCJtZS9zaGFyZVwiOmZ1bmN0aW9uKHQsbil7dmFyIG89dC5kYXRhO3QuZGF0YT1udWxsO3ZhciBpPVtdO28ubWVzc2FnZSYmKGkucHVzaChvLm1lc3NhZ2UpLGRlbGV0ZSBvLm1lc3NhZ2UpLG8ubGluayYmKGkucHVzaChvLmxpbmspLGRlbGV0ZSBvLmxpbmspLG8ucGljdHVyZSYmKGkucHVzaChvLnBpY3R1cmUpLGRlbGV0ZSBvLnBpY3R1cmUpLGkubGVuZ3RoJiYoby5zdGF0dXM9aS5qb2luKFwiIFwiKSksby5maWxlPyhvW1wibWVkaWFbXVwiXT1vLmZpbGUsZGVsZXRlIG8uZmlsZSx0LmRhdGE9byxuKFwic3RhdHVzZXMvdXBkYXRlX3dpdGhfbWVkaWEuanNvblwiKSk6XCJpZFwiaW4gbz9uKFwic3RhdHVzZXMvcmV0d2VldC9cIitvLmlkK1wiLmpzb25cIik6KGUudXRpbHMuZXh0ZW5kKHQucXVlcnksbyksbihcInN0YXR1c2VzL3VwZGF0ZS5qc29uP2luY2x1ZGVfZW50aXRpZXM9MVwiKSl9LFwibWUvbGlrZVwiOmZ1bmN0aW9uKGUsdCl7dmFyIG49ZS5kYXRhLmlkO2UuZGF0YT1udWxsLHQoXCJmYXZvcml0ZXMvY3JlYXRlLmpzb24/aWQ9XCIrbil9fSxkZWw6e1wibWUvbGlrZVwiOmZ1bmN0aW9uKCl7cC5tZXRob2Q9XCJwb3N0XCI7dmFyIGU9cC5kYXRhLmlkO3AuZGF0YT1udWxsLGNhbGxiYWNrKFwiZmF2b3JpdGVzL2Rlc3Ryb3kuanNvbj9pZD1cIitlKX19LHdyYXA6e21lOmZ1bmN0aW9uKGUpe3JldHVybiBvKGUpLHQoZSksZX0sXCJtZS9mcmllbmRzXCI6bixcIm1lL2ZvbGxvd2Vyc1wiOm4sXCJtZS9mb2xsb3dpbmdcIjpuLFwibWUvc2hhcmVcIjpmdW5jdGlvbihlKXtyZXR1cm4gbyhlKSxpKGUpLCFlLmVycm9yJiZcImxlbmd0aFwiaW4gZT97ZGF0YTplfTplfSxcImRlZmF1bHRcIjpmdW5jdGlvbihlKXtyZXR1cm4gZT1yKGUpLGkoZSksZX19LHhocjpmdW5jdGlvbihlKXtyZXR1cm5cImdldFwiIT09ZS5tZXRob2R9fX0pfShoZWxsbyksZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdChlLHQpe3JldHVybiBudWxsIT09ZSYmXCJyZXNwb25zZVwiaW4gZSYmbnVsbCE9PWUucmVzcG9uc2UmJmUucmVzcG9uc2UubGVuZ3RoJiYoZT1lLnJlc3BvbnNlWzBdLGUuaWQ9ZS51aWQsZS50aHVtYm5haWw9ZS5waWN0dXJlPWUucGhvdG9fbWF4LGUubmFtZT1lLmZpcnN0X25hbWUrXCIgXCIrZS5sYXN0X25hbWUsdC5hdXRoUmVzcG9uc2UmJm51bGwhPT10LmF1dGhSZXNwb25zZS5lbWFpbCYmKGUuZW1haWw9dC5hdXRoUmVzcG9uc2UuZW1haWwpKSxlfWZ1bmN0aW9uIG4oZSl7aWYoZS5lcnJvcil7dmFyIHQ9ZS5lcnJvcjtlLmVycm9yPXtjb2RlOnQuZXJyb3JfY29kZSxtZXNzYWdlOnQuZXJyb3JfbXNnfX19ZS5pbml0KHt2azp7bmFtZTpcIlZrXCIsb2F1dGg6e3ZlcnNpb246MixhdXRoOlwiaHR0cHM6Ly9vYXV0aC52ay5jb20vYXV0aG9yaXplXCIsZ3JhbnQ6XCJodHRwczovL29hdXRoLnZrLmNvbS9hY2Nlc3NfdG9rZW5cIn0sc2NvcGU6e2VtYWlsOlwiZW1haWxcIixmcmllbmRzOlwiZnJpZW5kc1wiLHBob3RvczpcInBob3Rvc1wiLHZpZGVvczpcInZpZGVvXCIsc2hhcmU6XCJzaGFyZVwiLG9mZmxpbmVfYWNjZXNzOlwib2ZmbGluZVwifSxyZWZyZXNoOiEwLGxvZ2luOmZ1bmN0aW9uKGUpe2UucXMuZGlzcGxheT13aW5kb3cubmF2aWdhdG9yJiZ3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCYmL2lwYWR8cGhvbmV8cGhvbmV8YW5kcm9pZC8udGVzdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpKT9cIm1vYmlsZVwiOlwicG9wdXBcIn0sYmFzZTpcImh0dHBzOi8vYXBpLnZrLmNvbS9tZXRob2QvXCIsZ2V0OnttZTpmdW5jdGlvbihlLHQpe2UucXVlcnkuZmllbGRzPVwiaWQsZmlyc3RfbmFtZSxsYXN0X25hbWUscGhvdG9fbWF4XCIsdChcInVzZXJzLmdldFwiKX19LHdyYXA6e21lOmZ1bmN0aW9uKGUsbyxpKXtyZXR1cm4gbihlKSx0KGUsaSl9fSx4aHI6ITEsanNvbnA6ITAsZm9ybTohMX19KX0oaGVsbG8pLGZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoZSl7cmV0dXJuXCJkYXRhXCJpbiBlJiZlLmRhdGEuZm9yRWFjaChmdW5jdGlvbihlKXtlLnBpY3R1cmUmJihlLnRodW1ibmFpbD1lLnBpY3R1cmUpLGUuaW1hZ2VzJiYoZS5waWN0dXJlcz1lLmltYWdlcy5tYXAobikuc29ydChmdW5jdGlvbihlLHQpe3JldHVybiBlLndpZHRoLXQud2lkdGh9KSl9KSxlfWZ1bmN0aW9uIG4oZSl7cmV0dXJue3dpZHRoOmUud2lkdGgsaGVpZ2h0OmUuaGVpZ2h0LHNvdXJjZTplLnNvdXJjZX19ZnVuY3Rpb24gbyhlKXtyZXR1cm5cImRhdGFcImluIGUmJmUuZGF0YS5mb3JFYWNoKGZ1bmN0aW9uKGUpe2UucGhvdG9zPWUuZmlsZXM9XCJodHRwczovL2FwaXMubGl2ZS5uZXQvdjUuMC9cIitlLmlkK1wiL3Bob3Rvc1wifSksZX1mdW5jdGlvbiBpKGUsdCxuKXtpZihlLmlkKXt2YXIgbz1uLnF1ZXJ5LmFjY2Vzc190b2tlbjtpZihlLmVtYWlscyYmKGUuZW1haWw9ZS5lbWFpbHMucHJlZmVycmVkKSxlLmlzX2ZyaWVuZCE9PSExKXt2YXIgaT1lLnVzZXJfaWR8fGUuaWQ7ZS50aHVtYm5haWw9ZS5waWN0dXJlPVwiaHR0cHM6Ly9hcGlzLmxpdmUubmV0L3Y1LjAvXCIraStcIi9waWN0dXJlP2FjY2Vzc190b2tlbj1cIitvfX1yZXR1cm4gZX1mdW5jdGlvbiByKGUsdCxuKXtyZXR1cm5cImRhdGFcImluIGUmJmUuZGF0YS5mb3JFYWNoKGZ1bmN0aW9uKGUpe2koZSx0LG4pfSksZX1lLmluaXQoe3dpbmRvd3M6e25hbWU6XCJXaW5kb3dzIGxpdmVcIixvYXV0aDp7dmVyc2lvbjoyLGF1dGg6XCJodHRwczovL2xvZ2luLmxpdmUuY29tL29hdXRoMjBfYXV0aG9yaXplLnNyZlwiLGdyYW50OlwiaHR0cHM6Ly9sb2dpbi5saXZlLmNvbS9vYXV0aDIwX3Rva2VuLnNyZlwifSxyZWZyZXNoOiEwLGxvZ291dDpmdW5jdGlvbigpe3JldHVyblwiaHR0cDovL2xvZ2luLmxpdmUuY29tL29hdXRoMjBfbG9nb3V0LnNyZj90cz1cIisobmV3IERhdGUpLmdldFRpbWUoKX0sc2NvcGU6e2Jhc2ljOlwid2wuc2lnbmluLHdsLmJhc2ljXCIsZW1haWw6XCJ3bC5lbWFpbHNcIixiaXJ0aGRheTpcIndsLmJpcnRoZGF5XCIsZXZlbnRzOlwid2wuY2FsZW5kYXJzXCIscGhvdG9zOlwid2wucGhvdG9zXCIsdmlkZW9zOlwid2wucGhvdG9zXCIsZnJpZW5kczpcIndsLmNvbnRhY3RzX2VtYWlsc1wiLGZpbGVzOlwid2wuc2t5ZHJpdmVcIixwdWJsaXNoOlwid2wuc2hhcmVcIixwdWJsaXNoX2ZpbGVzOlwid2wuc2t5ZHJpdmVfdXBkYXRlXCIsc2hhcmU6XCJ3bC5zaGFyZVwiLGNyZWF0ZV9ldmVudDpcIndsLmNhbGVuZGFyc191cGRhdGUsd2wuZXZlbnRzX2NyZWF0ZVwiLG9mZmxpbmVfYWNjZXNzOlwid2wub2ZmbGluZV9hY2Nlc3NcIn0sYmFzZTpcImh0dHBzOi8vYXBpcy5saXZlLm5ldC92NS4wL1wiLGdldDp7bWU6XCJtZVwiLFwibWUvZnJpZW5kc1wiOlwibWUvZnJpZW5kc1wiLFwibWUvZm9sbG93aW5nXCI6XCJtZS9jb250YWN0c1wiLFwibWUvZm9sbG93ZXJzXCI6XCJtZS9mcmllbmRzXCIsXCJtZS9jb250YWN0c1wiOlwibWUvY29udGFjdHNcIixcIm1lL2FsYnVtc1wiOlwibWUvYWxidW1zXCIsXCJtZS9hbGJ1bVwiOlwiQHtpZH0vZmlsZXNcIixcIm1lL3Bob3RvXCI6XCJAe2lkfVwiLFwibWUvZmlsZXNcIjpcIkB7cGFyZW50fG1lL3NreWRyaXZlfS9maWxlc1wiLFwibWUvZm9sZGVyc1wiOlwiQHtpZHxtZS9za3lkcml2ZX0vZmlsZXNcIixcIm1lL2ZvbGRlclwiOlwiQHtpZHxtZS9za3lkcml2ZX0vZmlsZXNcIn0scG9zdDp7XCJtZS9hbGJ1bXNcIjpcIm1lL2FsYnVtc1wiLFwibWUvYWxidW1cIjpcIkB7aWR9L2ZpbGVzL1wiLFwibWUvZm9sZGVyc1wiOlwiQHtpZHxtZS9za3lkcml2ZS99XCIsXCJtZS9maWxlc1wiOlwiQHtwYXJlbnR8bWUvc2t5ZHJpdmV9L2ZpbGVzXCJ9LGRlbDp7XCJtZS9hbGJ1bVwiOlwiQHtpZH1cIixcIm1lL3Bob3RvXCI6XCJAe2lkfVwiLFwibWUvZm9sZGVyXCI6XCJAe2lkfVwiLFwibWUvZmlsZXNcIjpcIkB7aWR9XCJ9LHdyYXA6e21lOmksXCJtZS9mcmllbmRzXCI6cixcIm1lL2NvbnRhY3RzXCI6cixcIm1lL2ZvbGxvd2Vyc1wiOnIsXCJtZS9mb2xsb3dpbmdcIjpyLFwibWUvYWxidW1zXCI6byxcIm1lL3Bob3Rvc1wiOnQsXCJkZWZhdWx0XCI6dH0seGhyOmZ1bmN0aW9uKHQpe3JldHVyblwiZ2V0XCI9PT10Lm1ldGhvZHx8XCJkZWxldGVcIj09PXQubWV0aG9kfHxlLnV0aWxzLmhhc0JpbmFyeSh0LmRhdGEpfHwoXCJzdHJpbmdcIj09dHlwZW9mIHQuZGF0YS5maWxlP3QuZGF0YS5maWxlPWUudXRpbHMudG9CbG9iKHQuZGF0YS5maWxlKToodC5kYXRhPUpTT04uc3RyaW5naWZ5KHQuZGF0YSksdC5oZWFkZXJzPXtcIkNvbnRlbnQtVHlwZVwiOlwiYXBwbGljYXRpb24vanNvblwifSkpLCEwfSxqc29ucDpmdW5jdGlvbih0KXtcImdldFwiPT09dC5tZXRob2R8fGUudXRpbHMuaGFzQmluYXJ5KHQuZGF0YSl8fCh0LmRhdGEubWV0aG9kPXQubWV0aG9kLHQubWV0aG9kPVwiZ2V0XCIpfX19KX0oaGVsbG8pLGZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoZSl7ZSYmXCJtZXRhXCJpbiBlJiZcImVycm9yX3R5cGVcImluIGUubWV0YSYmKGUuZXJyb3I9e2NvZGU6ZS5tZXRhLmVycm9yX3R5cGUsbWVzc2FnZTplLm1ldGEuZXJyb3JfbWVzc2FnZX0pfWZ1bmN0aW9uIG4oZSl7aWYodChlKSxlLnF1ZXJ5JiZlLnF1ZXJ5LnJlc3VsdHMmJmUucXVlcnkucmVzdWx0cy5wcm9maWxlKXtlPWUucXVlcnkucmVzdWx0cy5wcm9maWxlLGUuaWQ9ZS5ndWlkLGUubGFzdF9uYW1lPWUuZmFtaWx5TmFtZSxlLmZpcnN0X25hbWU9ZS5naXZlbk5hbWV8fGUubmlja25hbWU7dmFyIG49W107ZS5maXJzdF9uYW1lJiZuLnB1c2goZS5maXJzdF9uYW1lKSxlLmxhc3RfbmFtZSYmbi5wdXNoKGUubGFzdF9uYW1lKSxlLm5hbWU9bi5qb2luKFwiIFwiKSxlLmVtYWlsPWUuZW1haWxzJiZlLmVtYWlsc1swXT9lLmVtYWlsc1swXS5oYW5kbGU6bnVsbCxlLnRodW1ibmFpbD1lLmltYWdlP2UuaW1hZ2UuaW1hZ2VVcmw6bnVsbH1yZXR1cm4gZX1mdW5jdGlvbiBvKGUsbixvKXt0KGUpLHIoZSxuLG8pO3JldHVybiBlLnF1ZXJ5JiZlLnF1ZXJ5LnJlc3VsdHMmJmUucXVlcnkucmVzdWx0cy5jb250YWN0JiYoZS5kYXRhPWUucXVlcnkucmVzdWx0cy5jb250YWN0LGRlbGV0ZSBlLnF1ZXJ5LEFycmF5LmlzQXJyYXkoZS5kYXRhKXx8KGUuZGF0YT1bZS5kYXRhXSksZS5kYXRhLmZvckVhY2goaSkpLGV9ZnVuY3Rpb24gaShlKXtlLmlkPW51bGwsIWUuZmllbGRzfHxlLmZpZWxkcyBpbnN0YW5jZW9mIEFycmF5fHwoZS5maWVsZHM9W2UuZmllbGRzXSksKGUuZmllbGRzfHxbXSkuZm9yRWFjaChmdW5jdGlvbih0KXtcImVtYWlsXCI9PT10LnR5cGUmJihlLmVtYWlsPXQudmFsdWUpLFwibmFtZVwiPT09dC50eXBlJiYoZS5maXJzdF9uYW1lPXQudmFsdWUuZ2l2ZW5OYW1lLGUubGFzdF9uYW1lPXQudmFsdWUuZmFtaWx5TmFtZSxlLm5hbWU9dC52YWx1ZS5naXZlbk5hbWUrXCIgXCIrdC52YWx1ZS5mYW1pbHlOYW1lKSxcInlhaG9vaWRcIj09PXQudHlwZSYmKGUuaWQ9dC52YWx1ZSl9KX1mdW5jdGlvbiByKGUsdCxuKXtyZXR1cm4gZS5xdWVyeSYmZS5xdWVyeS5jb3VudCYmbi5vcHRpb25zJiYoZS5wYWdpbmc9e25leHQ6XCI/c3RhcnQ9XCIrKGUucXVlcnkuY291bnQrKCtuLm9wdGlvbnMuc3RhcnR8fDEpKX0pLGV9ZnVuY3Rpb24gYShlKXtyZXR1cm5cImh0dHBzOi8vcXVlcnkueWFob29hcGlzLmNvbS92MS95cWw/cT1cIisoZStcIiBsaW1pdCBAe2xpbWl0fDEwMH0gb2Zmc2V0IEB7c3RhcnR8MH1cIikucmVwbGFjZSgvXFxzL2csXCIlMjBcIikrXCImZm9ybWF0PWpzb25cIn1lLmluaXQoe3lhaG9vOntvYXV0aDp7dmVyc2lvbjpcIjEuMGFcIixhdXRoOlwiaHR0cHM6Ly9hcGkubG9naW4ueWFob28uY29tL29hdXRoL3YyL3JlcXVlc3RfYXV0aFwiLHJlcXVlc3Q6XCJodHRwczovL2FwaS5sb2dpbi55YWhvby5jb20vb2F1dGgvdjIvZ2V0X3JlcXVlc3RfdG9rZW5cIix0b2tlbjpcImh0dHBzOi8vYXBpLmxvZ2luLnlhaG9vLmNvbS9vYXV0aC92Mi9nZXRfdG9rZW5cIn0sbG9naW46ZnVuY3Rpb24oZSl7ZS5vcHRpb25zLnBvcHVwLndpZHRoPTU2MDt0cnl7ZGVsZXRlIGUucXMuc3RhdGUuc2NvcGV9Y2F0Y2godCl7fX0sYmFzZTpcImh0dHBzOi8vc29jaWFsLnlhaG9vYXBpcy5jb20vdjEvXCIsZ2V0OnttZTphKFwic2VsZWN0ICogZnJvbSBzb2NpYWwucHJvZmlsZSgwKSB3aGVyZSBndWlkPW1lXCIpLFwibWUvZnJpZW5kc1wiOmEoXCJzZWxlY3QgKiBmcm9tIHNvY2lhbC5jb250YWN0cygwKSB3aGVyZSBndWlkPW1lXCIpLFwibWUvZm9sbG93aW5nXCI6YShcInNlbGVjdCAqIGZyb20gc29jaWFsLmNvbnRhY3RzKDApIHdoZXJlIGd1aWQ9bWVcIil9LHdyYXA6e21lOm4sXCJtZS9mcmllbmRzXCI6byxcIm1lL2ZvbGxvd2luZ1wiOm8sXCJkZWZhdWx0XCI6cn19fSl9KGhlbGxvKSxcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQmJmRlZmluZShmdW5jdGlvbigpe3JldHVybiBoZWxsb30pLFwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzJiYobW9kdWxlLmV4cG9ydHM9aGVsbG8pOyIsIi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uICBBbGwgUmlnaHRzIFJlc2VydmVkLiAgTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiAgU2VlIExpY2Vuc2UgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4ndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnQXBpRXhwbG9yZXInLCBbJ25nQW5pbWF0ZScsICduZ01hdGVyaWFsJ10pXHJcbiAgICAuY29uZmlnKFsnJG1kVGhlbWluZ1Byb3ZpZGVyJywgZnVuY3Rpb24gKCRtZFRoZW1pbmdQcm92aWRlcikge1xyXG5cclxuICAgICRtZFRoZW1pbmdQcm92aWRlci5kZWZpbmVQYWxldHRlKCdPMzY1UHJpbWFyeVBhbGV0dGUnLCB7XHJcbiAgICAgICAgICAgICc1MCc6ICdlOWYwZmMnLFxyXG4gICAgICAgICAgICAnMTAwJzogJ2QzZTJmOCcsXHJcbiAgICAgICAgICAgICcyMDAnOiAnYmRkM2Y1JyxcclxuICAgICAgICAgICAgJzMwMCc6ICc5MWI2ZWUnLCBcclxuICAgICAgICAgICAgJzQwMCc6ICc2NTk5ZTcnLFxyXG4gICAgICAgICAgICAnNTAwJzogJzQ2ODVlMicsIC8vYmx1ZVxyXG4gICAgICAgICAgICAnNjAwJzogJzM4N2JlMCcsXHJcbiAgICAgICAgICAgICc3MDAnOiAnMjI2ZGRkJyxcclxuICAgICAgICAgICAgJzgwMCc6ICcxZjYyYzcnLCBcclxuICAgICAgICAgICAgJzkwMCc6ICcxYzU3YjAnLFxyXG4gICAgICAgICAgICAnQTEwMCc6ICdGRjZBMDAnLCBcclxuICAgICAgICAgICAgJ0EyMDAnOiAnRkY2QTAwJywgXHJcbiAgICAgICAgICAgICdBNDAwJzogJ0ZGNkEwMCcsIFxyXG4gICAgICAgICAgICAnQTcwMCc6ICdGRjZBMDAnLCBcclxuICAgICAgICAgICAgJ2NvbnRyYXN0RGVmYXVsdENvbG9yJzogJ2xpZ2h0JywgICBcclxuICAgICAgICAgICAgJ2NvbnRyYXN0RGFya0NvbG9ycyc6IFsnNTAnLCAnMTAwJywgXHJcbiAgICAgICAgICAgICAgICAnMjAwJywgJzMwMCcsICc0MDAnLCAnQTEwMCddLFxyXG4gICAgICAgICAgICAnY29udHJhc3RMaWdodENvbG9ycyc6IHVuZGVmaW5lZCBcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAkbWRUaGVtaW5nUHJvdmlkZXIuZGVmaW5lUGFsZXR0ZSgnTzM2NUFjY2VudFBhbGV0dGUnLCB7XHJcbiAgICAgICAgICAgICc1MCc6ICdmZmM0OTknLFxyXG4gICAgICAgICAgICAnMTAwJzogJ2ZmYjU4MCcsXHJcbiAgICAgICAgICAgICcyMDAnOiAnZmZhNjY2JyxcclxuICAgICAgICAgICAgJzMwMCc6ICdmZjk3NGQnLCBcclxuICAgICAgICAgICAgJzQwMCc6ICdmZjg4MzMnLFxyXG4gICAgICAgICAgICAnNTAwJzogJ0ZGNkEwMCcsIC8vb3JhbmdlXHJcbiAgICAgICAgICAgICc2MDAnOiAnZTY2MDAwJyxcclxuICAgICAgICAgICAgJzcwMCc6ICdjYzU1MDAnLFxyXG4gICAgICAgICAgICAnODAwJzogJ2IzNGEwMCcsIFxyXG4gICAgICAgICAgICAnOTAwJzogJzk5NDAwMCcsXHJcbiAgICAgICAgICAgICdBMTAwJzogJ0ZGNkEwMCcsXHJcbiAgICAgICAgICAgICdBMjAwJzogJ0ZGNkEwMCcsIFxyXG4gICAgICAgICAgICAnQTQwMCc6ICdGRjZBMDAnLCBcclxuICAgICAgICAgICAgJ0E3MDAnOiAnRkY2QTAwJywgXHJcbiAgICB9KTtcclxuXHJcbiAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKS5wcmltYXJ5UGFsZXR0ZSgnTzM2NVByaW1hcnlQYWxldHRlJyk7XHJcbiAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKS5hY2NlbnRQYWxldHRlKCdPMzY1QWNjZW50UGFsZXR0ZScpO1xyXG59XSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5mdW5jdGlvbiBydW4oJHNjb3BlLCB1cmwsIGFwaVNlcnZpY2UpIHtcclxuICAgICRzY29wZS4kZW1pdCgndXJsQ2hhbmdlJywgdXJsKTtcclxufVxyXG5mdW5jdGlvbiBmb3JtYXRYbWwoeG1sKSB7XHJcbiAgICB2YXIgcmVnID0gLyg+KVxccyooPCkoXFwvKikvZztcclxuICAgIHZhciB3c2V4cCA9IC8gKiguKikgK1xcbi9nO1xyXG4gICAgdmFyIGNvbnRleHAgPSAvKDwuKz4pKC4rXFxuKS9nO1xyXG4gICAgeG1sID0geG1sLnJlcGxhY2UocmVnLCAnJDFcXG4kMiQzJykucmVwbGFjZSh3c2V4cCwgJyQxXFxuJykucmVwbGFjZShjb250ZXhwLCAnJDFcXG4kMicpO1xyXG4gICAgdmFyIHBhZCA9IDA7XHJcbiAgICB2YXIgZm9ybWF0dGVkID0gJyc7XHJcbiAgICB2YXIgbGluZXMgPSB4bWwuc3BsaXQoJ1xcbicpO1xyXG4gICAgdmFyIGluZGVudCA9IDA7XHJcbiAgICB2YXIgbGFzdFR5cGUgPSAnb3RoZXInO1xyXG4gICAgdmFyIHRyYW5zaXRpb25zID0ge1xyXG4gICAgICAgICdzaW5nbGUtPnNpbmdsZSc6IDAsXHJcbiAgICAgICAgJ3NpbmdsZS0+Y2xvc2luZyc6IC0xLFxyXG4gICAgICAgICdzaW5nbGUtPm9wZW5pbmcnOiAwLFxyXG4gICAgICAgICdzaW5nbGUtPm90aGVyJzogMCxcclxuICAgICAgICAnY2xvc2luZy0+c2luZ2xlJzogMCxcclxuICAgICAgICAnY2xvc2luZy0+Y2xvc2luZyc6IC0xLFxyXG4gICAgICAgICdjbG9zaW5nLT5vcGVuaW5nJzogMCxcclxuICAgICAgICAnY2xvc2luZy0+b3RoZXInOiAwLFxyXG4gICAgICAgICdvcGVuaW5nLT5zaW5nbGUnOiAxLFxyXG4gICAgICAgICdvcGVuaW5nLT5jbG9zaW5nJzogMCxcclxuICAgICAgICAnb3BlbmluZy0+b3BlbmluZyc6IDEsXHJcbiAgICAgICAgJ29wZW5pbmctPm90aGVyJzogMSxcclxuICAgICAgICAnb3RoZXItPnNpbmdsZSc6IDAsXHJcbiAgICAgICAgJ290aGVyLT5jbG9zaW5nJzogLTEsXHJcbiAgICAgICAgJ290aGVyLT5vcGVuaW5nJzogMCxcclxuICAgICAgICAnb3RoZXItPm90aGVyJzogMFxyXG4gICAgfTtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB2YXIgbG4gPSBsaW5lc1tpXTtcclxuICAgICAgICB2YXIgc2luZ2xlID0gQm9vbGVhbihsbi5tYXRjaCgvPC4rXFwvPi8pKTtcclxuICAgICAgICB2YXIgY2xvc2luZyA9IEJvb2xlYW4obG4ubWF0Y2goLzxcXC8uKz4vKSk7XHJcbiAgICAgICAgdmFyIG9wZW5pbmcgPSBCb29sZWFuKGxuLm1hdGNoKC88W14hXS4qPi8pKTtcclxuICAgICAgICB2YXIgdHlwZSA9IHNpbmdsZSA/ICdzaW5nbGUnIDogY2xvc2luZyA/ICdjbG9zaW5nJyA6IG9wZW5pbmcgPyAnb3BlbmluZycgOiAnb3RoZXInO1xyXG4gICAgICAgIHZhciBmcm9tVG8gPSBsYXN0VHlwZSArICctPicgKyB0eXBlO1xyXG4gICAgICAgIGxhc3RUeXBlID0gdHlwZTtcclxuICAgICAgICB2YXIgcGFkZGluZyA9ICcnO1xyXG4gICAgICAgIGluZGVudCArPSB0cmFuc2l0aW9uc1tmcm9tVG9dO1xyXG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaW5kZW50OyBqKyspIHtcclxuICAgICAgICAgICAgcGFkZGluZyArPSAnXFx0JztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGZyb21UbyA9PSAnb3BlbmluZy0+Y2xvc2luZycpXHJcbiAgICAgICAgICAgIGZvcm1hdHRlZCA9IGZvcm1hdHRlZC5zdWJzdHIoMCwgZm9ybWF0dGVkLmxlbmd0aCAtIDEpICsgbG4gKyAnXFxuJztcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIGZvcm1hdHRlZCArPSBwYWRkaW5nICsgbG4gKyAnXFxuJztcclxuICAgIH1cclxuICAgIHJldHVybiBmb3JtYXR0ZWQ7XHJcbn1cclxuO1xyXG5mdW5jdGlvbiBpbnNlcnRIZWFkZXJzSW50b1Jlc3BvbnNlVmlld2VyKGhlYWRlcnMsIHN0YXR1cykge1xyXG4gICAgdmFyIHJlc3BvbnNlT2JqID0ge307XHJcbiAgICBpZiAoaGVhZGVycyAhPSBudWxsKSB7XHJcbiAgICAgICAgcmVzcG9uc2VPYmogPSBoZWFkZXJzKCk7XHJcbiAgICB9XHJcbiAgICByZXNwb25zZU9ialtcIlN0YXR1cyBDb2RlXCJdID0gc3RhdHVzO1xyXG4gICAgdmFyIGhlYWRlcnNBcnIgPSBbXTtcclxuICAgIGZvciAodmFyIGhlYWRlck5hbWUgaW4gcmVzcG9uc2VPYmopIHtcclxuICAgICAgICBoZWFkZXJzQXJyLnB1c2goaGVhZGVyTmFtZSArIFwiOiBcIiArIHJlc3BvbnNlT2JqW2hlYWRlck5hbWVdKTtcclxuICAgIH1cclxuICAgIGdldEpzb25WaWV3ZXIoKS5nZXRTZXNzaW9uKCkuc2V0VmFsdWUoXCJcIik7XHJcbiAgICBnZXRKc29uVmlld2VyKCkuZ2V0U2Vzc2lvbigpLmluc2VydCgwLCBoZWFkZXJzQXJyLmpvaW4oXCJcXG5cIikpO1xyXG59XHJcbmZ1bmN0aW9uIHNob3dSZXN1bHRzKHJlc3VsdHMsIGhlYWRlcnMsIHN0YXR1cywgcmVzcG9uc2VDb250ZW50VHlwZSkge1xyXG4gICAgZ2V0SnNvblZpZXdlcigpLnNldFZhbHVlKFwiXCIpO1xyXG4gICAgaW5zZXJ0SGVhZGVyc0ludG9SZXNwb25zZVZpZXdlcihoZWFkZXJzLCBzdGF0dXMpO1xyXG4gICAgZ2V0SnNvblZpZXdlcigpLmdldFNlc3Npb24oKS5pbnNlcnQoMCwgcmVzdWx0cyk7XHJcbiAgICBpZiAocmVzcG9uc2VDb250ZW50VHlwZSlcclxuICAgICAgICBnZXRKc29uVmlld2VyKCkuZ2V0U2Vzc2lvbigpLnNldE1vZGUoXCJhY2UvbW9kZS9cIiArIHJlc3BvbnNlQ29udGVudFR5cGUpO1xyXG59XHJcbmZ1bmN0aW9uIGhhbmRsZUltYWdlUmVzcG9uc2UoJHNjb3BlLCBhcGlTZXJ2aWNlLCBzdGFydFRpbWUsIGhlYWRlcnMsIHN0YXR1cywgaGFuZGxlVW5zdWNjZXNzZnVsUXVlcnlSZXNwb25zZSkge1xyXG4gICAgYXBpU2VydmljZS5wZXJmb3JtUXVlcnkoJ0dFVF9CSU5BUlknKSgkc2NvcGUuZ2V0U2VhcmNoVGV4dCgpKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICB2YXIgYmxvYiA9IG5ldyBCbG9iKFtyZXN1bHQuZGF0YV0sIHsgdHlwZTogXCJpbWFnZS9qcGVnXCIgfSk7XHJcbiAgICAgICAgdmFyIGltYWdlVXJsID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XHJcbiAgICAgICAgdmFyIGltYWdlUmVzdWx0Vmlld2VyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJpbWdcIik7XHJcbiAgICAgICAgaW1hZ2VSZXN1bHRWaWV3ZXIuc3JjID0gaW1hZ2VVcmw7XHJcbiAgICAgICAgJHNjb3BlLnNob3dJbWFnZSA9IHRydWU7XHJcbiAgICAgICAgaW5zZXJ0SGVhZGVyc0ludG9SZXNwb25zZVZpZXdlcihyZXN1bHQuaGVhZGVycywgcmVzdWx0LnN0YXR1cyk7XHJcbiAgICAgICAgJHNjb3BlLnJlcXVlc3RJblByb2dyZXNzID0gZmFsc2U7XHJcbiAgICB9LCBoYW5kbGVVbnN1Y2Nlc3NmdWxRdWVyeVJlc3BvbnNlKTtcclxufVxyXG5mdW5jdGlvbiBoYW5kbGVIdG1sUmVzcG9uc2UoJHNjb3BlLCBzdGFydFRpbWUsIHJlc3VsdHMsIGhlYWRlcnMsIHN0YXR1cykge1xyXG4gICAgJHNjb3BlLnJlcXVlc3RJblByb2dyZXNzID0gZmFsc2U7XHJcbiAgICBzaG93UmVzdWx0cyhyZXN1bHRzLCBoZWFkZXJzLCBzdGF0dXMsIFwiaHRtbFwiKTtcclxufVxyXG5mdW5jdGlvbiBoYW5kbGVKc29uUmVzcG9uc2UoJHNjb3BlLCBzdGFydFRpbWUsIHJlc3VsdHMsIGhlYWRlcnMsIHN0YXR1cykge1xyXG4gICAgcmVzdWx0cyA9IEpTT04uc3RyaW5naWZ5KHJlc3VsdHMsIG51bGwsIDQpO1xyXG4gICAgJHNjb3BlLnJlcXVlc3RJblByb2dyZXNzID0gZmFsc2U7XHJcbiAgICBzaG93UmVzdWx0cyhyZXN1bHRzLCBoZWFkZXJzLCBzdGF0dXMsIFwianNvblwiKTtcclxufVxyXG5mdW5jdGlvbiBoYW5kbGVYbWxSZXNwb25zZSgkc2NvcGUsIHN0YXJ0VGltZSwgcmVzdWx0cywgaGVhZGVycywgc3RhdHVzKSB7XHJcbiAgICByZXN1bHRzID0gZm9ybWF0WG1sKHJlc3VsdHMpO1xyXG4gICAgJHNjb3BlLnJlcXVlc3RJblByb2dyZXNzID0gZmFsc2U7XHJcbiAgICBzaG93UmVzdWx0cyhyZXN1bHRzLCBoZWFkZXJzLCBzdGF0dXMsIFwieG1sXCIpO1xyXG59XHJcbmZ1bmN0aW9uIGlzSW1hZ2VSZXNwb25zZShoZWFkZXJzKSB7XHJcbiAgICB2YXIgY29udGVudFR5cGUgPSBnZXRDb250ZW50VHlwZShoZWFkZXJzKTtcclxuICAgIHJldHVybiBjb250ZW50VHlwZSA9PT0gXCJhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW1cIiB8fCBjb250ZW50VHlwZS5zdWJzdHIoMCwgNikgPT09IFwiaW1hZ2UvXCI7XHJcbn1cclxuZnVuY3Rpb24gaXNIdG1sUmVzcG9uc2UoaGVhZGVycykge1xyXG4gICAgdmFyIGNvbnRlbnRUeXBlID0gZ2V0Q29udGVudFR5cGUoaGVhZGVycyk7XHJcbiAgICByZXR1cm4gY29udGVudFR5cGUgPT09IFwidGV4dC9odG1sXCIgfHwgY29udGVudFR5cGUgPT09IFwiYXBwbGljYXRpb24veGh0bWwreG1sXCI7XHJcbn1cclxuZnVuY3Rpb24gaXNYbWxSZXNwb25zZShyZXN1bHRzKSB7XHJcbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkocmVzdWx0cywgbnVsbCwgNCkuaW5kZXhPZihcIjw/eG1sXCIpICE9IC0xO1xyXG59XHJcbmZ1bmN0aW9uIGlzSnNvblJlc3BvbnNlKGhlYWRlcnMpIHtcclxuICAgIHZhciBjb250ZW50VHlwZSA9IGdldENvbnRlbnRUeXBlKGhlYWRlcnMpO1xyXG4gICAgcmV0dXJuIGNvbnRlbnRUeXBlID09PSBcImFwcGxpY2F0aW9uL2pzb25cIjtcclxufVxyXG5mdW5jdGlvbiBnZXRDb250ZW50VHlwZShoZWFkZXJzKSB7XHJcbiAgICB2YXIgZnVsbCA9IGhlYWRlcnMoXCJjb250ZW50LXR5cGVcIik7XHJcbiAgICB2YXIgZGVsaW1pdGVyUG9zID0gZnVsbC5pbmRleE9mKFwiO1wiKTtcclxuICAgIGlmIChkZWxpbWl0ZXJQb3MgIT0gLTEpIHtcclxuICAgICAgICByZXR1cm4gZnVsbC5zdWJzdHIoMCwgZGVsaW1pdGVyUG9zKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBmdWxsO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGdldEVudGl0eVNldHMobWV0YWRhdGEpIHtcclxuICAgIHZhciBlbnRpdHlTZXRzT2JqID0ge307XHJcbiAgICB2YXIgZW50aXR5U2V0c0FuZFNpbmdsZXRvbnMgPSAkKCgkLnBhcnNlSFRNTChtZXRhZGF0YSkpWzFdKS5maW5kKFwiRW50aXR5Q29udGFpbmVyXCIpWzBdLmNoaWxkcmVuO1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbnRpdHlTZXRzQW5kU2luZ2xldG9ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHZhciBzZXQgPSBlbnRpdHlTZXRzQW5kU2luZ2xldG9uc1tpXTtcclxuICAgICAgICB2YXIgZW50aXR5U2V0T3JTaW5nbGV0b24gPSBudWxsO1xyXG4gICAgICAgIGlmIChzZXQudGFnTmFtZSA9PSBcIkVOVElUWVNFVFwiKSB7XHJcbiAgICAgICAgICAgIGVudGl0eVNldE9yU2luZ2xldG9uID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogc2V0LmdldEF0dHJpYnV0ZShcIm5hbWVcIiksXHJcbiAgICAgICAgICAgICAgICBpc0VudGl0eVNldDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIHR5cGU6IHNldC5nZXRBdHRyaWJ1dGUoXCJlbnRpdHl0eXBlXCIpLFxyXG4gICAgICAgICAgICAgICAgaXNBQ29sbGVjdGlvbjogdHJ1ZVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChzZXQudGFnTmFtZSA9PSBcIlNJTkdMRVRPTlwiKSB7XHJcbiAgICAgICAgICAgIGVudGl0eVNldE9yU2luZ2xldG9uID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogc2V0LmdldEF0dHJpYnV0ZShcIm5hbWVcIiksXHJcbiAgICAgICAgICAgICAgICBpc0VudGl0eVNldDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICB0eXBlOiBzZXQuZ2V0QXR0cmlidXRlKFwidHlwZVwiKSxcclxuICAgICAgICAgICAgICAgIGlzQUNvbGxlY3Rpb246IGZhbHNlXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRm91bmQgdW5leHBlY3RlZCB0eXBlIGluIG1ldGFkYXRhIHVuZGVyIEVudGl0eUNvbnRhaW5lclwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZW50aXR5U2V0c09ialtlbnRpdHlTZXRPclNpbmdsZXRvbi5uYW1lXSA9IGVudGl0eVNldE9yU2luZ2xldG9uO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGVudGl0eVNldHNPYmo7XHJcbn1cclxuZnVuY3Rpb24gZm9ybWF0UmVxdWVzdEhlYWRlcnMoaGVhZGVycykge1xyXG4gICAgdmFyIG9iaiA9IHt9O1xyXG4gICAgdmFyIHBhcnRzID0gaGVhZGVycy5yZXBsYWNlKC9eXFxzK3wsXFxzKiQvZywgJycpLnNwbGl0KCdcXG4nKTtcclxuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBwYXJ0cy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgIHZhciBtYXRjaCA9IHBhcnRzW2ldLm1hdGNoKC9eXFxzKlwiPyhbXlwiOl0qKVwiP1xccyo6XFxzKlwiPyhbXlwiXSopXFxzKiQvKTtcclxuICAgICAgICBpZiAobWF0Y2gpIHtcclxuICAgICAgICAgICAgb2JqW21hdGNoWzFdXSA9IG1hdGNoWzJdO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBvYmo7XHJcbn1cclxuZnVuY3Rpb24gY3JlYXRlRW50aXR5VHlwZU9iamVjdChET01hcnJheSkge1xyXG4gICAgdmFyIGVudGl0eVR5cGVzID0ge307XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IERPTWFycmF5Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdmFyIEVudGl0eVR5cGUgPSB7XHJcbiAgICAgICAgICAgIG5hbWU6IERPTWFycmF5W2ldLmdldEF0dHJpYnV0ZShcIm5hbWVcIiksXHJcbiAgICAgICAgICAgIGxpbmtzOiB7fVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGNoaWxkcmVuID0gRE9NYXJyYXlbaV0uY2hpbGRyZW47XHJcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBjaGlsZHJlbi5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICBpZiAoY2hpbGRyZW5bal0uYXR0cmlidXRlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGROYW1lID0gY2hpbGRyZW5bal0uZ2V0QXR0cmlidXRlKFwibmFtZVwiKTtcclxuICAgICAgICAgICAgICAgIHZhciB0eXBlID0gY2hpbGRyZW5bal0uZ2V0QXR0cmlidXRlKFwidHlwZVwiKTtcclxuICAgICAgICAgICAgICAgIHZhciB1cmxPYmplY3QgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXNBQ29sbGVjdGlvbjogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogY2hpbGROYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIGlzRW50aXR5U2V0OiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiB0eXBlXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGUuaW5kZXhPZihcIkNvbGxlY3Rpb24oXCIpID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB1cmxPYmplY3QuaXNBQ29sbGVjdGlvbiA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsT2JqZWN0LnR5cGUgPSB0eXBlLnNwbGl0KFwiKFwiKVsxXS5zcGxpdChcIilcIilbMF07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBFbnRpdHlUeXBlLmxpbmtzW2NoaWxkTmFtZV0gPSB1cmxPYmplY3Q7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZW50aXR5VHlwZXNbRW50aXR5VHlwZS5uYW1lXSA9IEVudGl0eVR5cGU7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZW50aXR5VHlwZXM7XHJcbn1cclxuZnVuY3Rpb24gc2hvd1JlcXVlc3RIZWFkZXJzKCRzY29wZSkge1xyXG4gICAgZ2V0SGVhZGVyc0VkaXRvcigpLmdldFNlc3Npb24oKS5zZXRWYWx1ZShcIlwiKTtcclxuICAgIHZhciByZXF1ZXN0SGVhZGVycyA9IFwiQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qc29uXCI7XHJcbiAgICBnZXRIZWFkZXJzRWRpdG9yKCkuZ2V0U2Vzc2lvbigpLmluc2VydCgwLCByZXF1ZXN0SGVhZGVycyk7XHJcbn1cclxuZnVuY3Rpb24gZ2V0RW50aXR5VHlwZXMobWV0YWRhdGEpIHtcclxuICAgIHZhciBlbnRpdGllcyA9IHt9O1xyXG4gICAgdmFyIGVudGl0eVR5cGVzID0gJCgoJC5wYXJzZUhUTUwobWV0YWRhdGEpKVsxXSkuZmluZChcIkVudGl0eVR5cGVcIik7XHJcbiAgICBqUXVlcnkuZXh0ZW5kKGVudGl0aWVzLCBjcmVhdGVFbnRpdHlUeXBlT2JqZWN0KGVudGl0eVR5cGVzKSk7XHJcbiAgICB2YXIgY29tcGxleFR5cGVzID0gJCgoJC5wYXJzZUhUTUwobWV0YWRhdGEpKVsxXSkuZmluZChcIkNvbXBsZXhUeXBlXCIpO1xyXG4gICAgalF1ZXJ5LmV4dGVuZChlbnRpdGllcywgY3JlYXRlRW50aXR5VHlwZU9iamVjdChjb21wbGV4VHlwZXMpKTtcclxuICAgIHJldHVybiBlbnRpdGllcztcclxufVxyXG5mdW5jdGlvbiBnZXRFbnRpdHlGcm9tVHlwZU5hbWUoc2VydmljZSwgdHlwZVBvc3NpYmx5V2l0aFByZWZpeCkge1xyXG4gICAgdmFyIGVudGl0eVR5cGVEYXRhID0gc2VydmljZS5jYWNoZS5nZXQoc2VydmljZS5zZWxlY3RlZFZlcnNpb24gKyBcIkVudGl0eVR5cGVEYXRhXCIpO1xyXG4gICAgdmFyIHR5cGUgPSB0eXBlUG9zc2libHlXaXRoUHJlZml4LnNwbGl0KFwibWljcm9zb2Z0LmdyYXBoLlwiKS5wb3AoKTtcclxuICAgIHJldHVybiBlbnRpdHlUeXBlRGF0YVt0eXBlXTtcclxufVxyXG5mdW5jdGlvbiBjb25zdHJ1Y3RHcmFwaExpbmtzRnJvbVNlcnZpY2VQYXRoKHNlcnZpY2UpIHtcclxuICAgIHZhciB1cmxQYXRoQXJyID0gc2VydmljZS50ZXh0LnNwbGl0KFwiaHR0cHM6Ly9ncmFwaC5taWNyb3NvZnQuY29tL1wiKTtcclxuICAgIGlmICh1cmxQYXRoQXJyLmxlbmd0aCA8PSAxKVxyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgIHZhciBzZWdtZW50cyA9IHVybFBhdGhBcnJbMV0uc3BsaXQoXCIvXCIpO1xyXG4gICAgdmFyIHZlcnNpb24gPSBzZWdtZW50cy5zaGlmdCgpO1xyXG4gICAgdmFyIGdyYXBoID0gW107XHJcbiAgICB2YXIgZW50aXR5Q29udGFpbmVyRGF0YSA9IHNlcnZpY2UuY2FjaGUuZ2V0KHNlcnZpY2Uuc2VsZWN0ZWRWZXJzaW9uICsgXCJFbnRpdHlTZXREYXRhXCIpO1xyXG4gICAgaWYgKGVudGl0eUNvbnRhaW5lckRhdGEgPT09IHVuZGVmaW5lZClcclxuICAgICAgICByZXR1cm4gW107XHJcbiAgICB3aGlsZSAoc2VnbWVudHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHZhciBzZWdtZW50ID0gc2VnbWVudHMuc2hpZnQoKTtcclxuICAgICAgICBpZiAoZ3JhcGgubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgaWYgKHNlZ21lbnQgaW4gZW50aXR5Q29udGFpbmVyRGF0YSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG5vZGUgPSBlbnRpdHlDb250YWluZXJEYXRhW3NlZ21lbnRdO1xyXG4gICAgICAgICAgICAgICAgZ3JhcGgucHVzaChub2RlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIGxhc3RHcmFwaEl0ZW0gPSBncmFwaFtncmFwaC5sZW5ndGggLSAxXTtcclxuICAgICAgICAgICAgdmFyIGxhc3RHcmFwaEl0ZW1FbnRpdHkgPSBnZXRFbnRpdHlGcm9tVHlwZU5hbWUoc2VydmljZSwgbGFzdEdyYXBoSXRlbS50eXBlKTtcclxuICAgICAgICAgICAgaWYgKGxhc3RHcmFwaEl0ZW1FbnRpdHkgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGxhc3RHcmFwaEl0ZW1FbnRpdHkubGlua3MgIT09IHVuZGVmaW5lZCAmJiBzZWdtZW50IGluIGxhc3RHcmFwaEl0ZW1FbnRpdHkubGlua3MpIHtcclxuICAgICAgICAgICAgICAgIGdyYXBoLnB1c2gobGFzdEdyYXBoSXRlbUVudGl0eS5saW5rc1tzZWdtZW50XSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAobGFzdEdyYXBoSXRlbS5pc0FDb2xsZWN0aW9uICYmIHNlZ21lbnQgIT0gXCJcIikge1xyXG4gICAgICAgICAgICAgICAgZ3JhcGgucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgaXNBQ29sbGVjdGlvbjogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgaXNFbnRpdHlTZXQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHNlZ21lbnQsXHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogbGFzdEdyYXBoSXRlbS50eXBlXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBncmFwaDtcclxufVxyXG5mdW5jdGlvbiBjb21iaW5lVXJsT3B0aW9uc1dpdGhDdXJyZW50VXJsKHNlcnZpY2UsIHVybE9wdGlvbnMpIHtcclxuICAgIHZhciBncmFwaEZyb21TZXJ2aWNlVXJsID0gY29uc3RydWN0R3JhcGhMaW5rc0Zyb21TZXJ2aWNlUGF0aChzZXJ2aWNlKTtcclxuICAgIHZhciBiYXNlVXJsID0gW107XHJcbiAgICB3aGlsZSAoZ3JhcGhGcm9tU2VydmljZVVybC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgdmFyIGxhc3RTZWdtZW50ID0gZ3JhcGhGcm9tU2VydmljZVVybC5zaGlmdCgpO1xyXG4gICAgICAgIGJhc2VVcmwucHVzaChsYXN0U2VnbWVudC5uYW1lKTtcclxuICAgIH1cclxuICAgIHZhciBiYXNlVXJsRmluYWwgPSBcImh0dHBzOi8vZ3JhcGgubWljcm9zb2Z0LmNvbS9cIiArIHNlcnZpY2Uuc2VsZWN0ZWRWZXJzaW9uO1xyXG4gICAgaWYgKGJhc2VVcmwubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGJhc2VVcmxGaW5hbCArPSBcIi9cIiArIGJhc2VVcmwuam9pbignLycpO1xyXG4gICAgfVxyXG4gICAgdmFyIGF1dG9jb21wbGV0ZVVybHMgPSBbXTtcclxuICAgIGZvciAodmFyIHVybEF1dG9Db21wbGV0ZVN1ZmZpeCBpbiB1cmxPcHRpb25zKSB7XHJcbiAgICAgICAgYXV0b2NvbXBsZXRlVXJscy5wdXNoKGJhc2VVcmxGaW5hbCArICcvJyArIHVybE9wdGlvbnNbdXJsQXV0b0NvbXBsZXRlU3VmZml4XSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXV0b2NvbXBsZXRlVXJscztcclxufVxyXG5mdW5jdGlvbiBnZXRVcmxzRnJvbVNlcnZpY2VVUkwoc2VydmljZSkge1xyXG4gICAgdmFyIGdyYXBoRnJvbVNlcnZpY2VVcmwgPSBjb25zdHJ1Y3RHcmFwaExpbmtzRnJvbVNlcnZpY2VQYXRoKHNlcnZpY2UpO1xyXG4gICAgaWYgKGdyYXBoRnJvbVNlcnZpY2VVcmwubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHZhciBsYXN0Tm9kZSA9IGdyYXBoRnJvbVNlcnZpY2VVcmwucG9wKCk7XHJcbiAgICAgICAgaWYgKGxhc3ROb2RlLmlzQUNvbGxlY3Rpb24pXHJcbiAgICAgICAgICAgIHJldHVybiBbXTtcclxuICAgICAgICB2YXIgZW50aXR5ID0gZ2V0RW50aXR5RnJvbVR5cGVOYW1lKHNlcnZpY2UsIGxhc3ROb2RlLnR5cGUpO1xyXG4gICAgICAgIGlmICghZW50aXR5KVxyXG4gICAgICAgICAgICByZXR1cm4gW107XHJcbiAgICAgICAgcmV0dXJuIGNvbWJpbmVVcmxPcHRpb25zV2l0aEN1cnJlbnRVcmwoc2VydmljZSwgT2JqZWN0LmtleXMoZW50aXR5LmxpbmtzKSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICB2YXIgZW50aXR5Q29udGFpbmVyRGF0YSA9IHNlcnZpY2UuY2FjaGUuZ2V0KHNlcnZpY2Uuc2VsZWN0ZWRWZXJzaW9uICsgXCJFbnRpdHlTZXREYXRhXCIpO1xyXG4gICAgICAgIGlmIChlbnRpdHlDb250YWluZXJEYXRhID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY29tYmluZVVybE9wdGlvbnNXaXRoQ3VycmVudFVybChzZXJ2aWNlLCBPYmplY3Qua2V5cyhlbnRpdHlDb250YWluZXJEYXRhKSk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gc2hvd1JlcXVlc3RCb2R5RWRpdG9yKCkge1xyXG4gICAgcy50YWJDb25maWcuZGlzYWJsZVJlcXVlc3RCb2R5RWRpdG9yID0gZmFsc2U7XHJcbiAgICBzLnRhYkNvbmZpZy5oaWRlQ29udGVudCA9IGZhbHNlO1xyXG4gICAgc2hvd1JlcXVlc3RIZWFkZXJzKHMpO1xyXG4gICAgJChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaW5pdGlhbGl6ZUpzb25FZGl0b3IoKTtcclxuICAgICAgICBzZXRTZWxlY3RlZFRhYigxKTtcclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIHNldFNlbGVjdGVkVGFiKG51bSkge1xyXG4gICAgaWYgKG51bSA+PSAyIHx8IG51bSA8IDApIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBzLnRhYkNvbmZpZy5zZWxlY3RlZCA9IG51bTtcclxuICAgIHMudGFiQ29uZmlnLnByZXZpb3VzU2VsZWN0ZWQgPSBzLnRhYkNvbmZpZy5zZWxlY3RlZDtcclxufVxyXG5mdW5jdGlvbiBoYW5kbGVRdWVyeVN0cmluZyhzZXJ2aWNlLCBhY3Rpb25WYWx1ZSwgdmVyc2lvblZhbHVlLCByZXF1ZXN0VmFsdWUpIHtcclxuICAgIGlmIChhY3Rpb25WYWx1ZSkge1xyXG4gICAgICAgIHNlcnZpY2Uuc2VsZWN0ZWRPcHRpb24gPSBhY3Rpb25WYWx1ZS50b1VwcGVyQ2FzZSgpO1xyXG4gICAgICAgIGlmIChzZXJ2aWNlLnNlbGVjdGVkT3B0aW9uID09PSAnUE9TVCcgfHwgc2VydmljZS5zZWxlY3RlZE9wdGlvbiA9PT0gJ1BBVENIJykge1xyXG4gICAgICAgICAgICBpZiAoaGVsbG8oJ21zZnQnKS5nZXRBdXRoUmVzcG9uc2UoKSAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgc2hvd1JlcXVlc3RCb2R5RWRpdG9yKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKHZlcnNpb25WYWx1ZSkge1xyXG4gICAgICAgIHNlcnZpY2Uuc2VsZWN0ZWRWZXJzaW9uID0gdmVyc2lvblZhbHVlO1xyXG4gICAgfVxyXG4gICAgaWYgKHJlcXVlc3RWYWx1ZSkge1xyXG4gICAgICAgIHNlcnZpY2UudGV4dCA9IFwiaHR0cHM6Ly9ncmFwaC5taWNyb3NvZnQuY29tL1wiICsgc2VydmljZS5zZWxlY3RlZFZlcnNpb24gKyBcIi9cIiArIHJlcXVlc3RWYWx1ZTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBnZXRVcmxzRnJvbUVudGl0eVR5cGUoc2VydmljZSwgZW50aXR5KSB7XHJcbiAgICB2YXIgZW50aXR5VHlwZXMgPSBzZXJ2aWNlLmNhY2hlLmdldChzZXJ2aWNlLnNlbGVjdGVkVmVyc2lvbiArIFwiRW50aXR5VHlwZURhdGFcIik7XHJcbiAgICB2YXIgdHlwZSA9IGVudGl0eVR5cGVzW2VudGl0eS5uYW1lXTtcclxuICAgIHJldHVybiBjb21iaW5lVXJsT3B0aW9uc1dpdGhDdXJyZW50VXJsKHNlcnZpY2UsIE9iamVjdC5rZXlzKHR5cGUubGlua3MpKTtcclxufVxyXG5mdW5jdGlvbiBwYXJzZU1ldGFkYXRhKHNlcnZpY2UpIHtcclxuICAgIHZhciBlbnRpdHlTZXREYXRhLCBlbnRpdHlUeXBlRGF0YTtcclxuICAgIGlmICghc2VydmljZS5jYWNoZS5nZXQoc2VydmljZS5zZWxlY3RlZFZlcnNpb24gKyBcIk1ldGFkYXRhXCIpKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJwYXJzaW5nIG1ldGFkYXRhXCIpO1xyXG4gICAgICAgIHNlcnZpY2UuZ2V0TWV0YWRhdGEoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHRzKSB7XHJcbiAgICAgICAgICAgIHZhciBtZXRhZGF0YSA9IHJlc3VsdHMuZGF0YTtcclxuICAgICAgICAgICAgc2VydmljZS5jYWNoZS5wdXQoc2VydmljZS5zZWxlY3RlZFZlcnNpb24gKyBcIk1ldGFkYXRhXCIsIHJlc3VsdHMpO1xyXG4gICAgICAgICAgICBlbnRpdHlTZXREYXRhID0gZ2V0RW50aXR5U2V0cyhtZXRhZGF0YSk7XHJcbiAgICAgICAgICAgIHNlcnZpY2UuY2FjaGUucHV0KHNlcnZpY2Uuc2VsZWN0ZWRWZXJzaW9uICsgXCJFbnRpdHlTZXREYXRhXCIsIGVudGl0eVNldERhdGEpO1xyXG4gICAgICAgICAgICBlbnRpdHlUeXBlRGF0YSA9IGdldEVudGl0eVR5cGVzKG1ldGFkYXRhKTtcclxuICAgICAgICAgICAgc2VydmljZS5jYWNoZS5wdXQoc2VydmljZS5zZWxlY3RlZFZlcnNpb24gKyBcIkVudGl0eVR5cGVEYXRhXCIsIGVudGl0eVR5cGVEYXRhKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJtZXRhZGF0YSBzdWNjZXNzZnVsbHkgcGFyc2VkXCIpO1xyXG4gICAgICAgIH0sIGZ1bmN0aW9uIChlcnIsIHN0YXR1cykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwibWV0YWRhdGEgY291bGQgbm90IGJlIHBhcnNlZFwiKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcGktZXhwbG9yZXItaGVscGVycy5qcy5tYXAiLCIvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiAgQWxsIFJpZ2h0cyBSZXNlcnZlZC4gIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gIFNlZSBMaWNlbnNlIGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ0FwaUV4cGxvcmVyJylcclxuLmNvbmZpZyhmdW5jdGlvbigkbG9jYXRpb25Qcm92aWRlcikge1xyXG4gICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHtcclxuICAgICAgICBlbmFibGVkOiB0cnVlLFxyXG4gICAgICAgIHJlcXVpcmVCYXNlOiBmYWxzZSxcclxuICAgICAgICByZXdyaXRlTGlua3M6IGZhbHNlXHJcbiAgICB9KTtcclxuICAgIFxyXG59KVxyXG4uZmFjdG9yeSgnQXBpRXhwbG9yZXJTdmMnLCBbZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGFwaUV4cGxvcmVyU2VydmljZSA9IHt9O1xyXG4gICAgcmV0dXJuIGFwaUV4cGxvcmVyU2VydmljZTtcclxufV0pOyIsIi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uICBBbGwgUmlnaHRzIFJlc2VydmVkLiAgTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiAgU2VlIExpY2Vuc2UgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4ndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnQXBpRXhwbG9yZXInKVxyXG4gICAgLmZhY3RvcnkoJ0FwaUV4cGxvcmVyU3ZjJywgWyckaHR0cCcsICckY2FjaGVGYWN0b3J5JywgZnVuY3Rpb24gKCRodHRwLCAkY2FjaGVGYWN0b3J5KSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgdGV4dDogJ2h0dHBzOi8vZ3JhcGgubWljcm9zb2Z0LmNvbS92MS4wL21lLycsXHJcblxyXG4gICAgICAgICAgICBzZWxlY3RlZFZlcnNpb246IFwidjEuMFwiLFxyXG5cclxuICAgICAgICAgICAgc2VsZWN0ZWRPcHRpb246IFwiR0VUXCIsXHJcblxyXG4gICAgICAgICAgICBjYWNoZTogJGNhY2hlRmFjdG9yeSgnbXlDYWNoZScpLFxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcGVyZm9ybUFub255bW91c1F1ZXJ5OiBmdW5jdGlvbiAocXVlcnlUeXBlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHF1ZXJ5LCBwb3N0U3RyaW5nLCByZXF1ZXN0SGVhZGVycykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBoZWFkZXJzT2JqID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkF1dGhvcml6YXRpb25cIjogXCJCZWFyZXIge3Rva2VuOmh0dHBzOi8vZ3JhcGgubWljcm9zb2Z0LmNvbS99XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiQWNjZXB0XCI6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcXVlc3RIZWFkZXJzICYmIHJlcXVlc3RIZWFkZXJzW1wiQXV0aG9yaXphdGlvblwiXSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnNPYmpbXCJBdXRob3JpemF0aW9uXCJdID0gcmVxdWVzdEhlYWRlcnNbXCJBdXRob3JpemF0aW9uXCJdO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcXVlc3RIZWFkZXJzICYmIHJlcXVlc3RIZWFkZXJzW1wiQWNjZXB0XCJdKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyc09ialtcIkFjY2VwdFwiXSA9IHJlcXVlc3RIZWFkZXJzW1wiQWNjZXB0XCJdO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcXVlc3QgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJ2h0dHBzOi8vcHJveHkuYXBpc2FuZGJveC5tc2RuLm1pY3Jvc29mdC5jb20vc3ZjP3VybD0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHF1ZXJ5KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogaGVhZGVyc09ialxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHF1ZXJ5VHlwZSA9PSBcIkdFVF9CSU5BUllcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0W1wicmVzcG9uc2VUeXBlXCJdID0gXCJhcnJheWJ1ZmZlclwiO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHF1ZXJ5VHlwZSA9PSBcIkdFVF9CSU5BUllcIiB8fCBxdWVyeVR5cGUgPT0gXCJHRVRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJGh0dHAocmVxdWVzdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIHBlcmZvcm1RdWVyeTogZnVuY3Rpb24gKHF1ZXJ5VHlwZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChxdWVyeSwgcG9zdFN0cmluZywgcmVxdWVzdEhlYWRlcnMpIHtcclxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2gocXVlcnlUeXBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJHRVRcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQocXVlcnksIHtoZWFkZXJzIDogcmVxdWVzdEhlYWRlcnN9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIkdFVF9CSU5BUllcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQocXVlcnksIHtyZXNwb25zZVR5cGU6XCJhcnJheWJ1ZmZlclwifSwge2hlYWRlcnMgOiByZXF1ZXN0SGVhZGVyc30pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiUE9TVFwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QocXVlcnksIHBvc3RTdHJpbmcsIHtoZWFkZXJzIDogcmVxdWVzdEhlYWRlcnN9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlBBVENIXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJGh0dHAucGF0Y2gocXVlcnksIHBvc3RTdHJpbmcsIHtoZWFkZXJzIDogcmVxdWVzdEhlYWRlcnN9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIkRFTEVURVwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRodHRwLmRlbGV0ZShxdWVyeSwge2hlYWRlcnMgOiByZXF1ZXN0SGVhZGVyc30pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBnZXRNZXRhZGF0YTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wZXJmb3JtQW5vbnltb3VzUXVlcnkoXCJHRVRcIikoXCJodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20vXCIgKyB0aGlzLnNlbGVjdGVkVmVyc2lvbiArIFwiLyRtZXRhZGF0YVwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1dKTsiLCJ2YXIgcztcclxudmFyIEdyYXBoQmFzZVVybCA9IFwiaHR0cHM6Ly9ncmFwaC5taWNyb3NvZnQuY29tL1wiO1xyXG52YXIgR3JhcGhWZXJzaW9ucyA9IFsnYmV0YScsICd2MS4wJ107XHJcbmFuZ3VsYXIubW9kdWxlKCdBcGlFeHBsb3JlcicpXHJcbiAgICAuY29udHJvbGxlcignQXBpRXhwbG9yZXJDdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCAnJGxvY2F0aW9uJywgJ0FwaUV4cGxvcmVyU3ZjJywgJyR0aW1lb3V0JywgJyR0ZW1wbGF0ZUNhY2hlJywgJyRtZERpYWxvZycsICckc2NlJywgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsICRsb2NhdGlvbiwgYXBpU2VydmljZSwgJHRpbWVvdXQsICR0ZW1wbGF0ZUNhY2hlLCAkbWREaWFsb2csICRzY2UpIHtcclxuICAgICAgICBzID0gJHNjb3BlO1xyXG4gICAgICAgICRzY29wZS51c2VySW5mbyA9IHt9O1xyXG4gICAgICAgICRzY29wZS5nZXRBc3NldFBhdGggPSBmdW5jdGlvbiAocmVsUGF0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gcy5wYXRoVG9CdWlsZERpciArIFwiL1wiICsgcmVsUGF0aDtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5maW5pc2hBZG1pbkNvbnNlcnRGbG93ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBoZWxsbygnbXNmdF90b2tlbl9yZWZyZXNoJykubG9naW4oe1xyXG4gICAgICAgICAgICAgICAgZGlzcGxheTogJ3BvcHVwJyxcclxuICAgICAgICAgICAgICAgIHJlc3BvbnNlX3R5cGU6IFwidG9rZW5cIixcclxuICAgICAgICAgICAgICAgIHJlZGlyZWN0X3VyaTogJHNjb3BlLnJlZGlyZWN0VXJsLFxyXG4gICAgICAgICAgICAgICAgc2NvcGU6ICRzY29wZS5zY29wZXMgKyBcIiBcIiArICRzY29wZS5hZG1pblNjb3BlcyxcclxuICAgICAgICAgICAgICAgIHJlc3BvbnNlX21vZGU6ICdmcmFnbWVudCcsXHJcbiAgICAgICAgICAgICAgICBwcm9tcHQ6ICdub25lJyxcclxuICAgICAgICAgICAgICAgIGRvbWFpbl9oaW50OiAnb3JnYW5pemF0aW9ucycsXHJcbiAgICAgICAgICAgICAgICBsb2dpbl9oaW50OiAkc2NvcGUudXNlckluZm8ucHJlZmVycmVkX3VzZXJuYW1lXHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXMuYXV0aFJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFjY2Vzc1Rva2VuID0gcmVzLmF1dGhSZXNwb25zZS5hY2Nlc3NfdG9rZW47XHJcbiAgICAgICAgICAgICAgICAgICAgJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJyArIGFjY2Vzc1Rva2VuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKHJlcyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgaGVsbG8ub24oJ2F1dGgubG9naW4nLCBmdW5jdGlvbiAoYXV0aCkge1xyXG4gICAgICAgICAgICB2YXIgYWNjZXNzVG9rZW47XHJcbiAgICAgICAgICAgIGlmIChhdXRoLm5ldHdvcmsgPT0gXCJtc2Z0X3Rva2VuX3JlZnJlc2hcIikge1xyXG4gICAgICAgICAgICAgICAgYWNjZXNzVG9rZW4gPSBoZWxsbygnbXNmdF90b2tlbl9yZWZyZXNoJykuZ2V0QXV0aFJlc3BvbnNlKCkuYWNjZXNzX3Rva2VuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGF1dGgubmV0d29yayA9PSBcIm1zZnRcIikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGF1dGhSZXNwb25zZSA9IGhlbGxvKCdtc2Z0JykuZ2V0QXV0aFJlc3BvbnNlKCk7XHJcbiAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbiA9IGF1dGhSZXNwb25zZS5hY2Nlc3NfdG9rZW47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGFjY2Vzc1Rva2VuKSB7XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnQXV0aG9yaXphdGlvbiddID0gJ0JlYXJlciAnICsgYWNjZXNzVG9rZW47XHJcbiAgICAgICAgICAgICAgICBhcGlTZXJ2aWNlLnBlcmZvcm1RdWVyeShcIkdFVFwiKShcImh0dHBzOi8vZ3JhcGgubWljcm9zb2Z0LmNvbS92MS4wL21lXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHRCb2R5ID0gcmVzdWx0LmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnVzZXJJbmZvID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmVmZXJyZWRfdXNlcm5hbWU6IHJlc3VsdEJvZHkubWFpbFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihyZXMpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAkc2NvcGUudGFiQ29uZmlnID0ge1xyXG4gICAgICAgICAgICBkaXNhYmxlUmVxdWVzdEJvZHlFZGl0b3I6IHRydWUsXHJcbiAgICAgICAgICAgIGhpZGVDb250ZW50OiB0cnVlLFxyXG4gICAgICAgICAgICBzZWxlY3RlZDogMFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLnNob3dJbWFnZSA9IGZhbHNlO1xyXG4gICAgICAgICRzY29wZS50YWJDb25maWcucHJldmlvdXNTZWxlY3RlZCA9ICRzY29wZS50YWJDb25maWcuc2VsZWN0ZWQ7XHJcbiAgICAgICAgJHNjb3BlLnByb2Nlc3NUYWJDbGljayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHN3aXRjaGluZ1RhYnMgPSAkc2NvcGUudGFiQ29uZmlnLnByZXZpb3VzU2VsZWN0ZWQgIT0gJHNjb3BlLnRhYkNvbmZpZy5zZWxlY3RlZDtcclxuICAgICAgICAgICAgaWYgKCFzd2l0Y2hpbmdUYWJzKVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnRhYkNvbmZpZy5oaWRlQ29udGVudCA9ICEkc2NvcGUudGFiQ29uZmlnLmhpZGVDb250ZW50O1xyXG4gICAgICAgICAgICAkc2NvcGUudGFiQ29uZmlnLnByZXZpb3VzU2VsZWN0ZWQgPSAkc2NvcGUudGFiQ29uZmlnLnNlbGVjdGVkO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIHJlcXVlc3RWYWwgPSAkbG9jYXRpb24uc2VhcmNoKCkucmVxdWVzdDtcclxuICAgICAgICB2YXIgYWN0aW9uVmFsID0gJGxvY2F0aW9uLnNlYXJjaCgpLm1ldGhvZDtcclxuICAgICAgICB2YXIgYm9keVZhbCA9ICRsb2NhdGlvbi5zZWFyY2goKS5ib2R5O1xyXG4gICAgICAgIHZhciB2ZXJzaW9uVmFsID0gJGxvY2F0aW9uLnNlYXJjaCgpLnZlcnNpb247XHJcbiAgICAgICAgdmFyIGhlYWRlcnNWYWwgPSAkbG9jYXRpb24uc2VhcmNoKCkuaGVhZGVycztcclxuICAgICAgICBoYW5kbGVRdWVyeVN0cmluZyhhcGlTZXJ2aWNlLCBhY3Rpb25WYWwsIHZlcnNpb25WYWwsIHJlcXVlc3RWYWwpO1xyXG4gICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaW5pdGlhbGl6ZUhlYWRlcnNFZGl0b3IoaGVhZGVyc1ZhbCk7XHJcbiAgICAgICAgICAgIGluaXRpYWxpemVKc29uVmlld2VyKCRzY29wZSwgYXBpU2VydmljZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcGFyc2VNZXRhZGF0YShhcGlTZXJ2aWNlKTtcclxuICAgICAgICAkc2NvcGUuaXNBdXRoZW50aWNhdGVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgc2Vzc2lvbiA9IGhlbGxvKCdtc2Z0JykuZ2V0QXV0aFJlc3BvbnNlKCk7XHJcbiAgICAgICAgICAgIGlmIChzZXNzaW9uID09PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB2YXIgY3VycmVudFRpbWUgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpIC8gMTAwMDtcclxuICAgICAgICAgICAgcmV0dXJuIHNlc3Npb24gJiYgc2Vzc2lvbi5hY2Nlc3NfdG9rZW4gJiYgc2Vzc2lvbi5leHBpcmVzID4gY3VycmVudFRpbWU7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuJHdhdGNoKFwiZ2V0RWRpdG9yKClcIiwgZnVuY3Rpb24gKGV2ZW50LCBhcmdzKSB7XHJcbiAgICAgICAgICAgIGluaXRpYWxpemVKc29uRWRpdG9yKGJvZHlWYWwpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaGVsbG8oJ21zZnQnKS5sb2dpbih7XHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiAncGFnZScsXHJcbiAgICAgICAgICAgICAgICByZXNwb25zZV90eXBlOiBcImlkX3Rva2VuIHRva2VuXCIsXHJcbiAgICAgICAgICAgICAgICBub25jZTogJ2dyYXBoX2V4cGxvcmVyJyxcclxuICAgICAgICAgICAgICAgIHByb21wdDogJ3NlbGVjdF9hY2NvdW50JyxcclxuICAgICAgICAgICAgICAgIG1zYWZlZDogMFxyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ2Vycm9yIHNpZ25pbmcgaW4nKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUubG9nb3V0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBhcGlTZXJ2aWNlLnNlbGVjdGVkT3B0aW9uID0gXCJHRVRcIjtcclxuICAgICAgICAgICAgJHNjb3BlLnRhYkNvbmZpZy5kaXNhYmxlUmVxdWVzdEJvZHlFZGl0b3IgPSB0cnVlO1xyXG4gICAgICAgICAgICBzZXRTZWxlY3RlZFRhYigwKTtcclxuICAgICAgICAgICAgaGVsbG8oJ21zZnQnKS5sb2dvdXQobnVsbCwgeyBmb3JjZTogdHJ1ZSB9KTtcclxuICAgICAgICAgICAgZGVsZXRlICRzY29wZS51c2VySW5mbztcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5nZXRTZWFyY2hUZXh0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYXBpU2VydmljZS50ZXh0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmdldEN1cnJlbnRFbnRpdHlOYW1lID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoIWFwaVNlcnZpY2UudGV4dClcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB2YXIgdHh0ID0gYXBpU2VydmljZS50ZXh0O1xyXG4gICAgICAgICAgICB2YXIgcGF0aEFyciA9IHR4dC5zcGxpdChcIi9cIikuZmlsdGVyKChmdW5jdGlvbiAoYSkgeyByZXR1cm4gYS5sZW5ndGggPiAwOyB9KSk7XHJcbiAgICAgICAgICAgIHJldHVybiBwYXRoQXJyLnBvcCgpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNhbkluc2VydFRlbXBsYXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYXBpU2VydmljZS5zZWxlY3RlZE9wdGlvbiA9PSBcIlBPU1RcIiAmJiBjaGVja0Nhbkluc2VydFRlbXBsYXRlKGFwaVNlcnZpY2UudGV4dCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuaW5zZXJ0UG9zdFRlbXBsYXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgZW50aXR5ID0gJHNjb3BlLmdldEN1cnJlbnRFbnRpdHlOYW1lKCk7XHJcbiAgICAgICAgICAgIHZhciBzdHJUb0luc2VydCA9IEpTT04uc3RyaW5naWZ5KHBvc3RUZW1wbGF0ZXNbZW50aXR5XSwgbnVsbCwgMikudHJpbSgpO1xyXG4gICAgICAgICAgICB2YXIgZnVsbFVzZXJFbWFpbCA9ICRzY29wZS51c2VySW5mby5wcmVmZXJyZWRfdXNlcm5hbWU7XHJcbiAgICAgICAgICAgIHZhciBkb21haW4gPSBmdWxsVXNlckVtYWlsLnNwbGl0KFwiQFwiKVsxXTtcclxuICAgICAgICAgICAgc3RyVG9JbnNlcnQgPSBzdHJUb0luc2VydC5yZXBsYWNlKC9BVVRIRU5USUNBVEVEX0RPTUFJTi9nLCBkb21haW4pO1xyXG4gICAgICAgICAgICBzdHJUb0luc2VydCA9IHN0clRvSW5zZXJ0LnJlcGxhY2UoL0ZVTExfVVNFUl9FTUFJTC9nLCBmdWxsVXNlckVtYWlsKTtcclxuICAgICAgICAgICAgaW5pdGlhbGl6ZUpzb25FZGl0b3Ioc3RyVG9JbnNlcnQpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgZnVuY3Rpb24gY2hlY2tDYW5JbnNlcnRUZW1wbGF0ZShVUkwpIHtcclxuICAgICAgICAgICAgcztcclxuICAgICAgICAgICAgdmFyIGVudGl0eSA9ICRzY29wZS5nZXRDdXJyZW50RW50aXR5TmFtZSgpO1xyXG4gICAgICAgICAgICB2YXIgY2FuSW5zZXJ0VGVtcGxhdGUgPSBlbnRpdHkgaW4gcG9zdFRlbXBsYXRlcztcclxuICAgICAgICAgICAgcmV0dXJuIGNhbkluc2VydFRlbXBsYXRlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAkc2NvcGUuc2hvd1NoYXJlRGlhbG9nID0gZnVuY3Rpb24gKGV2KSB7XHJcbiAgICAgICAgICAgICRtZERpYWxvZy5zaG93KHtcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IFNoYXJlRGlhbG9nQ29udHJvbGxlcixcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiBwYXRoVG9CdWlsZERpciArICcvYXNzZXRzL3ZpZXdzL3NoYXJlRGlhbG9nLnRtcGwuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBwYXJlbnQ6IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSxcclxuICAgICAgICAgICAgICAgIHRhcmdldEV2ZW50OiBldixcclxuICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBzY29wZTogJHNjb3BlLiRuZXcoKSxcclxuICAgICAgICAgICAgICAgIGxvY2Fsczoge1xyXG4gICAgICAgICAgICAgICAgICAgIGFwaVNlcnZpY2U6IGFwaVNlcnZpY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgJHNjZTogJHNjZSxcclxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiBmb3JtYXRSZXF1ZXN0SGVhZGVycyhnZXRIZWFkZXJzRWRpdG9yKCkuZ2V0U2Vzc2lvbigpLmdldFZhbHVlKCkpLFxyXG4gICAgICAgICAgICAgICAgICAgIGJvZHk6IGdldEpzb25WaWV3ZXIoKS5nZXRTZXNzaW9uKCkuZ2V0VmFsdWUoKVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChhbnN3ZXIpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5zdGF0dXMgPSAnWW91IHNhaWQgdGhlIGluZm9ybWF0aW9uIHdhcyBcIicgKyBhbnN3ZXIgKyAnXCIuJztcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0YXR1cyA9ICdZb3UgY2FuY2VsbGVkIHRoZSBkaWFsb2cuJztcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgIH1dKTtcclxuYW5ndWxhci5tb2R1bGUoJ0FwaUV4cGxvcmVyJylcclxuICAgIC5jb250cm9sbGVyKCdEcm9wZG93bkN0cmwnLCBbJyRzY29wZScsICdBcGlFeHBsb3JlclN2YycsIGZ1bmN0aW9uICgkc2NvcGUsIGFwaVNlcnZpY2UpIHtcclxuICAgICAgICAkc2NvcGUub25JdGVtQ2xpY2sgPSBmdW5jdGlvbiAoY2hvaWNlKSB7XHJcbiAgICAgICAgICAgIGlmIChjaG9pY2UgIT0gYXBpU2VydmljZS5zZWxlY3RlZE9wdGlvbikge1xyXG4gICAgICAgICAgICAgICAgYXBpU2VydmljZS5zZWxlY3RlZE9wdGlvbiA9IGNob2ljZTtcclxuICAgICAgICAgICAgICAgIGFwaVNlcnZpY2UudGV4dCA9IGFwaVNlcnZpY2UudGV4dC5yZXBsYWNlKC9odHRwczpcXC9cXC9ncmFwaC5taWNyb3NvZnQuY29tKCR8XFwvKFtcXHddfFxcLikqKCR8XFwvKSkvLCAoXCJodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20vXCIgKyBhcGlTZXJ2aWNlLnNlbGVjdGVkVmVyc2lvbiArIFwiL1wiKSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2hvaWNlID09ICdQT1NUJyB8fCBjaG9pY2UgPT0gJ1BBVENIJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHNob3dSZXF1ZXN0Qm9keUVkaXRvcigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY2hvaWNlID09ICdHRVQnIHx8IGNob2ljZSA9PSAnREVMRVRFJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHMudGFiQ29uZmlnLmRpc2FibGVSZXF1ZXN0Qm9keUVkaXRvciA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0U2VsZWN0ZWRUYWIoMCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5pdGVtcyA9IFtcclxuICAgICAgICAgICAgJ0dFVCcsXHJcbiAgICAgICAgICAgICdQT1NUJyxcclxuICAgICAgICAgICAgJ1BBVENIJyxcclxuICAgICAgICAgICAgJ0RFTEVURSdcclxuICAgICAgICBdO1xyXG4gICAgICAgICRzY29wZS5nZXRTZXJ2aWNlT3B0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYXBpU2VydmljZS5zZWxlY3RlZE9wdGlvbjtcclxuICAgICAgICB9O1xyXG4gICAgfV0pO1xyXG5hbmd1bGFyLm1vZHVsZSgnQXBpRXhwbG9yZXInKVxyXG4gICAgLmNvbnRyb2xsZXIoJ1ZlcnNpb25DdHJsJywgWyckc2NvcGUnLCAnQXBpRXhwbG9yZXJTdmMnLCBmdW5jdGlvbiAoJHNjb3BlLCBhcGlTZXJ2aWNlKSB7XHJcbiAgICAgICAgJHNjb3BlLml0ZW1zID0gR3JhcGhWZXJzaW9ucztcclxuICAgICAgICAkc2NvcGUuZ2V0U2VydmljZVZlcnNpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhcGlTZXJ2aWNlLnNlbGVjdGVkVmVyc2lvbjtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5vbkl0ZW1DbGljayA9IGZ1bmN0aW9uIChjaG9pY2UpIHtcclxuICAgICAgICAgICAgaWYgKGFwaVNlcnZpY2Uuc2VsZWN0ZWRWZXJzaW9uICE9PSBjaG9pY2UpIHtcclxuICAgICAgICAgICAgICAgIGFwaVNlcnZpY2Uuc2VsZWN0ZWRWZXJzaW9uID0gY2hvaWNlO1xyXG4gICAgICAgICAgICAgICAgYXBpU2VydmljZS50ZXh0ID0gYXBpU2VydmljZS50ZXh0LnJlcGxhY2UoL2h0dHBzOlxcL1xcL2dyYXBoLm1pY3Jvc29mdC5jb20oJHxcXC8oW1xcd118XFwuKSooJHxcXC8pKS8sIChcImh0dHBzOi8vZ3JhcGgubWljcm9zb2Z0LmNvbS9cIiArIGFwaVNlcnZpY2Uuc2VsZWN0ZWRWZXJzaW9uICsgXCIvXCIpKTtcclxuICAgICAgICAgICAgICAgICRzY29wZS4kcGFyZW50LiRicm9hZGNhc3QoJ3VwZGF0ZVVybEZyb21TZXJ2aWNlVGV4dCcpO1xyXG4gICAgICAgICAgICAgICAgcGFyc2VNZXRhZGF0YShhcGlTZXJ2aWNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XSk7XHJcbmFuZ3VsYXIubW9kdWxlKCdBcGlFeHBsb3JlcicpLmNvbnRyb2xsZXIoJ2RhdGFsaXN0Q3RybCcsIFsnJHNjb3BlJywgJ0FwaUV4cGxvcmVyU3ZjJywgZnVuY3Rpb24gKCRzY29wZSwgYXBpU2VydmljZSkge1xyXG4gICAgICAgICRzY29wZS5zZWFyY2hUZXh0Q2hhbmdlID0gZnVuY3Rpb24gKHNlYXJjaFRleHQpIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBzZWFyY2hUZXh0ID09PSAndW5kZWZpbmVkJylcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgYXBpU2VydmljZS50ZXh0ID0gc2VhcmNoVGV4dDtcclxuICAgICAgICAgICAgdmFyIGdyYXBoUGF0aFN0YXJ0aW5nV2l0aFZlcnNpb24gPSBzZWFyY2hUZXh0LnNwbGl0KEdyYXBoQmFzZVVybCk7XHJcbiAgICAgICAgICAgIGlmIChncmFwaFBhdGhTdGFydGluZ1dpdGhWZXJzaW9uLmxlbmd0aCA8IDIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgcG9zc2libGVHcmFwaFBhdGhBcnIgPSBncmFwaFBhdGhTdGFydGluZ1dpdGhWZXJzaW9uWzFdLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgICAgIGlmIChwb3NzaWJsZUdyYXBoUGF0aEFyci5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBwb3NzaWJsZVZlcnNpb24gPSBwb3NzaWJsZUdyYXBoUGF0aEFyclswXTtcclxuICAgICAgICAgICAgaWYgKEdyYXBoVmVyc2lvbnMuaW5kZXhPZihwb3NzaWJsZVZlcnNpb24pICE9IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBhcGlTZXJ2aWNlLnNlbGVjdGVkVmVyc2lvbiA9IHBvc3NpYmxlVmVyc2lvbjtcclxuICAgICAgICAgICAgICAgIHBhcnNlTWV0YWRhdGEoYXBpU2VydmljZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5nZXRSZXF1ZXN0SGlzdG9yeSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3RIaXN0b3J5O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLiRvbigndXBkYXRlVXJsRnJvbVNlcnZpY2VUZXh0JywgZnVuY3Rpb24gKGV2ZW50LCBkYXRhKSB7XHJcbiAgICAgICAgICAgICRzY29wZS50ZXh0ID0gYXBpU2VydmljZS50ZXh0O1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICRzY29wZS5zZWFyY2hUZXh0Q2hhbmdlKGFwaVNlcnZpY2UudGV4dCk7XHJcbiAgICAgICAgJHNjb3BlLnNlYXJjaFRleHQgPSBhcGlTZXJ2aWNlLnRleHQ7XHJcbiAgICAgICAgJHNjb3BlLmdldE1hdGNoZXMgPSBmdW5jdGlvbiAocXVlcnkpIHtcclxuICAgICAgICAgICAgdmFyIHVybHMgPSBnZXRVcmxzRnJvbVNlcnZpY2VVUkwoYXBpU2VydmljZSk7XHJcbiAgICAgICAgICAgIHJldHVybiB1cmxzLmZpbHRlcihmdW5jdGlvbiAob3B0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcXVlcnlJbk9wdGlvbiA9IChvcHRpb24uaW5kZXhPZihxdWVyeSkgPiAtMSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcXVlcnlJbk9wdGlvbjtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBpZiAod2luZG93WydydW5UZXN0cyddKVxyXG4gICAgICAgICAgICBydW5BdXRvQ29tcGxldGVUZXN0cyhhcGlTZXJ2aWNlKTtcclxuICAgIH1dKTtcclxuYW5ndWxhci5tb2R1bGUoJ0FwaUV4cGxvcmVyJykuY29udHJvbGxlcignRm9ybUN0cmwnLCBbJyRzY29wZScsICdBcGlFeHBsb3JlclN2YycsIGZ1bmN0aW9uICgkc2NvcGUsIGFwaVNlcnZpY2UpIHtcclxuICAgICAgICAkc2NvcGUucmVxdWVzdEluUHJvZ3Jlc3MgPSBmYWxzZTtcclxuICAgICAgICAkc2NvcGUuaW5zdWZmaWNpZW50UHJpdmlsZWdlcyA9IGZhbHNlO1xyXG4gICAgICAgIGlmIChoZWxsbygnbXNmdCcpLmdldEF1dGhSZXNwb25zZSgpICE9IG51bGwgJiZcclxuICAgICAgICAgICAgKGFwaVNlcnZpY2Uuc2VsZWN0ZWRPcHRpb24gPT09ICdQT1NUJyB8fCBhcGlTZXJ2aWNlLnNlbGVjdGVkT3B0aW9uID09PSAnUEFUQ0gnKSkge1xyXG4gICAgICAgICAgICBzaG93UmVxdWVzdEJvZHlFZGl0b3IoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHNldFNlbGVjdGVkVGFiKDApO1xyXG4gICAgICAgIH1cclxuICAgICAgICAkc2NvcGUuJHBhcmVudC4kb24oXCJ1cmxDaGFuZ2VcIiwgZnVuY3Rpb24gKGV2ZW50LCBhcmdzKSB7XHJcbiAgICAgICAgICAgIG1zR3JhcGhMaW5rUmVzb2x1dGlvbigkc2NvcGUsIGdldEpzb25WaWV3ZXIoKS5nZXRTZXNzaW9uKCkuZ2V0VmFsdWUoKSwgYXJncywgYXBpU2VydmljZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJHNjb3BlLmhpc3RvcnlPbkNsaWNrID0gZnVuY3Rpb24gKGhpc3RvcnlJdGVtKSB7XHJcbiAgICAgICAgICAgIGFwaVNlcnZpY2UudGV4dCA9IGhpc3RvcnlJdGVtLnVybFRleHQ7XHJcbiAgICAgICAgICAgICRzY29wZS4kYnJvYWRjYXN0KCd1cGRhdGVVcmxGcm9tU2VydmljZVRleHQnKTtcclxuICAgICAgICAgICAgYXBpU2VydmljZS5zZWxlY3RlZFZlcnNpb24gPSBoaXN0b3J5SXRlbS5zZWxlY3RlZFZlcnNpb247XHJcbiAgICAgICAgICAgIGFwaVNlcnZpY2Uuc2VsZWN0ZWRPcHRpb24gPSBoaXN0b3J5SXRlbS5odG1sT3B0aW9uO1xyXG4gICAgICAgICAgICBwYXJzZU1ldGFkYXRhKGFwaVNlcnZpY2UpO1xyXG4gICAgICAgICAgICBpZiAoaGlzdG9yeUl0ZW0uaHRtbE9wdGlvbiA9PSAnUE9TVCcgfHwgaGlzdG9yeUl0ZW0uaHRtbE9wdGlvbiA9PSAnUEFUQ0gnKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZ2V0SnNvblZpZXdlcigpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0SnNvblZpZXdlcigpLmdldFNlc3Npb24oKS5zZXRWYWx1ZShoaXN0b3J5SXRlbS5qc29uSW5wdXQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcImpzb24gZWRpdG9yIHdhdGNoIGV2ZW50IG5vdCBmaXJpbmdcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZ2V0SnNvblZpZXdlcigpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0SnNvblZpZXdlcigpLmdldFNlc3Npb24oKS5zZXRWYWx1ZShcIlwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAkc2NvcGUuc3VibWl0KCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2xvc2VBZG1pbkNvbnNlbnRCYXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5pbnN1ZmZpY2llbnRQcml2aWxlZ2VzID0gZmFsc2U7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuZ2V0QWRtaW5Db25zZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBoZWxsbygnbXNmdF9hZG1pbl9jb25zZW50JykubG9naW4oe1xyXG4gICAgICAgICAgICAgICAgZGlzcGxheTogJ3BvcHVwJ1xyXG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5maW5pc2hBZG1pbkNvbnNlcnRGbG93KCk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5maW5pc2hBZG1pbkNvbnNlcnRGbG93KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLnN1Ym1pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHNjb3BlLnJlcXVlc3RJblByb2dyZXNzID0gdHJ1ZTtcclxuICAgICAgICAgICAgdmFyIGhpc3RvcnlPYmogPSB7XHJcbiAgICAgICAgICAgICAgICB1cmxUZXh0OiBhcGlTZXJ2aWNlLnRleHQsXHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZFZlcnNpb246IGFwaVNlcnZpY2Uuc2VsZWN0ZWRWZXJzaW9uLFxyXG4gICAgICAgICAgICAgICAgaHRtbE9wdGlvbjogYXBpU2VydmljZS5zZWxlY3RlZE9wdGlvbixcclxuICAgICAgICAgICAgICAgIGpzb25JbnB1dDogbnVsbFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBpZiAoaGlzdG9yeU9iai5odG1sT3B0aW9uID09ICdQT1NUJyB8fCBoaXN0b3J5T2JqLmh0bWxPcHRpb24gPT0gJ1BBVENIJykge1xyXG4gICAgICAgICAgICAgICAgaGlzdG9yeU9iai5qc29uSW5wdXQgPSBnZXRSZXF1ZXN0Qm9keUVkaXRvcigpLmdldFNlc3Npb24oKS5nZXRWYWx1ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICRzY29wZS5zaG93SW1hZ2UgPSBmYWxzZTtcclxuICAgICAgICAgICAgdmFyIHBvc3RCb2R5O1xyXG4gICAgICAgICAgICBpZiAoZ2V0UmVxdWVzdEJvZHlFZGl0b3IoKSAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHBvc3RCb2R5ID0gZ2V0UmVxdWVzdEJvZHlFZGl0b3IoKS5nZXRTZXNzaW9uKCkuZ2V0VmFsdWUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgcmVxdWVzdEhlYWRlcnMgPSBcIlwiO1xyXG4gICAgICAgICAgICBpZiAoZ2V0SGVhZGVyc0VkaXRvcigpICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcmVxdWVzdEhlYWRlcnMgPSBnZXRIZWFkZXJzRWRpdG9yKCkuZ2V0U2Vzc2lvbigpLmdldFZhbHVlKCk7XHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0SGVhZGVycyA9IGZvcm1hdFJlcXVlc3RIZWFkZXJzKHJlcXVlc3RIZWFkZXJzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgc3RhcnRUaW1lID0gbmV3IERhdGUoKTtcclxuICAgICAgICAgICAgZnVuY3Rpb24gaGFuZGxlU3VjY2Vzc2Z1bFF1ZXJ5UmVzcG9uc2UocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc3RhdHVzID0gcmVzdWx0LnN0YXR1cztcclxuICAgICAgICAgICAgICAgIHZhciBoZWFkZXJzID0gcmVzdWx0LmhlYWRlcnM7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0Qm9keSA9IHJlc3VsdC5kYXRhO1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzSW1hZ2VSZXNwb25zZShoZWFkZXJzKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZUltYWdlUmVzcG9uc2UoJHNjb3BlLCBhcGlTZXJ2aWNlLCBzdGFydFRpbWUsIGhlYWRlcnMsIHN0YXR1cywgaGFuZGxlVW5zdWNjZXNzZnVsUXVlcnlSZXNwb25zZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChpc0h0bWxSZXNwb25zZShoZWFkZXJzKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZUh0bWxSZXNwb25zZSgkc2NvcGUsIHN0YXJ0VGltZSwgcmVzdWx0Qm9keSwgaGVhZGVycywgc3RhdHVzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGlzWG1sUmVzcG9uc2UocmVzdWx0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZVhtbFJlc3BvbnNlKCRzY29wZSwgc3RhcnRUaW1lLCByZXN1bHRCb2R5LCBoZWFkZXJzLCBzdGF0dXMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlSnNvblJlc3BvbnNlKCRzY29wZSwgc3RhcnRUaW1lLCByZXN1bHRCb2R5LCBoZWFkZXJzLCBzdGF0dXMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaGlzdG9yeU9iai5kdXJhdGlvbiA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCkgLSBzdGFydFRpbWUuZ2V0VGltZSgpO1xyXG4gICAgICAgICAgICAgICAgc2F2ZUhpc3RvcnlPYmplY3QoaGlzdG9yeU9iaiwgc3RhdHVzKTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5pbnN1ZmZpY2llbnRQcml2aWxlZ2VzID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZnVuY3Rpb24gaGFuZGxlVW5zdWNjZXNzZnVsUXVlcnlSZXNwb25zZShyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzdGF0dXMgPSByZXN1bHQuc3RhdHVzO1xyXG4gICAgICAgICAgICAgICAgdmFyIGhlYWRlcnMgPSByZXN1bHQuaGVhZGVycztcclxuICAgICAgICAgICAgICAgIGhhbmRsZUpzb25SZXNwb25zZSgkc2NvcGUsIHN0YXJ0VGltZSwgcmVzdWx0LmRhdGEsIGhlYWRlcnMsIHN0YXR1cyk7XHJcbiAgICAgICAgICAgICAgICBoaXN0b3J5T2JqLmR1cmF0aW9uID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKSAtIHN0YXJ0VGltZS5nZXRUaW1lKCk7XHJcbiAgICAgICAgICAgICAgICBzYXZlSGlzdG9yeU9iamVjdChoaXN0b3J5T2JqLCBzdGF0dXMpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHN0YXR1cyA9PT0gNDAxIHx8IHN0YXR1cyA9PT0gNDAzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmluc3VmZmljaWVudFByaXZpbGVnZXMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUuaXNBdXRoZW50aWNhdGVkKCkpIHtcclxuICAgICAgICAgICAgICAgIGFwaVNlcnZpY2UucGVyZm9ybVF1ZXJ5KGFwaVNlcnZpY2Uuc2VsZWN0ZWRPcHRpb24pKGFwaVNlcnZpY2UudGV4dCwgcG9zdEJvZHksIHJlcXVlc3RIZWFkZXJzKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGhhbmRsZVN1Y2Nlc3NmdWxRdWVyeVJlc3BvbnNlLCBoYW5kbGVVbnN1Y2Nlc3NmdWxRdWVyeVJlc3BvbnNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGFwaVNlcnZpY2UucGVyZm9ybUFub255bW91c1F1ZXJ5KGFwaVNlcnZpY2Uuc2VsZWN0ZWRPcHRpb24pKGFwaVNlcnZpY2UudGV4dCwgcG9zdEJvZHksIHJlcXVlc3RIZWFkZXJzKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGhhbmRsZVN1Y2Nlc3NmdWxRdWVyeVJlc3BvbnNlLCBoYW5kbGVVbnN1Y2Nlc3NmdWxRdWVyeVJlc3BvbnNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XSk7XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwaS1leHBsb3Jlci1jdHJsLmpzLm1hcCIsInZhciBzY3JpcHRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzY3JpcHRcIik7XHJcbnZhciBzcmMgPSBzY3JpcHRzW3NjcmlwdHMubGVuZ3RoIC0gMV0uc3JjO1xyXG52YXIgcGF0aFRvQnVpbGREaXIgPSBzcmMuc3BsaXQoJy8nKS5zbGljZSgwLCAtMikuam9pbignLycpO1xyXG5hbmd1bGFyLm1vZHVsZSgnQXBpRXhwbG9yZXInKVxyXG4gICAgLmNvbmZpZyhmdW5jdGlvbiAoJHNjZURlbGVnYXRlUHJvdmlkZXIsICRodHRwUHJvdmlkZXIpIHtcclxuICAgICRzY2VEZWxlZ2F0ZVByb3ZpZGVyLnJlc291cmNlVXJsV2hpdGVsaXN0KFtcclxuICAgICAgICAnc2VsZicsXHJcbiAgICAgICAgcGF0aFRvQnVpbGREaXIgKyAnLyoqJ1xyXG4gICAgXSk7XHJcbiAgICAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLnVzZVhEb21haW4gPSB0cnVlO1xyXG4gICAgZGVsZXRlICRodHRwUHJvdmlkZXIuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtUmVxdWVzdGVkLVdpdGgnXTtcclxufSlcclxuICAgIC5kaXJlY3RpdmUoJ2FwaUV4cGxvcmVyJywgZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBzY29wZToge1xyXG4gICAgICAgICAgICBzdHJpbmdzOiAnPScsXHJcbiAgICAgICAgICAgIGxhbmd1YWdlOiAnPScsXHJcbiAgICAgICAgICAgIHNjb3BlczogJz0nLFxyXG4gICAgICAgICAgICBhZG1pblNjb3BlczogJz0nLFxyXG4gICAgICAgICAgICBjbGllbnRJZDogJz0nLFxyXG4gICAgICAgICAgICByZWRpcmVjdFVybDogJz0nXHJcbiAgICAgICAgfSxcclxuICAgICAgICB0ZW1wbGF0ZVVybDogcGF0aFRvQnVpbGREaXIgKyAnL2Fzc2V0cy92aWV3cy9leHBsb3Jlci5odG1sJyxcclxuICAgICAgICBjb250cm9sbGVyOiBmdW5jdGlvbiAoJHNjb3BlKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5wYXRoVG9CdWlsZERpciA9IHBhdGhUb0J1aWxkRGlyO1xyXG4gICAgICAgICAgICAkc2NvcGUuc3RyID0gbG9jX3N0cmluZ3NbJ2VuX3VzJ107XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUubGFuZ3VhZ2UpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5zdHIgPSBsb2Nfc3RyaW5nc1skc2NvcGUubGFuZ3VhZ2VdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKCRzY29wZS5zdHIsICRzY29wZS5zdHJpbmdzKTtcclxuICAgICAgICAgICAgaGVsbG8uaW5pdCh7XHJcbiAgICAgICAgICAgICAgICBtc2Z0OiAkc2NvcGUuY2xpZW50SWRcclxuICAgICAgICAgICAgfSwge1xyXG4gICAgICAgICAgICAgICAgc2NvcGU6ICRzY29wZS5zY29wZXMsXHJcbiAgICAgICAgICAgICAgICByZWRpcmVjdF91cmk6IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaGVsbG8uaW5pdCh7XHJcbiAgICAgICAgICAgICAgICBtc2Z0X2FkbWluX2NvbnNlbnQ6ICRzY29wZS5jbGllbnRJZCxcclxuICAgICAgICAgICAgICAgIG1zZnRfdG9rZW5fcmVmcmVzaDogJHNjb3BlLmNsaWVudElkLFxyXG4gICAgICAgICAgICB9LCB7XHJcbiAgICAgICAgICAgICAgICByZWRpcmVjdF91cmk6IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59KTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBpLWV4cGxvcmVyLWRpcmVjdGl2ZS5qcy5tYXAiLCJmdW5jdGlvbiBnZXRSZXF1ZXN0Qm9keUVkaXRvcigpIHtcclxuICAgIHZhciByZXF1ZXN0Qm9keUVkaXRvckVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImpzb25FZGl0b3JcIik7XHJcbiAgICByZXR1cm4gYWNlLmVkaXQocmVxdWVzdEJvZHlFZGl0b3JFbGVtZW50KTtcclxufVxyXG5mdW5jdGlvbiBnZXRIZWFkZXJzRWRpdG9yKCkge1xyXG4gICAgdmFyIHJlcXVlc3RIZWFkZXJFZGl0b3JFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJqc29uRWRpdG9ySGVhZGVyc1wiKTtcclxuICAgIHJldHVybiBhY2UuZWRpdChyZXF1ZXN0SGVhZGVyRWRpdG9yRWxlbWVudCk7XHJcbn1cclxuZnVuY3Rpb24gZ2V0SnNvblZpZXdlcigpIHtcclxuICAgIHZhciBqc29uVmlld2VyRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwianNvblZpZXdlclwiKTtcclxuICAgIHJldHVybiBhY2UuZWRpdChqc29uVmlld2VyRWxlbWVudCk7XHJcbn1cclxuZnVuY3Rpb24gaW5pdGlhbGl6ZUpzb25FZGl0b3IoYm9keVZhbCkge1xyXG4gICAgdmFyIGVkaXRvciA9IGdldFJlcXVlc3RCb2R5RWRpdG9yKCk7XHJcbiAgICBjb21tb25BY2VTZXR1cChlZGl0b3IpO1xyXG4gICAgZWRpdG9yLmdldFNlc3Npb24oKS5zZXRNb2RlKFwiYWNlL21vZGUvamF2YXNjcmlwdFwiKTtcclxuICAgIGlmIChib2R5VmFsKSB7XHJcbiAgICAgICAgZWRpdG9yLmdldFNlc3Npb24oKS5pbnNlcnQoeyByb3c6IDAsIGNvbHVtbjogMCB9LCBib2R5VmFsKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBpbml0aWFsaXplSGVhZGVyc0VkaXRvcihoZWFkZXJzVmFsKSB7XHJcbiAgICB2YXIgZWRpdG9yID0gZ2V0SGVhZGVyc0VkaXRvcigpO1xyXG4gICAgY29tbW9uQWNlU2V0dXAoZWRpdG9yKTtcclxuICAgIGlmIChoZWFkZXJzVmFsKSB7XHJcbiAgICAgICAgZWRpdG9yLmdldFNlc3Npb24oKS5pbnNlcnQoMCwgaGVhZGVyc1ZhbCk7XHJcbiAgICB9XHJcbiAgICBlZGl0b3IubW92ZUN1cnNvclRvKDEsIDApO1xyXG59XHJcbmZ1bmN0aW9uIGNvbW1vbkFjZVNldHVwKGVkaXRvcikge1xyXG4gICAgZWRpdG9yLnNldFNob3dQcmludE1hcmdpbihmYWxzZSk7XHJcbiAgICBlZGl0b3IuJGJsb2NrU2Nyb2xsaW5nID0gSW5maW5pdHk7XHJcbiAgICBlZGl0b3IucmVuZGVyZXIuc2V0T3B0aW9uKCdzaG93TGluZU51bWJlcnMnLCBmYWxzZSk7XHJcbiAgICBlZGl0b3IuY29tbWFuZHMuYmluZEtleShcIlRhYlwiLCBudWxsKTtcclxufVxyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcGktZXhwbG9yZXItanNlZGl0b3IuanMubWFwIiwiZnVuY3Rpb24gZW5kc1dpdGhTbGFzaChzZXJ2aWNlVGV4dCkge1xyXG4gICAgcmV0dXJuIHNlcnZpY2VUZXh0LmNoYXJBdChzZXJ2aWNlVGV4dC5sZW5ndGggLSAxKSA9PSAnLyc7XHJcbn1cclxuZnVuY3Rpb24gbXNHcmFwaExpbmtSZXNvbHV0aW9uKCRzY29wZSwgYm9keSwgYXJncywgc2VydmljZSkge1xyXG4gICAgaWYgKGFyZ3MuaW5kZXhPZihcImh0dHBzOi8vXCIpID09IC0xKSB7XHJcbiAgICAgICAgaWYgKHNlcnZpY2UudGV4dC5pbmRleE9mKGFyZ3Muc3Vic3RyKDEpKSAhPSAtMSkge1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChzZXJ2aWNlLnRleHQuaW5kZXhPZihcIi9tZVwiKSAhPSAtMSAmJiBzZXJ2aWNlLnRleHQuaW5kZXhPZihcIi9tZS9cIikgPT0gLTEgJiYgc2VydmljZS50ZXh0LmluZGV4T2YoXCIvbWVtYmVyT2ZcIikgPT0gLTEpIHtcclxuICAgICAgICAgICAgc2VydmljZS50ZXh0ID0gc2VydmljZS50ZXh0LnJlcGxhY2UoXCIvbWVcIiwgXCJcIikgKyBcIi91c2Vycy9cIiArIGFyZ3Muc3Vic3RyKDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIGluZGV4ID0gYm9keS5pbmRleE9mKGFyZ3Muc3Vic3RyKDEpKTtcclxuICAgICAgICAgICAgdmFyIHR5cGVJbmRleCA9IGJvZHkubGFzdEluZGV4T2YoJ0BvZGF0YS50eXBlJywgaW5kZXgpO1xyXG4gICAgICAgICAgICBpZiAodHlwZUluZGV4ICE9IC0xKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdHlwZUluZGV4RW5kID0gYm9keS5pbmRleE9mKFwiXFxuXCIsIHR5cGVJbmRleCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdHlwZSA9IGJvZHkuc3Vic3RyKHR5cGVJbmRleCwgdHlwZUluZGV4RW5kIC0gdHlwZUluZGV4KTtcclxuICAgICAgICAgICAgICAgIHR5cGUgPSB0eXBlLnJlcGxhY2UoXCJAb2RhdGEudHlwZVxcXCI6IFxcXCIjbWljcm9zb2Z0LmdyYXBoLlwiLCBcIlwiKTtcclxuICAgICAgICAgICAgICAgIHR5cGUgPSB0eXBlLnJlcGxhY2UoXCJcXFwiXCIsIFwiXCIpLnJlcGxhY2UoXCIsXCIsIFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgc2VydmljZS50ZXh0ID0gXCJodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20vdjEuMC9cIiArIHR5cGUgKyBcInMvXCIgKyBhcmdzLnN1YnN0cigxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChzZXJ2aWNlLnRleHQuaW5kZXhPZihcIj9cIikgIT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlLnRleHQgPSBzZXJ2aWNlLnRleHQuc3Vic3RyKDAsIHNlcnZpY2UudGV4dC5pbmRleE9mKFwiP1wiKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgbGlua1VybCA9IFtzZXJ2aWNlLnRleHQsIGFyZ3Muc3Vic3RyKDEpXTtcclxuICAgICAgICAgICAgICAgIGlmIChlbmRzV2l0aFNsYXNoKHNlcnZpY2UudGV4dCkpXHJcbiAgICAgICAgICAgICAgICAgICAgc2VydmljZS50ZXh0ID0gbGlua1VybC5qb2luKFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIHNlcnZpY2UudGV4dCA9IGxpbmtVcmwuam9pbihcIi9cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBzZXJ2aWNlLnRleHQgPSBhcmdzLnJlcGxhY2UoXCJcXFwiXCIsIFwiXCIpO1xyXG4gICAgfVxyXG4gICAgaWYgKHNlcnZpY2UudGV4dCAmJiBlbmRzV2l0aFNsYXNoKHNlcnZpY2UudGV4dCkpIHtcclxuICAgICAgICBzZXJ2aWNlLnRleHQgKz0gJy8nO1xyXG4gICAgfVxyXG4gICAgJHNjb3BlLiRicm9hZGNhc3QoJ3VwZGF0ZVVybEZyb21TZXJ2aWNlVGV4dCcpO1xyXG4gICAgJHNjb3BlLnN1Ym1pdCgpO1xyXG59XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwaS1leHBsb3Jlci1tc2dyYXBoLmpzLm1hcCIsImhlbGxvLmluaXQoe1xyXG4gICAgbXNmdDoge1xyXG4gICAgICAgIG9hdXRoOiB7XHJcbiAgICAgICAgICAgIHZlcnNpb246IDIsXHJcbiAgICAgICAgICAgIGF1dGg6ICdodHRwczovL2xvZ2luLm1pY3Jvc29mdG9ubGluZS5jb20vb3JnYW5pemF0aW9ucy9vYXV0aDIvdjIuMC9hdXRob3JpemUnLFxyXG4gICAgICAgICAgICBncmFudDogJ2h0dHBzOi8vbG9naW4ubWljcm9zb2Z0b25saW5lLmNvbS9vcmdhbml6YXRpb25zL29hdXRoMi92Mi4wL3Rva2VuJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2NvcGVfZGVsaW06ICcgJyxcclxuICAgICAgICBmb3JtOiBmYWxzZVxyXG4gICAgfSwgbXNmdF9hZG1pbl9jb25zZW50OiB7XHJcbiAgICAgICAgb2F1dGg6IHtcclxuICAgICAgICAgICAgdmVyc2lvbjogMixcclxuICAgICAgICAgICAgYXV0aDogJ2h0dHBzOi8vbG9naW4ubWljcm9zb2Z0b25saW5lLmNvbS9jb21tb24vYWRtaW5jb25zZW50JyxcclxuICAgICAgICAgICAgZ3JhbnQ6ICdodHRwczovL2xvZ2luLm1pY3Jvc29mdG9ubGluZS5jb20vY29tbW9uL29hdXRoMi92Mi4wL3Rva2VuJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2NvcGVfZGVsaW06ICcgJyxcclxuICAgICAgICBmb3JtOiBmYWxzZVxyXG4gICAgfSwgbXNmdF90b2tlbl9yZWZyZXNoOiB7XHJcbiAgICAgICAgb2F1dGg6IHtcclxuICAgICAgICAgICAgdmVyc2lvbjogMixcclxuICAgICAgICAgICAgYXV0aDogJ2h0dHBzOi8vbG9naW4ubWljcm9zb2Z0b25saW5lLmNvbS9jb21tb24vb2F1dGgyL3YyLjAvYXV0aG9yaXplJyxcclxuICAgICAgICAgICAgZ3JhbnQ6ICdodHRwczovL2xvZ2luLm1pY3Jvc29mdG9ubGluZS5jb20vY29tbW9uL29hdXRoMi92Mi4wL3Rva2VuJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2NvcGVfZGVsaW06ICcgJyxcclxuICAgICAgICBmb3JtOiBmYWxzZVxyXG4gICAgfVxyXG59KTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXV0aC5qcy5tYXAiLCJmdW5jdGlvbiBjcmVhdGVTaGFyZUxpbmsoZnVsbFJlcXVlc3RVcmwsIGFjdGlvbiwgdmVyc2lvbikge1xyXG4gICAgcmV0dXJuIHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4gKyB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgKyBcIj9yZXF1ZXN0PVwiICsgZXh0cmFjdEdyYXBoRW5kcG9pbnQoZnVsbFJlcXVlc3RVcmwpICsgXCImbWV0aG9kPVwiICsgYWN0aW9uICsgXCImdmVyc2lvbj1cIiArIHZlcnNpb247XHJcbn1cclxuZnVuY3Rpb24gZXh0cmFjdEdyYXBoRW5kcG9pbnQoZnVsbFJlcXVlc3RVcmwpIHtcclxuICAgIHZhciByZXF1ZXN0VXJsID0gZnVsbFJlcXVlc3RVcmwuc3BsaXQoJy5jb20nKTtcclxuICAgIHJlcXVlc3RVcmwuc2hpZnQoKTtcclxuICAgIHZhciByZXF1ZXN0VXJsQ29tcG9uZW50cyA9IHJlcXVlc3RVcmxbMF0uc3BsaXQoJy8nKTtcclxuICAgIHJlcXVlc3RVcmxDb21wb25lbnRzLnNoaWZ0KCk7XHJcbiAgICByZXF1ZXN0VXJsQ29tcG9uZW50cy5zaGlmdCgpO1xyXG4gICAgcmV0dXJuIChyZXF1ZXN0VXJsQ29tcG9uZW50cy5qb2luKCcvJykpO1xyXG59XHJcbmZ1bmN0aW9uIGlzUG9zdE9yUGF0Y2gob3B0aW9uKSB7XHJcbiAgICByZXR1cm4gb3B0aW9uID09IFwiUE9TVFwiIHx8IG9wdGlvbiA9PSBcIlBBVENIXCI7XHJcbn1cclxuZnVuY3Rpb24gU2hhcmVEaWFsb2dDb250cm9sbGVyKCRzY29wZSwgJG1kRGlhbG9nLCBhcGlTZXJ2aWNlLCAkc2NlLCBoZWFkZXJzLCBib2R5KSB7XHJcbiAgICB2YXIgX2FwaVNlcnZpY2UgPSBhcGlTZXJ2aWNlO1xyXG4gICAgJHNjb3BlLmhpZGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcclxuICAgIH07XHJcbiAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcclxuICAgIH07XHJcbiAgICAkc2NvcGUuZ2V0U2hhcmVMaW5rID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciByZXF1ZXN0VXJsID0gJHNjb3BlLmdldFNlYXJjaFRleHQoKTtcclxuICAgICAgICByZXR1cm4gY3JlYXRlU2hhcmVMaW5rKHJlcXVlc3RVcmwsIF9hcGlTZXJ2aWNlLnNlbGVjdGVkT3B0aW9uLCBfYXBpU2VydmljZS5zZWxlY3RlZFZlcnNpb24pO1xyXG4gICAgfTtcclxuICAgICRzY29wZS5nZW5lcmF0ZVN1cGVyQWdlbnRDb2RlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciByZXF1ZXN0VXJsID0gJHNjb3BlLmdldFNlYXJjaFRleHQoKTtcclxuICAgICAgICB2YXIgZnVsbEdyYXBoVXJsID0gXCJodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20vXCIgKyBfYXBpU2VydmljZS5zZWxlY3RlZFZlcnNpb24gKyBcIi9cIiArIGV4dHJhY3RHcmFwaEVuZHBvaW50KHJlcXVlc3RVcmwpO1xyXG4gICAgICAgIHZhciB0YWIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBcIjxzcGFuIHN0eWxlPSdwYWRkaW5nLWxlZnQ6MTVweCc+PC9zcGFuPlwiO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGxpbmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBcIjxicj5cIjtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBzdHIgPSBcInJlcXVlc3RcIjtcclxuICAgICAgICBzdHIgKz0gbGluZSgpICsgdGFiKCkgKyBcIi5cIiArIF9hcGlTZXJ2aWNlLnNlbGVjdGVkT3B0aW9uLnRvTG9jYWxlTG93ZXJDYXNlKCkgKyBcIihcXFwiXCIgKyBmdWxsR3JhcGhVcmwgKyBcIlxcXCIpXCI7XHJcbiAgICAgICAgaWYgKE9iamVjdC5rZXlzKGhlYWRlcnMpLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgc3RyICs9IGxpbmUoKSArIHRhYigpICsgXCIuc2V0KFwiICsgSlNPTi5zdHJpbmdpZnkoaGVhZGVycykgKyBcIilcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGlzUG9zdE9yUGF0Y2goX2FwaVNlcnZpY2Uuc2VsZWN0ZWRPcHRpb24pKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYm9keU9iaiA9IEpTT04ucGFyc2UoYm9keSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoYm9keU9iaikge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0ciArPSBsaW5lKCkgKyB0YWIoKSArIFwiLnNlbmQoXCIgKyBKU09OLnN0cmluZ2lmeShib2R5T2JqKSArIFwiKVwiO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgc3RyICs9IGxpbmUoKSArIHRhYigpICsgXCIuZW5kKGZ1bmN0aW9uKGVyciwgcmVzKSB7XCI7XHJcbiAgICAgICAgc3RyICs9IGxpbmUoKSArIHRhYigpICsgdGFiKCkgKyBcImNvbnNvbGUubG9nKHJlcyk7XCI7XHJcbiAgICAgICAgc3RyICs9IGxpbmUoKSArIHRhYigpICsgXCJ9KTtcIjtcclxuICAgICAgICByZXR1cm4gJHNjZS50cnVzdEFzSHRtbChzdHIpO1xyXG4gICAgfTtcclxufVxyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1zaGFyZS1kaWFsb2cuanMubWFwIiwiZnVuY3Rpb24gaW5pdGlhbGl6ZUpzb25WaWV3ZXIoJHNjb3BlLCBhcGlTZXJ2aWNlKSB7XHJcbiAgICAkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGpzb25WaWV3ZXIgPSBnZXRKc29uVmlld2VyKCk7XHJcbiAgICAgICAgY29tbW9uQWNlU2V0dXAoanNvblZpZXdlcik7XHJcbiAgICAgICAganNvblZpZXdlci5nZXRTZXNzaW9uKCkuc2V0TW9kZShcImFjZS9tb2RlL2phdmFzY3JpcHRcIik7XHJcbiAgICAgICAganNvblZpZXdlci5zZXRPcHRpb25zKHtcclxuICAgICAgICAgICAgcmVhZE9ubHk6IHRydWUsXHJcbiAgICAgICAgICAgIGhpZ2hsaWdodEFjdGl2ZUxpbmU6IGZhbHNlLFxyXG4gICAgICAgICAgICBoaWdobGlnaHRHdXR0ZXJMaW5lOiBmYWxzZSxcclxuICAgICAgICB9KTtcclxuICAgICAgICBqc29uVmlld2VyLmdldFNlc3Npb24oKS5zZXRVc2VXb3JrZXIoZmFsc2UpO1xyXG4gICAgICAgIGpzb25WaWV3ZXIucmVuZGVyZXIuJGN1cnNvckxheWVyLmVsZW1lbnQuc3R5bGUub3BhY2l0eSA9IDA7XHJcbiAgICAgICAgZGVmaW5lKFwiaG92ZXJsaW5rXCIsIFtcInJlcXVpcmVcIiwgXCJleHBvcnRzXCJdLCBmdW5jdGlvbiAocmVxdWlyZSwgZXhwb3J0cywgbW9kdWxlKSB7XHJcbiAgICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgICAgICAgICB2YXIgb29wID0gcmVxdWlyZShcImFjZS9saWIvb29wXCIpO1xyXG4gICAgICAgICAgICB2YXIgZXZlbnQgPSByZXF1aXJlKFwiYWNlL2xpYi9ldmVudFwiKTtcclxuICAgICAgICAgICAgdmFyIFJhbmdlID0gcmVxdWlyZShcImFjZS9yYW5nZVwiKS5SYW5nZTtcclxuICAgICAgICAgICAgdmFyIEV2ZW50RW1pdHRlciA9IHJlcXVpcmUoXCJhY2UvbGliL2V2ZW50X2VtaXR0ZXJcIikuRXZlbnRFbWl0dGVyO1xyXG4gICAgICAgICAgICB2YXIgSG92ZXJMaW5rID0gZnVuY3Rpb24gKGpzb25WaWV3ZXIpIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uVmlld2VyLmhvdmVyTGluaylcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICBqc29uVmlld2VyLmhvdmVyTGluayA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmpzb25WaWV3ZXIgPSBqc29uVmlld2VyO1xyXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGUgPSB0aGlzLnVwZGF0ZS5iaW5kKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbk1vdXNlTW92ZSA9IHRoaXMub25Nb3VzZU1vdmUuYmluZCh0aGlzKTtcclxuICAgICAgICAgICAgICAgIHRoaXMub25Nb3VzZU91dCA9IHRoaXMub25Nb3VzZU91dC5iaW5kKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbkNsaWNrID0gdGhpcy5vbkNsaWNrLmJpbmQodGhpcyk7XHJcbiAgICAgICAgICAgICAgICBldmVudC5hZGRMaXN0ZW5lcihqc29uVmlld2VyLnJlbmRlcmVyLnNjcm9sbGVyLCBcIm1vdXNlbW92ZVwiLCB0aGlzLm9uTW91c2VNb3ZlKTtcclxuICAgICAgICAgICAgICAgIGV2ZW50LmFkZExpc3RlbmVyKGpzb25WaWV3ZXIucmVuZGVyZXIuY29udGVudCwgXCJtb3VzZW91dFwiLCB0aGlzLm9uTW91c2VPdXQpO1xyXG4gICAgICAgICAgICAgICAgZXZlbnQuYWRkTGlzdGVuZXIoanNvblZpZXdlci5yZW5kZXJlci5jb250ZW50LCBcImNsaWNrXCIsIHRoaXMub25DbGljayk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBvb3AuaW1wbGVtZW50KHRoaXMsIEV2ZW50RW1pdHRlcik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRva2VuID0ge307XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJhbmdlID0gbmV3IFJhbmdlKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLiR0aW1lciA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGpzb25WaWV3ZXIgPSB0aGlzLmpzb25WaWV3ZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlbmRlcmVyID0ganNvblZpZXdlci5yZW5kZXJlcjtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY2FudmFzUG9zID0gcmVuZGVyZXIuc2Nyb2xsZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9ICh0aGlzLnggKyByZW5kZXJlci5zY3JvbGxMZWZ0IC0gY2FudmFzUG9zLmxlZnQgLSByZW5kZXJlci4kcGFkZGluZykgLyByZW5kZXJlci5jaGFyYWN0ZXJXaWR0aDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcm93ID0gTWF0aC5mbG9vcigodGhpcy55ICsgcmVuZGVyZXIuc2Nyb2xsVG9wIC0gY2FudmFzUG9zLnRvcCkgLyByZW5kZXJlci5saW5lSGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY29sID0gTWF0aC5yb3VuZChvZmZzZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzY3JlZW5Qb3MgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvdzogcm93LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW46IGNvbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2lkZTogb2Zmc2V0IC0gY29sID4gMCA/IDEgOiAtMVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlc3Npb24gPSBqc29uVmlld2VyLnNlc3Npb247XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRvY1BvcyA9IHNlc3Npb24uc2NyZWVuVG9Eb2N1bWVudFBvc2l0aW9uKHNjcmVlblBvcy5yb3csIHNjcmVlblBvcy5jb2x1bW4pO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3Rpb25SYW5nZSA9IGpzb25WaWV3ZXIuc2VsZWN0aW9uLmdldFJhbmdlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzZWxlY3Rpb25SYW5nZS5pc0VtcHR5KCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGlvblJhbmdlLnN0YXJ0LnJvdyA8PSByb3cgJiYgc2VsZWN0aW9uUmFuZ2UuZW5kLnJvdyA+PSByb3cpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jbGVhcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB2YXIgbGluZSA9IGpzb25WaWV3ZXIuc2Vzc2lvbi5nZXRMaW5lKGRvY1Bvcy5yb3cpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkb2NQb3MuY29sdW1uID09IGxpbmUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjbGlwcGVkUG9zID0ganNvblZpZXdlci5zZXNzaW9uLmRvY3VtZW50VG9TY3JlZW5Qb3NpdGlvbihkb2NQb3Mucm93LCBkb2NQb3MuY29sdW1uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNsaXBwZWRQb3MuY29sdW1uICE9IHNjcmVlblBvcy5jb2x1bW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNsZWFyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRva2VuID0gdGhpcy5maW5kTGluayhkb2NQb3Mucm93LCBkb2NQb3MuY29sdW1uKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpbmsgPSB0b2tlbjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRva2VuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNsZWFyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNPcGVuID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBqc29uVmlld2VyLnJlbmRlcmVyLnNldEN1cnNvclN0eWxlKFwicG9pbnRlclwiKTtcclxuICAgICAgICAgICAgICAgICAgICBzZXNzaW9uLnJlbW92ZU1hcmtlcih0aGlzLm1hcmtlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yYW5nZSA9IG5ldyBSYW5nZSh0b2tlbi5yb3csIHRva2VuLnN0YXJ0LCB0b2tlbi5yb3csIHRva2VuLnN0YXJ0ICsgdG9rZW4udmFsdWUubGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1hcmtlciA9IHNlc3Npb24uYWRkTWFya2VyKHRoaXMucmFuZ2UsIFwiYWNlX2xpbmtfbWFya2VyXCIsIFwidGV4dFwiLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsZWFyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzT3Blbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmpzb25WaWV3ZXIuc2Vzc2lvbi5yZW1vdmVNYXJrZXIodGhpcy5tYXJrZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmpzb25WaWV3ZXIucmVuZGVyZXIuc2V0Q3Vyc29yU3R5bGUoXCJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaXNPcGVuID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0TWF0Y2hBcm91bmQgPSBmdW5jdGlvbiAocmVnRXhwLCBzdHJpbmcsIGNvbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtYXRjaDtcclxuICAgICAgICAgICAgICAgICAgICByZWdFeHAubGFzdEluZGV4ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICBzdHJpbmcucmVwbGFjZShyZWdFeHAsIGZ1bmN0aW9uIChzdHIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IGFyZ3VtZW50c1thcmd1bWVudHMubGVuZ3RoIC0gMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsZW5ndGggPSBzdHIubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob2Zmc2V0IDw9IGNvbCAmJiBvZmZzZXQgKyBsZW5ndGggPj0gY29sKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2ggPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IG9mZnNldCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogc3RyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtYXRjaDtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uQ2xpY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGpzb25WaWV3ZXIgPSB0aGlzLmpzb25WaWV3ZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlbmRlcmVyID0ganNvblZpZXdlci5yZW5kZXJlcjtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY2FudmFzUG9zID0gcmVuZGVyZXIuc2Nyb2xsZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9ICh0aGlzLnggKyByZW5kZXJlci5zY3JvbGxMZWZ0IC0gY2FudmFzUG9zLmxlZnQgLSByZW5kZXJlci4kcGFkZGluZykgLyByZW5kZXJlci5jaGFyYWN0ZXJXaWR0aDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcm93ID0gTWF0aC5mbG9vcigodGhpcy55ICsgcmVuZGVyZXIuc2Nyb2xsVG9wIC0gY2FudmFzUG9zLnRvcCkgLyByZW5kZXJlci5saW5lSGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY29sID0gTWF0aC5yb3VuZChvZmZzZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmxpbmspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJvdyAhPSB0aGlzLmxpbmsucm93IHx8ICEoY29sID4gdGhpcy5saW5rLnN0YXJ0ICYmIGNvbCA8IHRoaXMubGluay5zdGFydCArIHRoaXMubGluay52YWx1ZS5sZW5ndGgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saW5rLmpzb25WaWV3ZXIgPSB0aGlzLmpzb25WaWV3ZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3NpZ25hbChcIm9wZW5cIiwgdGhpcy5saW5rKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpbmRMaW5rID0gZnVuY3Rpb24gKHJvdywgY29sdW1uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGpzb25WaWV3ZXIgPSB0aGlzLmpzb25WaWV3ZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlc3Npb24gPSBqc29uVmlld2VyLnNlc3Npb247XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmUgPSBzZXNzaW9uLmdldExpbmUocm93KTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbWF0Y2ggPSB0aGlzLmdldE1hdGNoQXJvdW5kKC9odHRwcz86XFwvXFwvW15cXHNcIl0rL2csIGxpbmUsIGNvbHVtbik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFtYXRjaCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWF0Y2ggPSB0aGlzLmdldE1hdGNoQXJvdW5kKC9cImlkXCI6IFwiW15cXHNcIiddKy9nLCBsaW5lLCBjb2x1bW4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW1hdGNoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRjaCA9IHRoaXMuZ2V0TWF0Y2hBcm91bmQoL1wiW15cXHNcIiddKy9nLCBsaW5lLCBjb2x1bW4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW1hdGNoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBtYXRjaC5yb3cgPSByb3c7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHRoaXMub25Nb3VzZU1vdmUgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmpzb25WaWV3ZXIuJG1vdXNlSGFuZGxlci5pc01vdXNlUHJlc3NlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuanNvblZpZXdlci5zZWxlY3Rpb24uaXNFbXB0eSgpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMueCA9IGUuY2xpZW50WDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnkgPSBlLmNsaWVudFk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGUoKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uTW91c2VPdXQgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xlYXIoKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbk1vdXNlT3V0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucmVtb3ZlTGlzdGVuZXIodGhpcy5qc29uVmlld2VyLnJlbmRlcmVyLnNjcm9sbGVyLCBcIm1vdXNlbW92ZVwiLCB0aGlzLm9uTW91c2VNb3ZlKTtcclxuICAgICAgICAgICAgICAgICAgICBldmVudC5yZW1vdmVMaXN0ZW5lcih0aGlzLmpzb25WaWV3ZXIucmVuZGVyZXIuY29udGVudCwgXCJtb3VzZW91dFwiLCB0aGlzLm9uTW91c2VPdXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmpzb25WaWV3ZXIuaG92ZXJMaW5rO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSkuY2FsbChIb3ZlckxpbmsucHJvdG90eXBlKTtcclxuICAgICAgICAgICAgZXhwb3J0cy5Ib3ZlckxpbmsgPSBIb3Zlckxpbms7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmVxdWlyZShbJ2hvdmVybGluayddLCBmdW5jdGlvbiAoaG92ZXJsaW5rKSB7XHJcbiAgICAgICAgICAgIHZhciBIb3ZlckxpbmsgPSByZXF1aXJlKFwiaG92ZXJsaW5rXCIpLkhvdmVyTGluaztcclxuICAgICAgICAgICAganNvblZpZXdlci5ob3ZlckxpbmsgPSBuZXcgSG92ZXJMaW5rKGpzb25WaWV3ZXIpO1xyXG4gICAgICAgICAgICBqc29uVmlld2VyLmhvdmVyTGluay5vbihcIm9wZW5cIiwgZnVuY3Rpb24gKHgpIHtcclxuICAgICAgICAgICAgICAgIHJ1bigkc2NvcGUsIHgudmFsdWUsIGFwaVNlcnZpY2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwaS1leHBsb3Jlci1qc3ZpZXdlci5qcy5tYXAiLCJ2YXIgcmVxdWVzdEhpc3RvcnkgPSBbXTtcclxudmFyIExvY2FsU3RvcmFnZUtleUdyYXBoUmVxdWVzdEhpc3RvcnkgPSBcIkdSQVBIX1JFUVVFU1RfSElTVE9SWVwiO1xyXG5mdW5jdGlvbiBzYXZlSGlzdG9yeVRvTG9jYWxTdG9yYWdlKCkge1xyXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oTG9jYWxTdG9yYWdlS2V5R3JhcGhSZXF1ZXN0SGlzdG9yeSwgSlNPTi5zdHJpbmdpZnkocmVxdWVzdEhpc3RvcnkpKTtcclxufVxyXG5mdW5jdGlvbiBsb2FkSGlzdG9yeUZyb21Mb2NhbFN0b3JhZ2UoKSB7XHJcbiAgICB2YXIgcG9zc2libGVIaXN0b3J5ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oTG9jYWxTdG9yYWdlS2V5R3JhcGhSZXF1ZXN0SGlzdG9yeSk7XHJcbiAgICBpZiAocG9zc2libGVIaXN0b3J5ID09IG51bGwpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICByZXF1ZXN0SGlzdG9yeSA9IEpTT04ucGFyc2UocG9zc2libGVIaXN0b3J5KTtcclxufVxyXG5mdW5jdGlvbiBzYXZlSGlzdG9yeU9iamVjdChoaXN0b3J5T2JqZWN0LCBzdGF0dXNDb2RlKSB7XHJcbiAgICBoaXN0b3J5T2JqZWN0LnN1Y2Nlc3NmdWwgPSBzdGF0dXNDb2RlID49IDIwMCAmJiBzdGF0dXNDb2RlIDwgMzAwO1xyXG4gICAgaGlzdG9yeU9iamVjdC5zdGF0dXNDb2RlID0gc3RhdHVzQ29kZTtcclxuICAgIGhpc3RvcnlPYmplY3QucmVxdWVzdElkID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikucmVwbGFjZSgvW15hLXpdKy9nLCAnJykuc3Vic3RyKDAsIDEwKTtcclxuICAgIHJlcXVlc3RIaXN0b3J5LnNwbGljZSgwLCAwLCBoaXN0b3J5T2JqZWN0KTtcclxuICAgIHNhdmVIaXN0b3J5VG9Mb2NhbFN0b3JhZ2UoKTtcclxufVxyXG5mdW5jdGlvbiBmZXRjaFJlcXVlc3RIaXN0b3J5KCkge1xyXG4gICAgcmV0dXJuIHJlcXVlc3RIaXN0b3J5O1xyXG59XHJcbmxvYWRIaXN0b3J5RnJvbUxvY2FsU3RvcmFnZSgpO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1oaXN0b3J5LmpzLm1hcCIsInZhciBsb2Nfc3RyaW5ncyA9IHt9O1xyXG5sb2Nfc3RyaW5nc1snZnItRlInXSA9IHsgXCJUbyB0cnkgdGhlIGV4cGxvcmVyLCBwbGVhc2UgXCI6IFwiUG91ciBlc3NheWVyIGzigJlhZmZpY2hldXIsIHZldWlsbGV6IFwiLCBcInNpZ24gaW5cIjogXCJzZSBjb25uZWN0ZXJcIiwgXCIgd2l0aCB5b3VyIHdvcmsgb3Igc2Nob29sIGFjY291bnQgZnJvbSBNaWNyb3NvZnQuXCI6IFwiIGF2ZWMgdm90cmUgY29tcHRlIHNjb2xhaXJlIG91IHByb2Zlc3Npb25uZWwgZGUgTWljcm9zb2Z0LlwiLCBcIlN1Ym1pdFwiOiBcIkVudm95ZXJcIiwgXCJVc2luZyBkZW1vIHRlbmFudFwiOiBcIsOAIGzigJlhaWRlIGR1IGNsaWVudCBkZSBkw6ltb25zdHJhdGlvblwiLCBcInNpZ24gb3V0XCI6IFwic2UgZMOpY29ubmVjdGVyXCIsIFwiSGlzdG9yeVwiOiBcIkhpc3RvcmlxdWVcIiwgXCJNZXRob2RcIjogXCJNw6l0aG9kZVwiLCBcIlF1ZXJ5XCI6IFwiUmVxdcOqdGVcIiwgXCJTdGF0dXMgQ29kZVwiOiBcIkNvZGUgZCfDqXRhdFwiLCBcIkR1cmF0aW9uXCI6IFwiRHVyw6llXCIsIFwiR29cIjogXCJSZWNoZXJjaGVyXCIsIFwiWUVTXCI6IFwiT1VJXCIsIFwiTk9cIjogXCJOT05cIiwgXCJyZXF1ZXN0IGhlYWRlclwiOiBcImVuLXTDqnRlIGRlIGxhIGRlbWFuZGVcIiwgXCJyZXF1ZXN0IGJvZHlcIjogXCJjb3JwcyBkZSBsYSBkZW1hbmRlXCIsIFwicmVzcG9uc2VcIjogXCJyw6lwb25zZVwiIH07XHJcbmxvY19zdHJpbmdzWydlcy1FUyddID0geyBcIlRvIHRyeSB0aGUgZXhwbG9yZXIsIHBsZWFzZSBcIjogXCJQYXJhIHV0aWxpemFyIGVsIHByb2JhZG9yLCBcIiwgXCJzaWduIGluXCI6IFwiaW5pY2lhciBzZXNpw7NuXCIsIFwiIHdpdGggeW91ciB3b3JrIG9yIHNjaG9vbCBhY2NvdW50IGZyb20gTWljcm9zb2Z0LlwiOiBcIiBjb24gc3UgY3VlbnRhIHByb2Zlc2lvbmFsIG8gZWR1Y2F0aXZhIGRlIE1pY3Jvc29mdC5cIiwgXCJTdWJtaXRcIjogXCJFbnZpYXJcIiwgXCJVc2luZyBkZW1vIHRlbmFudFwiOiBcIlVzbyBkZSBpbnF1aWxpbm9zIGRlIGRlbW9zdHJhY2nDs25cIiwgXCJzaWduIG91dFwiOiBcImNlcnJhciBzZXNpw7NuXCIsIFwiSGlzdG9yeVwiOiBcIkhpc3RvcmlhbFwiLCBcIk1ldGhvZFwiOiBcIk3DqXRvZG9cIiwgXCJRdWVyeVwiOiBcIkNvbnN1bHRhXCIsIFwiU3RhdHVzIENvZGVcIjogXCJDw7NkaWdvIGRlIGVzdGFkb1wiLCBcIkR1cmF0aW9uXCI6IFwiRHVyYWNpw7NuXCIsIFwiR29cIjogXCJJclwiLCBcIllFU1wiOiBcIlPDjVwiLCBcIk5PXCI6IFwiTk9cIiwgXCJyZXF1ZXN0IGhlYWRlclwiOiBcImVuY2FiZXphZG8gZGUgc29saWNpdHVkXCIsIFwicmVxdWVzdCBib2R5XCI6IFwiY3VlcnBvIGRlIHNvbGljaXR1ZFwiLCBcInJlc3BvbnNlXCI6IFwicmVzcHVlc3RhXCIgfTtcclxubG9jX3N0cmluZ3NbJ2VuLVVTJ10gPSB7IFwiVG8gdHJ5IHRoZSBleHBsb3JlciwgcGxlYXNlIFwiOiBcIlRvIHRyeSB0aGUgZXhwbG9yZXIsIHBsZWFzZSBcIiwgXCJzaWduIGluXCI6IFwic2lnbiBpblwiLCBcIiB3aXRoIHlvdXIgd29yayBvciBzY2hvb2wgYWNjb3VudCBmcm9tIE1pY3Jvc29mdC5cIjogXCIgd2l0aCB5b3VyIHdvcmsgb3Igc2Nob29sIGFjY291bnQgZnJvbSBNaWNyb3NvZnQuXCIsIFwiU3VibWl0XCI6IFwiU3VibWl0XCIsIFwiVXNpbmcgZGVtbyB0ZW5hbnRcIjogXCJVc2luZyBkZW1vIHRlbmFudFwiLCBcInNpZ24gb3V0XCI6IFwic2lnbiBvdXRcIiwgXCJIaXN0b3J5XCI6IFwiSGlzdG9yeVwiLCBcIk1ldGhvZFwiOiBcIk1ldGhvZFwiLCBcIlF1ZXJ5XCI6IFwiUXVlcnlcIiwgXCJTdGF0dXMgQ29kZVwiOiBcIlN0YXR1cyBDb2RlXCIsIFwiRHVyYXRpb25cIjogXCJEdXJhdGlvblwiLCBcIkdvXCI6IFwiR29cIiwgXCJZRVNcIjogXCJZRVNcIiwgXCJOT1wiOiBcIk5PXCIsIFwicmVxdWVzdCBoZWFkZXJcIjogXCJyZXF1ZXN0IGhlYWRlclwiLCBcInJlcXVlc3QgYm9keVwiOiBcInJlcXVlc3QgYm9keVwiLCBcInJlc3BvbnNlXCI6IFwicmVzcG9uc2VcIiwgXCJsb2dpbl90b19zZW5kX3JlcXVlc3RzXCI6IFwiTG9naW4gdG8gY2hhbmdlIHRoZSByZXF1ZXN0IHR5cGVcIiwgXCJTaGFyZVF1ZXJ5XCI6IFwiU2hhcmUgUXVlcnlcIiB9O1xyXG5sb2Nfc3RyaW5nc1snZGUtREUnXSA9IHsgXCJUbyB0cnkgdGhlIGV4cGxvcmVyLCBwbGVhc2UgXCI6IFwiVW0gZGVuIFRlc3RlciBhdXN6dXByb2JpZXJlbiwgXCIsIFwic2lnbiBpblwiOiBcIkFubWVsZGVuXCIsIFwiIHdpdGggeW91ciB3b3JrIG9yIHNjaG9vbCBhY2NvdW50IGZyb20gTWljcm9zb2Z0LlwiOiBcIiBtaXQgSWhyZW0gR2VzY2jDpGZ0cy0gb2RlciBTY2h1bGtvbnRvIHZvbiBNaWNyb3NvZnQgYW4uXCIsIFwiU3VibWl0XCI6IFwiU2VuZGVuXCIsIFwiVXNpbmcgZGVtbyB0ZW5hbnRcIjogXCJWZXJ3ZW5kZW4gZGVzIERlbW9tYW5kYW50ZW5cIiwgXCJzaWduIG91dFwiOiBcIkFibWVsZGVuXCIsIFwiSGlzdG9yeVwiOiBcIlZlcmxhdWZcIiwgXCJNZXRob2RcIjogXCJNZXRob2RlXCIsIFwiUXVlcnlcIjogXCJBYmZyYWdlXCIsIFwiU3RhdHVzIENvZGVcIjogXCJTdGF0dXNjb2RlXCIsIFwiRHVyYXRpb25cIjogXCJEYXVlclwiLCBcIkdvXCI6IFwiT0tcIiwgXCJZRVNcIjogXCJKQVwiLCBcIk5PXCI6IFwiTkVJTlwiLCBcInJlcXVlc3QgaGVhZGVyXCI6IFwiQW5mb3JkZXJ1bmdzaGVhZGVyXCIsIFwicmVxdWVzdCBib2R5XCI6IFwiQW5mb3JkZXJ1bmdzdGV4dGvDtnJwZXJcIiwgXCJyZXNwb25zZVwiOiBcIkFudHdvcnRcIiB9O1xyXG5sb2Nfc3RyaW5nc1sncnUtUlUnXSA9IHsgXCJUbyB0cnkgdGhlIGV4cGxvcmVyLCBwbGVhc2UgXCI6IFwi0KfRgtC+0LHRiyDQvtC/0YDQvtCx0L7QstCw0YLRjCDQv9C10YHQvtGH0L3QuNGG0YMsIFwiLCBcInNpZ24gaW5cIjogXCLQstC+0LnRgtC4XCIsIFwiIHdpdGggeW91ciB3b3JrIG9yIHNjaG9vbCBhY2NvdW50IGZyb20gTWljcm9zb2Z0LlwiOiBcIiDRgSDQv9C+0LzQvtGJ0YzRjiDRgNCw0LHQvtGH0LXQuSDQuNC70Lgg0YPRh9C10LHQvdC+0Lkg0YPRh9C10YLQvdC+0Lkg0LfQsNC/0LjRgdC4INC+0YIg0LrQvtGA0L/QvtGA0LDRhtC40Lgg0JzQsNC50LrRgNC+0YHQvtGE0YIuXCIsIFwiU3VibWl0XCI6IFwi0J7RgtC/0YDQsNCy0LjRgtGMXCIsIFwiVXNpbmcgZGVtbyB0ZW5hbnRcIjogXCLQoSDQv9C+0LzQvtGJ0YzRjiDQtNC10LzQvtC90YHRgtGA0LDRhtC40L7QvdC90L7Qs9C+INC60LvQuNC10L3RgtCwXCIsIFwic2lnbiBvdXRcIjogXCLQstGL0LnRgtC4XCIsIFwiSGlzdG9yeVwiOiBcItCW0YPRgNC90LDQu1wiLCBcIk1ldGhvZFwiOiBcItCc0LXRgtC+0LRcIiwgXCJRdWVyeVwiOiBcItCX0LDQv9GA0L7RgVwiLCBcIlN0YXR1cyBDb2RlXCI6IFwi0JrQvtC0INGB0L7RgdGC0L7Rj9C90LjRj1wiLCBcIkR1cmF0aW9uXCI6IFwi0JTQu9C40YLQtdC70YzQvdC+0YHRgtGMXCIsIFwiR29cIjogXCLQn9C10YDQtdC50YLQuFwiLCBcIllFU1wiOiBcItCU0JBcIiwgXCJOT1wiOiBcItCd0JXQolwiLCBcInJlcXVlc3QgaGVhZGVyXCI6IFwi0LfQsNCz0L7Qu9C+0LLQvtC6INC30LDQv9GA0L7RgdCwXCIsIFwicmVxdWVzdCBib2R5XCI6IFwi0YLQtdC60YHRgiDQt9Cw0L/RgNC+0YHQsFwiLCBcInJlc3BvbnNlXCI6IFwi0L7RgtCy0LXRglwiIH07XHJcbmxvY19zdHJpbmdzWydqYS1KUCddID0geyBcIlRvIHRyeSB0aGUgZXhwbG9yZXIsIHBsZWFzZSBcIjogXCLjgqjjgq/jgrnjg5fjg63jg7zjg6njg7zjgpLjgYroqabjgZfjgYTjgZ/jgaDjgY/jgavjga/jgIFNaWNyb3NvZnQg44Gu6IG35aC044G+44Gf44Gv5a2m5qCh44Ki44Kr44Km44Oz44OI44GnIFwiLCBcInNpZ24gaW5cIjogXCLjgrXjgqTjg7PjgqTjg7NcIiwgXCIgd2l0aCB5b3VyIHdvcmsgb3Igc2Nob29sIGFjY291bnQgZnJvbSBNaWNyb3NvZnQuXCI6IFwiIOOBl+OBvuOBmeOAglwiLCBcIlN1Ym1pdFwiOiBcIumAgeS/oVwiLCBcIlVzaW5nIGRlbW8gdGVuYW50XCI6IFwi44OH44OiIOODhuODiuODs+ODiOOCkuS9v+eUqOOBl+OBpuOBhOOBvuOBmVwiLCBcInNpZ24gb3V0XCI6IFwi44K144Kk44Oz44Ki44Km44OIXCIsIFwiSGlzdG9yeVwiOiBcIuWxpeattFwiLCBcIk1ldGhvZFwiOiBcIuODoeOCveODg+ODiVwiLCBcIlF1ZXJ5XCI6IFwi44Kv44Ko44OqXCIsIFwiU3RhdHVzIENvZGVcIjogXCLnirbmhYvjgrPjg7zjg4lcIiwgXCJEdXJhdGlvblwiOiBcIuacn+mWk1wiLCBcIkdvXCI6IFwi5qSc57SiXCIsIFwiWUVTXCI6IFwi44Gv44GEXCIsIFwiTk9cIjogXCLjgYTjgYTjgYhcIiwgXCJyZXF1ZXN0IGhlYWRlclwiOiBcIuimgeaxguODmOODg+ODgOODvFwiLCBcInJlcXVlc3QgYm9keVwiOiBcIuimgeaxguacrOaWh1wiLCBcInJlc3BvbnNlXCI6IFwi5b+c562UXCIgfTtcclxubG9jX3N0cmluZ3NbJ3B0LUJSJ10gPSB7IFwiVG8gdHJ5IHRoZSBleHBsb3JlciwgcGxlYXNlIFwiOiBcIlBhcmEgZXhwZXJpbWVudGFyIG8gRXhwbG9yYWRvciwgXCIsIFwic2lnbiBpblwiOiBcImVudHJhclwiLCBcIiB3aXRoIHlvdXIgd29yayBvciBzY2hvb2wgYWNjb3VudCBmcm9tIE1pY3Jvc29mdC5cIjogXCIgY29tIGEgc3VhIGNvbnRhIGNvcnBvcmF0aXZhIG91IGRlIGVzdHVkYW50ZSBkYSBNaWNyb3NvZnQuXCIsIFwiU3VibWl0XCI6IFwiRW52aWFyXCIsIFwiVXNpbmcgZGVtbyB0ZW5hbnRcIjogXCJVc2FuZG8gbyBMb2NhdMOhcmlvIGRlIERlbW9uc3RyYcOnw6NvXCIsIFwic2lnbiBvdXRcIjogXCJzYWlyXCIsIFwiSGlzdG9yeVwiOiBcIkhpc3TDs3JpY29cIiwgXCJNZXRob2RcIjogXCJNw6l0b2RvXCIsIFwiUXVlcnlcIjogXCJDb25zdWx0YVwiLCBcIlN0YXR1cyBDb2RlXCI6IFwiQ8OzZGlnbyBkZSBTdGF0dXNcIiwgXCJEdXJhdGlvblwiOiBcIkR1cmHDp8Ojb1wiLCBcIkdvXCI6IFwiSXJcIiwgXCJZRVNcIjogXCJTSU1cIiwgXCJOT1wiOiBcIk7Dg09cIiwgXCJyZXF1ZXN0IGhlYWRlclwiOiBcImNhYmXDp2FsaG8gZGEgc29saWNpdGHDp8Ojb1wiLCBcInJlcXVlc3QgYm9keVwiOiBcImNvcnBvIGRhIHNvbGljaXRhw6fDo29cIiwgXCJyZXNwb25zZVwiOiBcInJlc3Bvc3RhXCIgfTtcclxubG9jX3N0cmluZ3NbJ3poLUNOJ10gPSB7IFwiVG8gdHJ5IHRoZSBleHBsb3JlciwgcGxlYXNlIFwiOiBcIuiLpeimgeWwneivlea1j+iniOWZqO+8jOivtyDkvb/nlKjkvaDnmoQgTWljcm9zb2Z0IOW3peS9nOaIluWtpuagoeW4kOaIt1wiLCBcInNpZ24gaW5cIjogXCLnmbvlvZVcIiwgXCIgd2l0aCB5b3VyIHdvcmsgb3Igc2Nob29sIGFjY291bnQgZnJvbSBNaWNyb3NvZnQuXCI6IFwi44CCXCIsIFwiU3VibWl0XCI6IFwi5o+Q5LqkXCIsIFwiVXNpbmcgZGVtbyB0ZW5hbnRcIjogXCLkvb/nlKjmvJTnpLrnp5/miLdcIiwgXCJzaWduIG91dFwiOiBcIuazqOmUgFwiLCBcIkhpc3RvcnlcIjogXCLljoblj7LorrDlvZVcIiwgXCJNZXRob2RcIjogXCLmlrnms5VcIiwgXCJRdWVyeVwiOiBcIuafpeivolwiLCBcIlN0YXR1cyBDb2RlXCI6IFwi54q25oCB5Luj56CBXCIsIFwiRHVyYXRpb25cIjogXCLmjIHnu63ml7bpl7RcIiwgXCJHb1wiOiBcIui9rOWIsFwiLCBcIllFU1wiOiBcIuaYr1wiLCBcIk5PXCI6IFwi5ZCmXCIsIFwicmVxdWVzdCBoZWFkZXJcIjogXCLor7fmsYLmoIfpophcIiwgXCJyZXF1ZXN0IGJvZHlcIjogXCLor7fmsYLmraPmlodcIiwgXCJyZXNwb25zZVwiOiBcIuWTjeW6lFwiIH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxvY19zdHJpbmdzLmpzLm1hcCIsInZhciBwb3N0VGVtcGxhdGVzID0ge1xyXG4gICAgbWVzc2FnZXM6IHtcclxuICAgICAgICBcInN1YmplY3RcIjogXCJNZWV0IGZvciBsdW5jaD9cIixcclxuICAgICAgICBcImJvZHlcIjoge1xyXG4gICAgICAgICAgICBcImNvbnRlbnRUeXBlXCI6IFwiVGV4dFwiLFxyXG4gICAgICAgICAgICBcImNvbnRlbnRcIjogXCJUaGUgbmV3IGNhZmV0ZXJpYSBpcyBvcGVuLlwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBcInRvUmVjaXBpZW50c1wiOiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFwiZW1haWxBZGRyZXNzXCI6IHtcclxuICAgICAgICAgICAgICAgICAgICBcImFkZHJlc3NcIjogXCJnYXJ0aGZAY29udG9zby5jb21cIlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXVxyXG4gICAgfSxcclxuICAgIGV2ZW50czoge1xyXG4gICAgICAgIFwic3ViamVjdFwiOiBcIk15IGV2ZW50XCIsXHJcbiAgICAgICAgXCJzdGFydFwiOiB7XHJcbiAgICAgICAgICAgIFwiZGF0ZVRpbWVcIjogXCIyMDE3LTA1LTA3VDE2OjE1OjAwLjAwMDAwMDBcIixcclxuICAgICAgICAgICAgXCJ0aW1lWm9uZVwiOiBcIlVUQ1wiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBcImVuZFwiOiB7XHJcbiAgICAgICAgICAgIFwiZGF0ZVRpbWVcIjogXCIyMDE3LTA2LTA3VDE2OjE1OjAwLjAwMDAwMDBcIixcclxuICAgICAgICAgICAgXCJ0aW1lWm9uZVwiOiBcIlVUQ1wiXHJcbiAgICAgICAgfSxcclxuICAgIH0sXHJcbiAgICBzZW5kTWFpbDoge1xyXG4gICAgICAgIFwibWVzc2FnZVwiOiB7XHJcbiAgICAgICAgICAgIFwic3ViamVjdFwiOiBcIk1lZXQgZm9yIGx1bmNoP1wiLFxyXG4gICAgICAgICAgICBcImJvZHlcIjoge1xyXG4gICAgICAgICAgICAgICAgXCJjb250ZW50VHlwZVwiOiBcIlRleHRcIixcclxuICAgICAgICAgICAgICAgIFwiY29udGVudFwiOiBcIlRoZSBuZXcgY2FmZXRlcmlhIGlzIG9wZW4uXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgXCJ0b1JlY2lwaWVudHNcIjogW1xyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIFwiZW1haWxBZGRyZXNzXCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhZGRyZXNzXCI6IFwiZ2FydGhmQGNvbnRvc28uY29tXCJcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF1cclxuICAgICAgICB9LFxyXG4gICAgICAgIFwic2F2ZVRvU2VudEl0ZW1zXCI6IFwiZmFsc2VcIlxyXG4gICAgfSxcclxuICAgIGZpbmRNZWV0aW5nVGltZXM6IHtcclxuICAgICAgICBcImF0dGVuZGVlc1wiOiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIFwiZW1haWxBZGRyZXNzXCI6IHtcclxuICAgICAgICAgICAgICAgICAgICBcImFkZHJlc3NcIjogXCJGVUxMX1VTRVJfRU1BSUxcIixcclxuICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJBbGV4IERhcnJvd1wiXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwiUmVxdWlyZWRcIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXSxcclxuICAgICAgICBcInRpbWVDb25zdHJhaW50XCI6IHtcclxuICAgICAgICAgICAgXCJ0aW1lc2xvdHNcIjogW1xyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIFwic3RhcnRcIjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImRhdGVUaW1lXCI6IFwiMjAxNi0xMC0yMFQwNzowMDowMFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRpbWVab25lXCI6IFwiUGFjaWZpYyBTdGFuZGFyZCBUaW1lXCJcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIFwiZW5kXCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJkYXRlVGltZVwiOiBcIjIwMTYtMTAtMjBUMTc6MDA6MDBcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aW1lWm9uZVwiOiBcIlBhY2lmaWMgU3RhbmRhcmQgVGltZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBdXHJcbiAgICAgICAgfSxcclxuICAgICAgICBcImxvY2F0aW9uQ29uc3RyYWludFwiOiB7XHJcbiAgICAgICAgICAgIFwiaXNSZXF1aXJlZFwiOiBcImZhbHNlXCIsXHJcbiAgICAgICAgICAgIFwic3VnZ2VzdExvY2F0aW9uXCI6IFwidHJ1ZVwiLFxyXG4gICAgICAgICAgICBcImxvY2F0aW9uc1wiOiBbXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJkaXNwbGF5TmFtZVwiOiBcIkNvbmYgUm9vbSAzMi8xMzY4XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJsb2NhdGlvbkVtYWlsQWRkcmVzc1wiOiBcImNvbmYzMnJvb20xMzY4QGltZ2Vlay5vbm1pY3Jvc29mdC5jb21cIlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBdXHJcbiAgICAgICAgfSxcclxuICAgICAgICBcIm1lZXRpbmdEdXJhdGlvblwiOiBcIlBUMUhcIlxyXG4gICAgfSxcclxuICAgIHVzZXJzOiB7XHJcbiAgICAgICAgXCJhY2NvdW50RW5hYmxlZFwiOiB0cnVlLFxyXG4gICAgICAgIFwiY2l0eVwiOiBcIlNlYXR0bGVcIixcclxuICAgICAgICBcImNvdW50cnlcIjogXCJVbml0ZWQgU3RhdGVzXCIsXHJcbiAgICAgICAgXCJkZXBhcnRtZW50XCI6IFwiU2FsZXMgJiBNYXJrZXRpbmdcIixcclxuICAgICAgICBcImRpc3BsYXlOYW1lXCI6IFwiTWVsaXNzYSBEYXJyb3dcIixcclxuICAgICAgICBcImdpdmVuTmFtZVwiOiBcIk1lbGlzc2FcIixcclxuICAgICAgICBcImpvYlRpdGxlXCI6IFwiTWFya2V0aW5nIERpcmVjdG9yXCIsXHJcbiAgICAgICAgXCJtYWlsTmlja25hbWVcIjogXCJNZWxpc3NhRFwiLFxyXG4gICAgICAgIFwicGFzc3dvcmRQb2xpY2llc1wiOiBcIkRpc2FibGVQYXNzd29yZEV4cGlyYXRpb25cIixcclxuICAgICAgICBcInBhc3N3b3JkUHJvZmlsZVwiOiB7XHJcbiAgICAgICAgICAgIFwicGFzc3dvcmRcIjogXCJUZXN0MTIzNFwiLFxyXG4gICAgICAgICAgICBcImZvcmNlQ2hhbmdlUGFzc3dvcmROZXh0U2lnbkluXCI6IGZhbHNlXHJcbiAgICAgICAgfSxcclxuICAgICAgICBcIm9mZmljZUxvY2F0aW9uXCI6IFwiMTMxLzExMDVcIixcclxuICAgICAgICBcInBvc3RhbENvZGVcIjogXCI5ODA1MlwiLFxyXG4gICAgICAgIFwicHJlZmVycmVkTGFuZ3VhZ2VcIjogXCJlbi1VU1wiLFxyXG4gICAgICAgIFwic3RhdGVcIjogXCJXQVwiLFxyXG4gICAgICAgIFwic3RyZWV0QWRkcmVzc1wiOiBcIjkyNTYgVG93bmUgQ2VudGVyIERyLiwgU3VpdGUgNDAwXCIsXHJcbiAgICAgICAgXCJzdXJuYW1lXCI6IFwiRGFycm93XCIsXHJcbiAgICAgICAgXCJtb2JpbGVQaG9uZVwiOiBcIisxIDIwNiA1NTUgMDExMFwiLFxyXG4gICAgICAgIFwidXNhZ2VMb2NhdGlvblwiOiBcIlVTXCIsXHJcbiAgICAgICAgXCJ1c2VyUHJpbmNpcGFsTmFtZVwiOiBcIk1lbGlzc2FEQEFVVEhFTlRJQ0FURURfRE9NQUlOXCIsXHJcbiAgICB9LFxyXG4gICAgZ3JvdXBzOiB7XHJcbiAgICAgICAgXCJAb2RhdGEudHlwZVwiOiBcIiNNaWNyb3NvZnQuR3JhcGguR3JvdXBcIixcclxuICAgICAgICBcImRlc2NyaXB0aW9uXCI6IFwiVGhpcyBncm91cCBpcyB0aGUgYmVzdCBldmVyXCIsXHJcbiAgICAgICAgXCJkaXNwbGF5TmFtZVwiOiBcIlVuaWZpZWQgZ3JvdXAgM2VmMTVcIixcclxuICAgICAgICBcImdyb3VwVHlwZXNcIjogW1xyXG4gICAgICAgICAgICBcIlVuaWZpZWRcIlxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgXCJtYWlsRW5hYmxlZFwiOiB0cnVlLFxyXG4gICAgICAgIFwibWFpbE5pY2tuYW1lXCI6IFwiR3JvdXA5MTFlNVwiLFxyXG4gICAgICAgIFwic2VjdXJpdHlFbmFibGVkXCI6IHRydWVcclxuICAgIH0sXHJcbiAgICBjb250YWN0czoge1xyXG4gICAgICAgIFwiZ2l2ZW5OYW1lXCI6IFwiUGF2ZWxcIixcclxuICAgICAgICBcInN1cm5hbWVcIjogXCJCYW5za3lcIixcclxuICAgICAgICBcImVtYWlsQWRkcmVzc2VzXCI6IFtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgXCJhZGRyZXNzXCI6IFwicGF2ZWxiQGZhYnJpa2FtLm9ubWljcm9zb2Z0LmNvbVwiLFxyXG4gICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiUGF2ZWwgQmFuc2t5XCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgXCJidXNpbmVzc1Bob25lc1wiOiBbXHJcbiAgICAgICAgICAgIFwiKzEgNzMyIDU1NSAwMTAyXCJcclxuICAgICAgICBdXHJcbiAgICB9XHJcbn07XHJcbnZhciB0ZW1wbGF0ZU5hbWVzID0ge1xyXG4gICAgbWVzc2FnZXM6ICdtZXNzYWdlJyxcclxuICAgIGV2ZW50czogJ2V2ZW50JyxcclxuICAgIHNlbmRNYWlsOiAnZW1haWwnXHJcbn07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBvc3RUZW1wbGF0ZXMuanMubWFwIl19
