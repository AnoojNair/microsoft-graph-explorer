function run($scope,url,apiService){$scope.$emit("urlChange",url)}function formatXml(xml){var reg=/(>)\s*(<)(\/*)/g,wsexp=/ *(.*) +\n/g,contexp=/(<.+>)(.+\n)/g;xml=xml.replace(reg,"$1\n$2$3").replace(wsexp,"$1\n").replace(contexp,"$1\n$2");for(var formatted="",lines=xml.split("\n"),indent=0,lastType="other",transitions={"single->single":0,"single->closing":-1,"single->opening":0,"single->other":0,"closing->single":0,"closing->closing":-1,"closing->opening":0,"closing->other":0,"opening->single":1,"opening->closing":0,"opening->opening":1,"opening->other":1,"other->single":0,"other->closing":-1,"other->opening":0,"other->other":0},i=0;i<lines.length;i++){var ln=lines[i],single=Boolean(ln.match(/<.+\/>/)),closing=Boolean(ln.match(/<\/.+>/)),opening=Boolean(ln.match(/<[^!].*>/)),type=single?"single":closing?"closing":opening?"opening":"other",fromTo=lastType+"->"+type;lastType=type;var padding="";indent+=transitions[fromTo];for(var j=0;j<indent;j++)padding+="\t";"opening->closing"==fromTo?formatted=formatted.substr(0,formatted.length-1)+ln+"\n":formatted+=padding+ln+"\n"}return formatted}function showDuration($scope,startTime){var endTime=new Date;$scope.duration=endTime.getTime()-startTime.getTime(),$scope.requestInProgress=!1}function insertHeadersIntoResponseViewer($scope,headers,status){var responseObj={};null!=headers&&(responseObj=headers()),responseObj["Status Code"]=status;var headersArr=[];for(var headerName in responseObj)headersArr.push(headerName+": "+responseObj[headerName]);getJsonViewer().getSession().setValue(""),getJsonViewer().getSession().insert(0,headersArr.join("\n"))}function getRequestBodyEditor(){var requestBodyEditorElement=document.getElementById("jsonEditor");return ace.edit(requestBodyEditorElement)}function getJsonViewer(){var jsonViewerElement=document.getElementById("jsonViewer");return ace.edit(jsonViewerElement)}function showResults($scope,results,headers,status,responseContentType){getJsonViewer().setValue(""),insertHeadersIntoResponseViewer($scope,headers,status),getJsonViewer().getSession().insert(0,results),responseContentType&&getJsonViewer().getSession().setMode("ace/mode/"+responseContentType)}function handleImageResponse($scope,apiService,startTime,headers,status,handleUnsuccessfulQueryResponse){apiService.performQuery("GET_BINARY")($scope.text).then(function(result){var blob=new Blob([result.data],{type:"image/jpeg"}),imageUrl=window.URL.createObjectURL(blob),imageResultViewer=document.getElementById("img");imageResultViewer.src=imageUrl,$scope.showImage=!0,insertHeadersIntoResponseViewer($scope,result.headers,result.status),showDuration($scope,startTime)},handleUnsuccessfulQueryResponse)}function handleHtmlResponse($scope,startTime,results,headers,status){showDuration($scope,startTime),showResults($scope,results,headers,status,"html")}function handleJsonResponse($scope,startTime,results,headers,status){results=JSON.stringify(results,null,4),showDuration($scope,startTime),showResults($scope,results,headers,status,"json")}function handleXmlResponse($scope,startTime,results,headers,status){results=formatXml(results),showDuration($scope,startTime),showResults($scope,results,headers,status,"xml")}function isImageResponse(headers){var contentType=getContentType(headers);return"application/octet-stream"===contentType||"image/"===contentType.substr(0,6)}function isHtmlResponse(headers){var contentType=getContentType(headers);return"text/html"===contentType||"application/xhtml+xml"===contentType}function isXmlResponse(results){return JSON.stringify(results,null,4).indexOf("<?xml")!=-1}function isJsonResponse(headers){var contentType=getContentType(headers);return"application/json"===contentType}function getContentType(headers){var full=headers("content-type"),delimiterPos=full.indexOf(";");return delimiterPos!=-1?full.substr(0,delimiterPos):full}function getEntitySets(metadata){for(var entitySetsObj={},entitySetsAndSingletons=$($.parseHTML(metadata)[1]).find("EntityContainer")[0].children,i=0;i<entitySetsAndSingletons.length;i++){var set=entitySetsAndSingletons[i],entitySetOrSingleton=null;"ENTITYSET"==set.tagName?entitySetOrSingleton={name:set.getAttribute("name"),isEntitySet:!0,type:set.getAttribute("entitytype"),isACollection:!0}:"SINGLETON"==set.tagName?entitySetOrSingleton={name:set.getAttribute("name"),isEntitySet:!1,type:set.getAttribute("type"),isACollection:!1}:console.error("Found unexpected type in metadata under EntityContainer"),entitySetsObj[entitySetOrSingleton.name]=entitySetOrSingleton}return entitySetsObj}function formatRequestHeaders(headers){for(var obj={},parts=headers.replace(/^\s+|,\s*$/g,"").split("\n"),i=0,len=parts.length;i<len;i++){var match=parts[i].match(/^\s*"?([^":]*)"?\s*:\s*"?([^"]*)\s*$/);match&&(obj[match[1]]=match[2])}return obj}function createEntityTypeObject(DOMarray){for(var entityTypes={},i=0;i<DOMarray.length;i++){for(var EntityType={name:DOMarray[i].getAttribute("name"),links:{}},children=DOMarray[i].children,j=0;j<children.length;j++)if(children[j].attributes.length>0){var childName=children[j].getAttribute("name"),type=children[j].getAttribute("type"),urlObject={isACollection:!1,name:childName,isEntitySet:!1,type:type};0==type.indexOf("Collection(")&&(urlObject.isACollection=!0,urlObject.type=type.split("(")[1].split(")")[0]),EntityType.links[childName]=urlObject}entityTypes[EntityType.name]=EntityType}return entityTypes}function showRequestHeaders($scope){if($scope.jsonEditorHeaders){$scope.jsonEditorHeaders.getSession().setValue("");var requestHeaders="Content-Type: application/json";$scope.jsonEditorHeaders.getSession().insert(0,requestHeaders)}}function getEntityTypes(metadata){var entities={},entityTypes=$($.parseHTML(metadata)[1]).find("EntityType");jQuery.extend(entities,createEntityTypeObject(entityTypes));var complexTypes=$($.parseHTML(metadata)[1]).find("ComplexType");return jQuery.extend(entities,createEntityTypeObject(complexTypes)),entities}function myTrim(word){var returnWord=word;if(null!=returnWord){for(;"/"==returnWord.charAt(returnWord.length-1);)returnWord=returnWord.replace(/\/$/,"");return returnWord}}function getEntityName(URL){var returnWord=myTrim(URL);return null!=returnWord&&(returnWord=returnWord.substring(returnWord.lastIndexOf("/")+1,returnWord.length)),returnWord}function getEntityFromTypeName(service,typePossiblyWithPrefix){var entityTypeData=service.cache.get(service.selectedVersion+"EntityTypeData"),type=typePossiblyWithPrefix.split("microsoft.graph.").pop();return entityTypeData[type]}function constructGraphLinksFromServicePath(service){var urlPathArr=service.text.split("https://graph.microsoft.com/");if(urlPathArr.length<=1)return[];var segments=urlPathArr[1].split("/"),graph=(segments.shift(),[]),entityContainerData=service.cache.get(service.selectedVersion+"EntitySetData");if(void 0===entityContainerData)return[];for(;segments.length>0;){var segment=segments.shift();if(0==graph.length){if(segment in entityContainerData){var node=entityContainerData[segment];graph.push(node)}}else{var lastGraphItem=graph[graph.length-1],lastGraphItemEntity=getEntityFromTypeName(service,lastGraphItem.type);if(void 0===lastGraphItemEntity)continue;void 0!==lastGraphItemEntity.links&&segment in lastGraphItemEntity.links?graph.push(lastGraphItemEntity.links[segment]):lastGraphItem.isACollection&&""!=segment&&graph.push({isACollection:!1,isEntitySet:!1,name:segment,type:lastGraphItem.type})}}return graph}function combineUrlOptionsWithCurrentUrl(service,urlOptions){for(var graphFromServiceUrl=constructGraphLinksFromServicePath(service),baseUrl=[];graphFromServiceUrl.length>0;){var lastSegment=graphFromServiceUrl.shift();baseUrl.push(lastSegment.name)}var baseUrlFinal="https://graph.microsoft.com/"+service.selectedVersion;baseUrl.length>0&&(baseUrlFinal+="/"+baseUrl.join("/"));var autocompleteUrls=[];for(var urlAutoCompleteSuffix in urlOptions)autocompleteUrls.push(baseUrlFinal+"/"+urlOptions[urlAutoCompleteSuffix]);return autocompleteUrls}function getUrlsFromServiceURL(service,lastCallSuccessful){var graphFromServiceUrl=constructGraphLinksFromServicePath(service);if(graphFromServiceUrl.length>0){var lastNode=graphFromServiceUrl.pop();if(lastNode.isACollection)return[];var entity=getEntityFromTypeName(service,lastNode.type);return combineUrlOptionsWithCurrentUrl(service,Object.keys(entity.links))}var entityContainerData=service.cache.get(service.selectedVersion+"EntitySetData");return void 0===entityContainerData?[]:combineUrlOptionsWithCurrentUrl(service,Object.keys(entityContainerData))}function showRequestBodyEditor(){s.tabConfig.disableRequestBodyEditor=!1,s.tabConfig.hideContent=!1,showRequestHeaders(s),$(function(){initializeJsonEditor(s),setSelectedTab(1)})}function setSelectedTab(num){num>=2||num<0||(s.tabConfig.selected=num,s.tabConfig.previousSelected=s.tabConfig.selected)}function handleQueryString(service,actionValue,versionValue,requestValue){actionValue&&(service.selectedOption=actionValue.toUpperCase(),"POST"!==service.selectedOption&&"PATCH"!==service.selectedOption||null!=hello("msft").getAuthResponse()&&showRequestBodyEditor()),versionValue&&(service.selectedVersion=versionValue),requestValue&&(service.text="https://graph.microsoft.com/"+service.selectedVersion+"/"+requestValue)}function getUrlsFromEntityType(service,entity){var entityTypes=service.cache.get(service.selectedVersion+"EntityTypeData"),type=entityTypes[entity.name];return combineUrlOptionsWithCurrentUrl(service,Object.keys(type.links))}function parseMetadata(service,$scope){var entitySetData,entityTypeData;service.cache.get(service.selectedVersion+"Metadata")?$scope.$root.$broadcast("updateUrlOptions"):(console.log("parsing metadata"),service.getMetadata().then(function(results){var metadata=results.data;service.cache.put(service.selectedVersion+"Metadata",results),entitySetData=getEntitySets(metadata),service.cache.put(service.selectedVersion+"EntitySetData",entitySetData),entityTypeData=getEntityTypes(metadata),service.cache.put(service.selectedVersion+"EntityTypeData",entityTypeData),console.log("metadata successfully parsed"),""==service.entity?service.entity=entityTypeData.user:service.entity=entityTypeData[getEntityName(service.text)],$scope.$root.$broadcast("updateUrlOptions")},function(err,status){console.error("metadata could not be parsed")}))}function initializeJsonEditor($scope,bodyVal){var jsonEditor=getRequestBodyEditor();jsonEditor.getSession().setMode("ace/mode/javascript"),jsonEditor.$blockScrolling=1/0,jsonEditor.setShowPrintMargin(!1),bodyVal?jsonEditor.getSession().insert({row:0,column:0},bodyVal):jsonEditor.getSession().insert(0," "),jsonEditor.renderer.setOption("showLineNumbers",!1),jsonEditor.commands.bindKey("Tab",null),$scope.jsonEditor=jsonEditor}function initializeJsonEditorHeaders($scope,headersVal){var jsonViewerElement=document.getElementById("jsonEditorHeaders");return jsonViewerElement?(jsonEditorHeaders=ace.edit(jsonViewerElement),jsonEditorHeaders.setShowPrintMargin(!1),jsonEditorHeaders.$blockScrolling=1/0,headersVal?jsonEditorHeaders.getSession().insert(0,headersVal):jsonEditorHeaders.getSession().insert(0," "),jsonEditorHeaders.renderer.setOption("showLineNumbers",!1),jsonEditorHeaders.moveCursorTo(1,0),jsonEditorHeaders.commands.bindKey("Tab",null),void($scope.jsonEditorHeaders=jsonEditorHeaders)):void console.error("cannot find #jsonEditorHeaders")}function initializeJsonViewer($scope,apiService){$(document).ready(function(){var jsonViewerElement=document.getElementById("jsonViewer");jsonViewer=ace.edit(jsonViewerElement),jsonViewer.getSession().setMode("ace/mode/javascript"),jsonViewer.$blockScrolling=1/0,jsonViewer.renderer.setOption("showLineNumbers",!1),jsonViewer.setOptions({readOnly:!0,highlightActiveLine:!1,highlightGutterLine:!1}),jsonViewer.setShowPrintMargin(!1),jsonViewer.getSession().setUseWorker(!1),jsonViewer.renderer.$cursorLayer.element.style.opacity=0,define("hoverlink",["require","exports"],function(require,exports,module){"use strict";var oop=require("ace/lib/oop"),event=require("ace/lib/event"),Range=require("ace/range").Range,EventEmitter=require("ace/lib/event_emitter").EventEmitter,HoverLink=function(jsonViewer){jsonViewer.hoverLink||(jsonViewer.hoverLink=this,this.jsonViewer=jsonViewer,this.update=this.update.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onClick=this.onClick.bind(this),event.addListener(jsonViewer.renderer.scroller,"mousemove",this.onMouseMove),event.addListener(jsonViewer.renderer.content,"mouseout",this.onMouseOut),event.addListener(jsonViewer.renderer.content,"click",this.onClick))};(function(){oop.implement(this,EventEmitter),this.token={},this.range=new Range,this.update=function(){this.$timer=null;var jsonViewer=this.jsonViewer,renderer=jsonViewer.renderer,canvasPos=renderer.scroller.getBoundingClientRect(),offset=(this.x+renderer.scrollLeft-canvasPos.left-renderer.$padding)/renderer.characterWidth,row=Math.floor((this.y+renderer.scrollTop-canvasPos.top)/renderer.lineHeight),col=Math.round(offset),screenPos={row:row,column:col,side:offset-col>0?1:-1},session=jsonViewer.session,docPos=session.screenToDocumentPosition(screenPos.row,screenPos.column),selectionRange=jsonViewer.selection.getRange();if(!selectionRange.isEmpty()&&selectionRange.start.row<=row&&selectionRange.end.row>=row)return this.clear();var line=jsonViewer.session.getLine(docPos.row);if(docPos.column==line.length){var clippedPos=jsonViewer.session.documentToScreenPosition(docPos.row,docPos.column);if(clippedPos.column!=screenPos.column)return this.clear()}var token=this.findLink(docPos.row,docPos.column);return this.link=token,token?(this.isOpen=!0,jsonViewer.renderer.setCursorStyle("pointer"),session.removeMarker(this.marker),this.range=new Range(token.row,token.start,token.row,token.start+token.value.length),void(this.marker=session.addMarker(this.range,"ace_link_marker","text",!0))):this.clear()},this.clear=function(){this.isOpen&&(this.jsonViewer.session.removeMarker(this.marker),this.jsonViewer.renderer.setCursorStyle(""),this.isOpen=!1)},this.getMatchAround=function(regExp,string,col){var match;return regExp.lastIndex=0,string.replace(regExp,function(str){var offset=arguments[arguments.length-2],length=str.length;offset<=col&&offset+length>=col&&(match={start:offset,value:str})}),match},this.onClick=function(){var jsonViewer=this.jsonViewer,renderer=jsonViewer.renderer,canvasPos=renderer.scroller.getBoundingClientRect(),offset=(this.x+renderer.scrollLeft-canvasPos.left-renderer.$padding)/renderer.characterWidth,row=Math.floor((this.y+renderer.scrollTop-canvasPos.top)/renderer.lineHeight),col=Math.round(offset);if(this.link){if(row!=this.link.row||!(col>this.link.start&&col<this.link.start+this.link.value.length))return;this.link.jsonViewer=this.jsonViewer,this._signal("open",this.link),this.clear()}},this.findLink=function(row,column){var jsonViewer=this.jsonViewer,session=jsonViewer.session,line=session.getLine(row),match=this.getMatchAround(/https?:\/\/[^\s"]+/g,line,column);if(!match){var match=this.getMatchAround(/"id": "[^\s"']+/g,line,column);if(!match)return;if(match=this.getMatchAround(/"[^\s"']+/g,line,column),!match)return}return match.row=row,match},this.onMouseMove=function(e){return this.jsonViewer.$mouseHandler.isMousePressed?void(this.jsonViewer.selection.isEmpty()||this.clear()):(this.x=e.clientX,this.y=e.clientY,void this.update())},this.onMouseOut=function(e){this.clear()},this.destroy=function(){this.onMouseOut(),event.removeListener(this.jsonViewer.renderer.scroller,"mousemove",this.onMouseMove),event.removeListener(this.jsonViewer.renderer.content,"mouseout",this.onMouseOut),delete this.jsonViewer.hoverLink}}).call(HoverLink.prototype),exports.HoverLink=HoverLink}),HoverLink=require("hoverlink").HoverLink,jsonViewer.hoverLink=new HoverLink(jsonViewer),jsonViewer.hoverLink.on("open",function(x){run($scope,x.value,apiService)})})}function setJsonViewerContentType(mode){$(document).ready(function(){jsonViewer.getSession().setMode("ace/mode/"+mode)})}function endsWithSlash(serviceText){return"/"==serviceText.charAt(serviceText.length-1)}function msGraphLinkResolution($scope,body,args,service){if(args.indexOf("https://")==-1)if(service.text.indexOf(args.substr(1))!=-1);else if(service.text.indexOf("/me")!=-1&&service.text.indexOf("/me/")==-1&&service.text.indexOf("/memberOf")==-1)service.text=service.text.replace("/me","")+"/users/"+args.substr(1);else{var index=body.indexOf(args.substr(1)),typeIndex=body.lastIndexOf("@odata.type",index);if(typeIndex!=-1){var typeIndexEnd=body.indexOf("\n",typeIndex),type=body.substr(typeIndex,typeIndexEnd-typeIndex);type=type.replace('@odata.type": "#microsoft.graph.',""),type=type.replace('"',"").replace(",",""),service.text="https://graph.microsoft.com/v1.0/"+type+"s/"+args.substr(1)}else{service.text.indexOf("?")!=-1&&(service.text=service.text.substr(0,service.text.indexOf("?")));var linkUrl=[service.text,args.substr(1)];endsWithSlash(service.text)?service.text=linkUrl.join(""):service.text=linkUrl.join("/")}}else service.text=args.replace('"',"");service.text&&endsWithSlash(service.text)&&(service.text+="/"),$scope.$broadcast("updateUrlFromServiceText"),$scope.submit(service.text)}function saveHistoryToLocalStorage(){localStorage.setItem(LocalStorageKeyGraphRequestHistory,JSON.stringify(requestHistory))}function loadHistoryFromLocalStorage(){var possibleHistory=localStorage.getItem(LocalStorageKeyGraphRequestHistory);null!=possibleHistory&&(requestHistory=JSON.parse(possibleHistory))}function saveHistoryObject(historyObject,statusCode,duration){historyObject.successful=statusCode>=200&&statusCode<300,historyObject.statusCode=statusCode,historyObject.duration=duration,historyObject.requestId=Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,10),requestHistory.splice(0,0,historyObject),saveHistoryToLocalStorage()}function createShareLink(fullRequestUrl,action,version){return window.location.origin+window.location.pathname+"?request="+extractGraphEndpoint(fullRequestUrl)+"&method="+action+"&version="+version}function extractGraphEndpoint(fullRequestUrl){requestUrl=fullRequestUrl.split(".com"),requestUrl.shift();var requestUrlComponents=requestUrl[0].split("/");return requestUrlComponents.shift(),requestUrlComponents.shift(),requestUrlComponents.join("/")}function isPostOrPatch(option){return"POST"==option||"PATCH"==option}function ShareDialogController($scope,$mdDialog,apiService,$sce,headers,body){var _apiService=apiService;$scope.hide=function(){$mdDialog.hide()},$scope.cancel=function(){$mdDialog.cancel()},$scope.getShareLink=function(){var requestUrl=$scope.getSearchText();return createShareLink(requestUrl,_apiService.selectedOption,_apiService.selectedVersion)},$scope.generateSuperAgentCode=function(){var requestUrl=$scope.getSearchText(),fullGraphUrl="https://graph.microsoft.com/"+_apiService.selectedVersion+"/"+extractGraphEndpoint(requestUrl),tab=function(){return"<span style='padding-left:15px'></span>"},line=function(){return"<br>"},str="request";if(str+=line()+tab()+"."+_apiService.selectedOption.toLocaleLowerCase()+'("'+fullGraphUrl+'")',Object.keys(headers).length>0&&(str+=line()+tab()+".set("+JSON.stringify(headers)+")"),isPostOrPatch(_apiService.selectedOption))try{var bodyObj=JSON.parse(body);bodyObj&&(str+=line()+tab()+".send("+JSON.stringify(bodyObj)+")")}catch(e){}return str+=line()+tab()+".end(function(err, res) {",str+=line()+tab()+tab()+"console.log(res);",str+=line()+tab()+"});",$sce.trustAsHtml(str)}}!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(a){this.message=a}function e(a){var b=String(a).replace(/=+$/,"");if(b.length%4==1)throw new d("'atob' failed: The string to be decoded is not correctly encoded.");for(var c,e,g=0,h=0,i="";e=b.charAt(h++);~e&&(c=g%4?64*c+e:e,g++%4)?i+=String.fromCharCode(255&c>>(-2*g&6)):0)e=f.indexOf(e);return i}var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";d.prototype=new Error,d.prototype.name="InvalidCharacterError",b.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||e},{}],2:[function(a,b,c){function d(a){return decodeURIComponent(e(a).replace(/(.)/g,function(a,b){var c=b.charCodeAt(0).toString(16).toUpperCase();return c.length<2&&(c="0"+c),"%"+c}))}var e=a("./atob");b.exports=function(a){var b=a.replace(/-/g,"+").replace(/_/g,"/");switch(b.length%4){case 0:break;case 2:b+="==";break;case 3:b+="=";break;default:throw"Illegal base64url string!"}try{return d(b)}catch(c){return e(b)}}},{"./atob":1}],3:[function(a,b,c){"use strict";var d=a("./base64_url_decode");b.exports=function(a,b){if("string"!=typeof a)throw new Error("Invalid token specified");b=b||{};var c=b.header===!0?0:1;return JSON.parse(d(a.split(".")[c]))}},{"./base64_url_decode":2}],4:[function(a,b,c){(function(b){var c=a("./lib/index");"function"==typeof b.window.define&&b.window.define.amd?b.window.define("jwt_decode",function(){return c}):b.window&&(b.window.jwt_decode=c)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lib/index":3}]},{},[4]),Object.create||(Object.create=function(){function F(){}return function(o){if(1!=arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return F.prototype=o,new F}}()),Object.keys||(Object.keys=function(o,k,r){r=[];for(k in o)r.hasOwnProperty.call(o,k)&&r.push(k);return r}),Array.prototype.indexOf||(Array.prototype.indexOf=function(s){for(var j=0;j<this.length;j++)if(this[j]===s)return j;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(fun){if(void 0===this||null===this)throw new TypeError;var t=Object(this),len=t.length>>>0;if("function"!=typeof fun)throw new TypeError;for(var thisArg=arguments.length>=2?arguments[1]:void 0,i=0;i<len;i++)i in t&&fun.call(thisArg,t[i],i,t);return this}),Array.prototype.filter||(Array.prototype.filter=function(fun,thisArg){var a=[];return this.forEach(function(val,i,t){fun.call(thisArg||void 0,val,i,t)&&a.push(val)}),a}),Array.prototype.map||(Array.prototype.map=function(fun,thisArg){var a=[];return this.forEach(function(val,i,t){a.push(fun.call(thisArg||void 0,val,i,t))}),a}),Array.isArray||(Array.isArray=function(o){return"[object Array]"===Object.prototype.toString.call(o)}),"object"!=typeof window||"object"!=typeof window.location||window.location.assign||(window.location.assign=function(url){window.location=url}),Function.prototype.bind||(Function.prototype.bind=function(b){function C(){}if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var a=[].slice,f=a.call(arguments,1),_this=this,D=function(){return _this.apply(this instanceof C?this:b||window,f.concat(a.call(arguments)))};return C.prototype=this.prototype,D.prototype=new C,D});var hello=function(name){return hello.use(name)};hello.utils={extend:function(r){return Array.prototype.slice.call(arguments,1).forEach(function(a){if(Array.isArray(r)&&Array.isArray(a))Array.prototype.push.apply(r,a);else if(r instanceof Object&&a instanceof Object&&r!==a)for(var x in a)r[x]=hello.utils.extend(r[x],a[x]);else Array.isArray(a)&&(a=a.slice(0)),r=a}),r}},hello.utils.extend(hello,{settings:{redirect_uri:window.location.href.split("#")[0],response_type:"token",display:"popup",state:"",oauth_proxy:"https://auth-server.herokuapp.com/proxy",timeout:2e4,popup:{resizable:1,scrollbars:1,width:500,height:550},scope:["basic"],scope_map:{basic:""},default_service:null,force:null,page_uri:window.location.href},services:{},use:function(service){var self=Object.create(this);return self.settings=Object.create(this.settings),service&&(self.settings.default_service=service),self.utils.Event.call(self),self},init:function(services,options){var utils=this.utils;if(!services)return this.services;for(var x in services)services.hasOwnProperty(x)&&"object"!=typeof services[x]&&(services[x]={id:services[x]});return utils.extend(this.services,services),options&&(utils.extend(this.settings,options),"redirect_uri"in options&&(this.settings.redirect_uri=utils.url(options.redirect_uri).href)),this},login:function(){function emit(s,value){hello.emit(s,value)}function encodeFunction(s){return s}function filterEmpty(s){return!!s}var url,_this=this,utils=_this.utils,error=utils.error,promise=utils.Promise(),p=utils.args({network:"s",options:"o",callback:"f"},arguments),qs=utils.diffKey(p.options,_this.settings),opts=p.options=utils.merge(_this.settings,p.options||{});if(opts.popup=utils.merge(_this.settings.popup,p.options.popup||{}),p.network=p.network||_this.settings.default_service,promise.proxy.then(p.callback,p.callback),promise.proxy.then(emit.bind(this,"auth.login auth"),emit.bind(this,"auth.failed auth")),"string"!=typeof p.network||!(p.network in _this.services))return promise.reject(error("invalid_network","The provided network was not recognized"));var provider=_this.services[p.network],callbackId=utils.globalEvent(function(str){var obj;obj=str?JSON.parse(str):error("cancelled","The authentication was not completed"),obj.error?promise.reject(obj):(utils.store(obj.network,obj),promise.fulfill({network:obj.network,authResponse:obj}))}),redirectUri=utils.url(opts.redirect_uri).href,responseType=provider.oauth.response_type||opts.response_type;/\bcode\b/.test(responseType)&&!provider.oauth.grant&&(responseType=responseType.replace(/\bcode\b/,"token")),p.qs=utils.merge(qs,{client_id:encodeURIComponent(provider.id),response_type:encodeURIComponent(responseType),redirect_uri:encodeURIComponent(redirectUri),state:{client_id:provider.id,network:p.network,display:opts.display,callback:callbackId,state:opts.state,redirect_uri:redirectUri}});var session=utils.store(p.network),SCOPE_SPLIT=/[,\s]+/,scope=_this.settings.scope?[_this.settings.scope.toString()]:[],scopeMap=utils.merge(_this.settings.scope_map,provider.scope||{});if(opts.scope&&scope.push(opts.scope.toString()),session&&"scope"in session&&session.scope instanceof String&&scope.push(session.scope),scope=scope.join(",").split(SCOPE_SPLIT),scope=utils.unique(scope).filter(filterEmpty),p.qs.state.scope=scope.join(","),scope=scope.map(function(item){return item in scopeMap?scopeMap[item]:item}),scope=scope.join(",").split(SCOPE_SPLIT),scope=utils.unique(scope).filter(filterEmpty),p.qs.scope=scope.join(provider.scope_delim||","),opts.force===!1&&session&&"access_token"in session&&session.access_token&&"expires"in session&&session.expires>(new Date).getTime()/1e3){var diff=utils.diff((session.scope||"").split(SCOPE_SPLIT),(p.qs.state.scope||"").split(SCOPE_SPLIT));if(0===diff.length)return promise.fulfill({unchanged:!0,network:p.network,authResponse:session}),promise}if("page"===opts.display&&opts.page_uri&&(p.qs.state.page_uri=utils.url(opts.page_uri).href),"login"in provider&&"function"==typeof provider.login&&provider.login(p),(!/\btoken\b/.test(responseType)||parseInt(provider.oauth.version,10)<2||"none"===opts.display&&provider.oauth.grant&&session&&session.refresh_token)&&(p.qs.state.oauth=provider.oauth,p.qs.state.oauth_proxy=opts.oauth_proxy),p.qs.state=encodeURIComponent(JSON.stringify(p.qs.state)),1===parseInt(provider.oauth.version,10)?url=utils.qs(opts.oauth_proxy,p.qs,encodeFunction):"none"===opts.display&&provider.oauth.grant&&session&&session.refresh_token?(p.qs.refresh_token=session.refresh_token,url=utils.qs(opts.oauth_proxy,p.qs,encodeFunction)):url=utils.qs(provider.oauth.auth,p.qs,encodeFunction),emit("auth.init",p),"none"===opts.display)utils.iframe(url,redirectUri);else if("popup"===opts.display)var popup=utils.popup(url,redirectUri,opts.popup),timer=setInterval(function(){if((!popup||popup.closed)&&(clearInterval(timer),!promise.state)){var response=error("cancelled","Login has been cancelled");popup||(response=error("blocked","Popup was blocked")),response.network=p.network,promise.reject(response)}},100);else window.location=url;return promise.proxy},logout:function(){function emit(s,value){hello.emit(s,value)}var _this=this,utils=_this.utils,error=utils.error,promise=utils.Promise(),p=utils.args({name:"s",options:"o",callback:"f"},arguments);if(p.options=p.options||{},promise.proxy.then(p.callback,p.callback),promise.proxy.then(emit.bind(this,"auth.logout auth"),emit.bind(this,"error")),p.name=p.name||this.settings.default_service,p.authResponse=utils.store(p.name),!p.name||p.name in _this.services)if(p.name&&p.authResponse){var callback=function(opts){utils.store(p.name,null),promise.fulfill(hello.utils.merge({network:p.name},opts||{}))},_opts={};if(p.options.force){var logout=_this.services[p.name].logout;if(logout)if("function"==typeof logout&&(logout=logout(callback,p)),"string"==typeof logout)utils.iframe(logout),_opts.force=null,_opts.message="Logout success on providers site was indeterminate";else if(void 0===logout)return promise.proxy}callback(_opts)}else promise.reject(error("invalid_session","There was no session to remove"));else promise.reject(error("invalid_network","The network was unrecognized"));return promise.proxy},getAuthResponse:function(service){return service=service||this.settings.default_service,service&&service in this.services?this.utils.store(service)||null:null},events:{}}),hello.utils.extend(hello.utils,{error:function(code,message){return{error:{code:code,message:message}}},qs:function(url,params,formatFunction){if(params){formatFunction=formatFunction||encodeURIComponent;for(var x in params){var str="([\\?\\&])"+x+"=[^\\&]*",reg=new RegExp(str);url.match(reg)&&(url=url.replace(reg,"$1"+x+"="+formatFunction(params[x])),delete params[x])}}return this.isEmpty(params)?url:url+(url.indexOf("?")>-1?"&":"?")+this.param(params,formatFunction)},param:function(s,formatFunction){var b,m,a={};if("string"==typeof s){if(formatFunction=formatFunction||decodeURIComponent,m=s.replace(/^[\#\?]/,"").match(/([^=\/\&]+)=([^\&]+)/g))for(var i=0;i<m.length;i++)b=m[i].match(/([^=]+)=(.*)/),a[b[1]]=formatFunction(b[2]);return a}formatFunction=formatFunction||encodeURIComponent;var o=s;a=[];for(var x in o)o.hasOwnProperty(x)&&o.hasOwnProperty(x)&&a.push([x,"?"===o[x]?"?":formatFunction(o[x])].join("="));return a.join("&")},store:function(){function get(){var json={};try{json=JSON.parse(localStorage.getItem("hello"))||{}}catch(e){}return json}function set(json){localStorage.setItem("hello",JSON.stringify(json))}for(var localStorage,a=["localStorage","sessionStorage"],i=-1,prefix="test";a[++i];)try{localStorage=window[a[i]],localStorage.setItem(prefix+i,i),localStorage.removeItem(prefix+i);break}catch(e){localStorage=null}if(!localStorage){var cache=null;localStorage={getItem:function(prop){prop+="=";for(var m=document.cookie.split(";"),i=0;i<m.length;i++){var _m=m[i].replace(/(^\s+|\s+$)/,"");if(_m&&0===_m.indexOf(prop))return _m.substr(prop.length)}return cache},setItem:function(prop,value){cache=value,document.cookie=prop+"="+value}},cache=localStorage.getItem("hello")}return function(name,value,days){var json=get();if(name&&void 0===value)return json[name]||null;if(name&&null===value)try{delete json[name]}catch(e){json[name]=null}else{if(!name)return json;json[name]=value}return set(json),json||null}}(),append:function(node,attr,target){var n="string"==typeof node?document.createElement(node):node;if("object"==typeof attr)if("tagName"in attr)target=attr;else for(var x in attr)if(attr.hasOwnProperty(x))if("object"==typeof attr[x])for(var y in attr[x])attr[x].hasOwnProperty(y)&&(n[x][y]=attr[x][y]);else"html"===x?n.innerHTML=attr[x]:/^on/.test(x)?n[x]=attr[x]:n.setAttribute(x,attr[x]);return"body"===target?!function self(){
document.body?document.body.appendChild(n):setTimeout(self,16)}():"object"==typeof target?target.appendChild(n):"string"==typeof target&&document.getElementsByTagName(target)[0].appendChild(n),n},iframe:function(src){this.append("iframe",{src:src,style:{position:"absolute",left:"-1000px",bottom:0,height:"1px",width:"1px"}},"body")},merge:function(){var args=Array.prototype.slice.call(arguments);return args.unshift({}),this.extend.apply(null,args)},args:function(o,args){var p={},i=0,t=null,x=null;for(x in o)if(o.hasOwnProperty(x))break;if(1===args.length&&"object"==typeof args[0]&&"o!"!=o[x])for(x in args[0])if(o.hasOwnProperty(x)&&x in o)return args[0];for(x in o)if(o.hasOwnProperty(x))if(t=typeof args[i],"function"==typeof o[x]&&o[x].test(args[i])||"string"==typeof o[x]&&(o[x].indexOf("s")>-1&&"string"===t||o[x].indexOf("o")>-1&&"object"===t||o[x].indexOf("i")>-1&&"number"===t||o[x].indexOf("a")>-1&&"object"===t||o[x].indexOf("f")>-1&&"function"===t))p[x]=args[i++];else if("string"==typeof o[x]&&o[x].indexOf("!")>-1)return!1;return p},url:function(path){if(path){if(window.URL&&URL instanceof Function&&0!==URL.length)return new URL(path,window.location);var a=document.createElement("a");return a.href=path,a.cloneNode(!1)}return window.location},diff:function(a,b){return b.filter(function(item){return a.indexOf(item)===-1})},diffKey:function(a,b){if(a||!b){var r={};for(var x in a)x in b||(r[x]=a[x]);return r}return a},unique:function(a){return Array.isArray(a)?a.filter(function(item,index){return a.indexOf(item)===index}):[]},isEmpty:function(obj){if(!obj)return!0;if(Array.isArray(obj))return!obj.length;if("object"==typeof obj)for(var key in obj)if(obj.hasOwnProperty(key))return!1;return!0},Promise:function(){var STATE_PENDING=0,STATE_FULFILLED=1,STATE_REJECTED=2,api=function(executor){return this instanceof api?(this.id="Thenable/1.0.6",this.state=STATE_PENDING,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},void("function"==typeof executor&&executor.call(this,this.fulfill.bind(this),this.reject.bind(this)))):new api(executor)};api.prototype={fulfill:function(value){return deliver(this,STATE_FULFILLED,"fulfillValue",value)},reject:function(value){return deliver(this,STATE_REJECTED,"rejectReason",value)},then:function(onFulfilled,onRejected){var curr=this,next=new api;return curr.onFulfilled.push(resolver(onFulfilled,next,"fulfill")),curr.onRejected.push(resolver(onRejected,next,"reject")),execute(curr),next.proxy}};var deliver=function(curr,state,name,value){return curr.state===STATE_PENDING&&(curr.state=state,curr[name]=value,execute(curr)),curr},execute=function(curr){curr.state===STATE_FULFILLED?execute_handlers(curr,"onFulfilled",curr.fulfillValue):curr.state===STATE_REJECTED&&execute_handlers(curr,"onRejected",curr.rejectReason)},execute_handlers=function(curr,name,value){if(0!==curr[name].length){var handlers=curr[name];curr[name]=[];var func=function(){for(var i=0;i<handlers.length;i++)handlers[i](value)};"object"==typeof process&&"function"==typeof process.nextTick?process.nextTick(func):"function"==typeof setImmediate?setImmediate(func):setTimeout(func,0)}},resolver=function(cb,next,method){return function(value){if("function"!=typeof cb)next[method].call(next,value);else{var result;try{result=cb(value)}catch(e){return void next.reject(e)}resolve(next,result)}}},resolve=function(promise,x){if(promise===x||promise.proxy===x)return void promise.reject(new TypeError("cannot resolve promise with itself"));var then;if("object"==typeof x&&null!==x||"function"==typeof x)try{then=x.then}catch(e){return void promise.reject(e)}if("function"!=typeof then)promise.fulfill(x);else{var resolved=!1;try{then.call(x,function(y){resolved||(resolved=!0,y===x?promise.reject(new TypeError("circular thenable chain")):resolve(promise,y))},function(r){resolved||(resolved=!0,promise.reject(r))})}catch(e){resolved||promise.reject(e)}}};return api}(),Event:function(){var separator=/[\s\,]+/;return this.parent={events:this.events,findEvents:this.findEvents,parent:this.parent,utils:this.utils},this.events={},this.on=function(evt,callback){if(callback&&"function"==typeof callback)for(var a=evt.split(separator),i=0;i<a.length;i++)this.events[a[i]]=[callback].concat(this.events[a[i]]||[]);return this},this.off=function(evt,callback){return this.findEvents(evt,function(name,index){callback&&this.events[name][index]!==callback||(this.events[name][index]=null)}),this},this.emit=function(evt){var args=Array.prototype.slice.call(arguments,1);args.push(evt);for(var handler=function(name,index){args[args.length-1]="*"===name?evt:name,this.events[name][index].apply(this,args)},_this=this;_this&&_this.findEvents;)_this.findEvents(evt+",*",handler),_this=_this.parent;return this},this.emitAfter=function(){var _this=this,args=arguments;return setTimeout(function(){_this.emit.apply(_this,args)},0),this},this.findEvents=function(evt,callback){var a=evt.split(separator);for(var name in this.events)if(this.events.hasOwnProperty(name)&&a.indexOf(name)>-1)for(var i=0;i<this.events[name].length;i++)this.events[name][i]&&callback.call(this,name,i)},this},globalEvent:function(callback,guid){return guid=guid||"_hellojs_"+parseInt(1e12*Math.random(),10).toString(36),window[guid]=function(){try{callback.apply(this,arguments)&&delete window[guid]}catch(e){console.error(e)}},guid},popup:function(url,redirectUri,options){var documentElement=document.documentElement;if(options.height){var dualScreenTop=void 0!==window.screenTop?window.screenTop:screen.top,height=screen.height||window.innerHeight||documentElement.clientHeight;options.top=parseInt((height-options.height)/2,10)+dualScreenTop}if(options.width){var dualScreenLeft=void 0!==window.screenLeft?window.screenLeft:screen.left,width=screen.width||window.innerWidth||documentElement.clientWidth;options.left=parseInt((width-options.width)/2,10)+dualScreenLeft}var optionsArray=[];Object.keys(options).forEach(function(name){var value=options[name];optionsArray.push(name+(null!==value?"="+value:""))}),navigator.userAgent.indexOf("Safari")!==-1&&navigator.userAgent.indexOf("Chrome")===-1&&(url=redirectUri+"#oauth_redirect="+encodeURIComponent(encodeURIComponent(url)));var popup=window.open(url,"_blank",optionsArray.join(","));return popup&&popup.focus&&popup.focus(),popup},responseHandler:function(window,parent){function authCallback(obj,window,parent){var cb=obj.callback,network=obj.network;if(_this.store(network,obj),!("display"in obj&&"page"===obj.display)){if(parent&&cb&&cb in parent){try{delete obj.callback}catch(e){}_this.store(network,obj);var str=JSON.stringify(obj);try{callback(parent,cb)(str)}catch(e){}}closeWindow()}}function callback(parent,callbackID){return 0!==callbackID.indexOf("_hellojs_")?function(){throw"Could not execute callback "+callbackID}:parent[callbackID]}function closeWindow(){if(window.frameElement)parent.document.body.removeChild(window.frameElement);else{try{window.close()}catch(e){}window.addEventListener&&window.addEventListener("load",function(){window.close()})}}var p,_this=this,location=window.location;if(p=_this.param(location.search),p&&p.state&&(p.code||p.oauth_token)){var state=JSON.parse(p.state);p.redirect_uri=state.redirect_uri||location.href.replace(/[\?\#].*$/,"");var path=state.oauth_proxy+"?"+_this.param(p);return void location.assign(path)}if(p=_this.merge(_this.param(location.search||""),_this.param(location.hash||"")),p&&"state"in p){try{var a=JSON.parse(p.state);_this.extend(p,a)}catch(e){console.error("Could not decode state parameter")}if("access_token"in p&&p.access_token&&p.network)p.expires_in&&0!==parseInt(p.expires_in,10)||(p.expires_in=0),p.expires_in=parseInt(p.expires_in,10),p.expires=(new Date).getTime()/1e3+(p.expires_in||31536e3),authCallback(p,window,parent);else if("error"in p&&p.error&&p.network)p.error={code:p.error,message:p.error_message||p.error_description},authCallback(p,window,parent);else if(p.callback&&p.callback in parent){var res=!!("result"in p&&p.result)&&JSON.parse(p.result);callback(parent,p.callback)(res),closeWindow()}p.page_uri&&location.assign(p.page_uri)}else if("oauth_redirect"in p)return void location.assign(decodeURIComponent(p.oauth_redirect))}}),hello.utils.Event.call(hello),function(hello){var oldSessions={},expired={};hello.on("auth.login, auth.logout",function(auth){auth&&"object"==typeof auth&&auth.network&&(oldSessions[auth.network]=hello.utils.store(auth.network)||{})}),function self(){var CURRENT_TIME=(new Date).getTime()/1e3,emit=function(eventName){hello.emit("auth."+eventName,{network:name,authResponse:session})};for(var name in hello.services)if(hello.services.hasOwnProperty(name)){if(!hello.services[name].id)continue;var session=hello.utils.store(name)||{},provider=hello.services[name],oldSess=oldSessions[name]||{};if(session&&"callback"in session){var cb=session.callback;try{delete session.callback}catch(e){}hello.utils.store(name,session);try{window[cb](session)}catch(e){}}if(session&&"expires"in session&&session.expires<CURRENT_TIME){var refresh=provider.refresh||session.refresh_token;!refresh||name in expired&&!(expired[name]<CURRENT_TIME)?refresh||name in expired||(emit("expired"),expired[name]=!0):(hello.emit("notice",name+" has expired trying to resignin"),hello.login(name,{display:"none",force:!1}),expired[name]=CURRENT_TIME+600);continue}if(oldSess.access_token===session.access_token&&oldSess.expires===session.expires)continue;!session.access_token&&oldSess.access_token?emit("logout"):session.access_token&&!oldSess.access_token?emit("login"):session.expires!==oldSess.expires&&emit("update"),oldSessions[name]=session,name in expired&&delete expired[name]}setTimeout(self,1e3)}()}(hello),hello.api=function(){function getPath(url){url=url.replace(/\@\{([a-z\_\-]+)(\|.*?)?\}/gi,function(m,key,defaults){var val=defaults?defaults.replace(/^\|/,""):"";return key in p.query?(val=p.query[key],delete p.query[key]):p.data&&key in p.data?(val=p.data[key],delete p.data[key]):defaults||promise.reject(error("missing_attribute","The attribute "+key+" is missing from the request")),val}),url.match(/^https?:\/\//)||(url=o.base+url),p.url=url,utils.request(p,function(r,headers){if(!p.formatResponse)return void(("object"==typeof headers?headers.statusCode>=400:"object"==typeof r&&"error"in r)?promise.reject(r):promise.fulfill(r));if(r===!0?r={success:!0}:r||(r={}),"delete"===p.method&&(r=!r||utils.isEmpty(r)?{success:!0}:r),o.wrap&&(p.path in o.wrap||"default"in o.wrap)){var wrap=p.path in o.wrap?p.path:"default",b=((new Date).getTime(),o.wrap[wrap](r,headers,p));b&&(r=b)}r&&"paging"in r&&r.paging.next&&("?"===r.paging.next[0]?r.paging.next=p.path+r.paging.next:r.paging.next+="#"+p.path),!r||"error"in r?promise.reject(r):promise.fulfill(r)})}var _this=this,utils=_this.utils,error=utils.error,promise=utils.Promise(),p=utils.args({path:"s!",query:"o",method:"s",data:"o",timeout:"i",callback:"f"},arguments);p.method=(p.method||"get").toLowerCase(),p.headers=p.headers||{},p.query=p.query||{},"get"!==p.method&&"delete"!==p.method||(utils.extend(p.query,p.data),p.data={});var data=p.data=p.data||{};if(promise.then(p.callback,p.callback),!p.path)return promise.reject(error("invalid_path","Missing the path parameter from the request"));p.path=p.path.replace(/^\/+/,"");var a=(p.path.split(/[\/\:]/,2)||[])[0].toLowerCase();if(a in _this.services){p.network=a;var reg=new RegExp("^"+a+":?/?");p.path=p.path.replace(reg,"")}p.network=_this.settings.default_service=p.network||_this.settings.default_service;var o=_this.services[p.network];if(!o)return promise.reject(error("invalid_network","Could not match the service requested: "+p.network));if(p.method in o&&p.path in o[p.method]&&o[p.method][p.path]===!1)return promise.reject(error("invalid_path","The provided path is not available on the selected network"));p.oauth_proxy||(p.oauth_proxy=_this.settings.oauth_proxy),"proxy"in p||(p.proxy=p.oauth_proxy&&o.oauth&&1===parseInt(o.oauth.version,10)),"timeout"in p||(p.timeout=_this.settings.timeout),"formatResponse"in p||(p.formatResponse=!0),p.authResponse=_this.getAuthResponse(p.network),p.authResponse&&p.authResponse.access_token&&(p.query.access_token=p.authResponse.access_token);var m,url=p.path;p.options=utils.clone(p.query),p.data=utils.clone(data);var actions=o[{delete:"del"}[p.method]||p.method]||{};if("get"===p.method){var query=url.split(/[\?#]/)[1];query&&(utils.extend(p.query,utils.param(query)),url=url.replace(/\?.*?(#|$)/,"$1"))}return(m=url.match(/#(.+)/,""))?(url=url.split("#")[0],p.path=m[1]):url in actions?(p.path=url,url=actions[url]):"default"in actions&&(url=actions.default),p.redirect_uri=_this.settings.redirect_uri,p.xhr=o.xhr,p.jsonp=o.jsonp,p.form=o.form,"function"==typeof url?url(p,getPath):getPath(url),promise.proxy},hello.utils.extend(hello.utils,{request:function(p,callback){function formatUrl(p,callback){var sign;p.authResponse&&p.authResponse.oauth&&1===parseInt(p.authResponse.oauth.version,10)&&(sign=p.query.access_token,delete p.query.access_token,p.proxy=!0),!p.data||"get"!==p.method&&"delete"!==p.method||(_this.extend(p.query,p.data),p.data=null);var path=_this.qs(p.url,p.query);p.proxy&&(path=_this.qs(p.oauth_proxy,{path:path,access_token:sign||"",then:p.proxy_response_type||("get"===p.method.toLowerCase()?"redirect":"proxy"),method:p.method.toLowerCase(),suppress_response_codes:!0})),callback(path)}var _this=this,error=_this.error;_this.isEmpty(p.data)||"FileList"in window||!_this.hasBinary(p.data)||(p.xhr=!1,p.jsonp=!1);var cors=this.request_cors(function(){return void 0===p.xhr||p.xhr&&("function"!=typeof p.xhr||p.xhr(p,p.query))});if(cors)return void formatUrl(p,function(url){var x=_this.xhr(p.method,url,p.headers,p.data,callback);x.onprogress=p.onprogress||null,x.upload&&p.onuploadprogress&&(x.upload.onprogress=p.onuploadprogress)});var _query=p.query;if(p.query=_this.clone(p.query),p.callbackID=_this.globalEvent(),p.jsonp!==!1){if(p.query.callback=p.callbackID,"function"==typeof p.jsonp&&p.jsonp(p,p.query),"get"===p.method)return void formatUrl(p,function(url){_this.jsonp(url,callback,p.callbackID,p.timeout)});p.query=_query}if(p.form!==!1){p.query.redirect_uri=p.redirect_uri,p.query.state=JSON.stringify({callback:p.callbackID});var opts;if("function"==typeof p.form&&(opts=p.form(p,p.query)),"post"===p.method&&opts!==!1)return void formatUrl(p,function(url){_this.post(url,p.data,opts,callback,p.callbackID,p.timeout)})}callback(error("invalid_request","There was no mechanism for handling this request"))},request_cors:function(callback){return"withCredentials"in new XMLHttpRequest&&callback()},domInstance:function(type,data){var test="HTML"+(type||"").replace(/^[a-z]/,function(m){return m.toUpperCase()})+"Element";return!!data&&(window[test]?data instanceof window[test]:window.Element?data instanceof window.Element&&(!type||data.tagName&&data.tagName.toLowerCase()===type):!(data instanceof Object||data instanceof Array||data instanceof String||data instanceof Number)&&data.tagName&&data.tagName.toLowerCase()===type)},clone:function(obj){if(null===obj||"object"!=typeof obj||obj instanceof Date||"nodeName"in obj||this.isBinary(obj)||"function"==typeof FormData&&obj instanceof FormData)return obj;if(Array.isArray(obj))return obj.map(this.clone.bind(this));var clone={};for(var x in obj)clone[x]=this.clone(obj[x]);return clone},xhr:function(method,url,headers,data,callback){function headersToJSON(s){for(var m,r={},reg=/([a-z\-]+):\s?(.*);?/gi;m=reg.exec(s);)r[m[1]]=m[2];return r}var r=new XMLHttpRequest,error=this.error,binary=!1;"blob"===method&&(binary=method,method="GET"),method=method.toUpperCase(),r.onload=function(e){var json=r.response;try{json=JSON.parse(r.responseText)}catch(_e){401===r.status&&(json=error("access_denied",r.statusText))}var headers=headersToJSON(r.getAllResponseHeaders());headers.statusCode=r.status,callback(json||("GET"===method?error("empty_response","Could not get resource"):{}),headers)},r.onerror=function(e){var json=r.responseText;try{json=JSON.parse(r.responseText)}catch(_e){}callback(json||error("access_denied","Could not get resource"))};var x;if("GET"===method||"DELETE"===method)data=null;else if(data&&"string"!=typeof data&&!(data instanceof FormData)&&!(data instanceof File)&&!(data instanceof Blob)){var f=new FormData;for(x in data)data.hasOwnProperty(x)&&(data[x]instanceof HTMLInputElement?"files"in data[x]&&data[x].files.length>0&&f.append(x,data[x].files[0]):data[x]instanceof Blob?f.append(x,data[x],data.name):f.append(x,data[x]));data=f}if(r.open(method,url,!0),binary&&("responseType"in r?r.responseType=binary:r.overrideMimeType("text/plain; charset=x-user-defined")),headers)for(x in headers)r.setRequestHeader(x,headers[x]);return r.send(data),r},jsonp:function(url,callback,callbackID,timeout){var operaFix,_this=this,error=_this.error,bool=0,head=document.getElementsByTagName("head")[0],result=error("server_error","server_error"),cb=function(){bool++||window.setTimeout(function(){callback(result),head.removeChild(script)},0)};callbackID=_this.globalEvent(function(json){return result=json,!0},callbackID),url=url.replace(new RegExp("=\\?(&|$)"),"="+callbackID+"$1");var script=_this.append("script",{id:callbackID,name:callbackID,src:url,async:!0,onload:cb,onerror:cb,onreadystatechange:function(){/loaded|complete/i.test(this.readyState)&&cb()}});window.navigator.userAgent.toLowerCase().indexOf("opera")>-1&&(operaFix=_this.append("script",{text:"document.getElementById('"+callbackID+"').onerror();"}),script.async=!1),timeout&&window.setTimeout(function(){result=error("timeout","timeout"),cb()},timeout),head.appendChild(script),operaFix&&head.appendChild(operaFix)},post:function(url,data,options,callback,callbackID,timeout){var newform,_this=this,error=_this.error,doc=document,form=null,reenableAfterSubmit=[],i=0,x=null,bool=0,cb=function(r){bool++||callback(r)};_this.globalEvent(cb,callbackID);var win;try{win=doc.createElement('<iframe name="'+callbackID+'">')}catch(e){win=doc.createElement("iframe")}if(win.name=callbackID,win.id=callbackID,win.style.display="none",options&&options.callbackonload&&(win.onload=function(){cb({response:"posted",message:"Content was posted"})}),timeout&&setTimeout(function(){cb(error("timeout","The post operation timed out"))},timeout),doc.body.appendChild(win),_this.domInstance("form",data)){for(form=data.form,i=0;i<form.elements.length;i++)form.elements[i]!==data&&form.elements[i].setAttribute("disabled",!0);data=form}if(_this.domInstance("form",data))for(form=data,i=0;i<form.elements.length;i++)form.elements[i].disabled||"file"!==form.elements[i].type||(form.encoding=form.enctype="multipart/form-data",form.elements[i].setAttribute("name","file"));else{for(x in data)data.hasOwnProperty(x)&&_this.domInstance("input",data[x])&&"file"===data[x].type&&(form=data[x].form,form.encoding=form.enctype="multipart/form-data");form||(form=doc.createElement("form"),doc.body.appendChild(form),newform=form);var input;for(x in data)if(data.hasOwnProperty(x)){var el=_this.domInstance("input",data[x])||_this.domInstance("textArea",data[x])||_this.domInstance("select",data[x]);if(el&&data[x].form===form)el&&data[x].name!==x&&(data[x].setAttribute("name",x),data[x].name=x);else{var inputs=form.elements[x];if(input)for(inputs instanceof NodeList||(inputs=[inputs]),i=0;i<inputs.length;i++)inputs[i].parentNode.removeChild(inputs[i]);input=doc.createElement("input"),input.setAttribute("type","hidden"),input.setAttribute("name",x),el?input.value=data[x].value:_this.domInstance(null,data[x])?input.value=data[x].innerHTML||data[x].innerText:input.value=data[x],form.appendChild(input)}}for(i=0;i<form.elements.length;i++)input=form.elements[i],input.name in data||input.getAttribute("disabled")===!0||(input.setAttribute("disabled",!0),reenableAfterSubmit.push(input))}form.setAttribute("method","POST"),form.setAttribute("target",callbackID),form.target=callbackID,form.setAttribute("action",url),setTimeout(function(){form.submit(),setTimeout(function(){try{newform&&newform.parentNode.removeChild(newform)}catch(e){try{console.error("HelloJS: could not remove iframe")}catch(ee){}}for(var i=0;i<reenableAfterSubmit.length;i++)reenableAfterSubmit[i]&&(reenableAfterSubmit[i].setAttribute("disabled",!1),reenableAfterSubmit[i].disabled=!1)},0)},100)},hasBinary:function(data){for(var x in data)if(data.hasOwnProperty(x)&&this.isBinary(data[x]))return!0;return!1},isBinary:function(data){return data instanceof Object&&(this.domInstance("input",data)&&"file"===data.type||"FileList"in window&&data instanceof window.FileList||"File"in window&&data instanceof window.File||"Blob"in window&&data instanceof window.Blob)},toBlob:function(dataURI){var reg=/^data\:([^;,]+(\;charset=[^;,]+)?)(\;base64)?,/i,m=dataURI.match(reg);if(!m)return dataURI;for(var binary=atob(dataURI.replace(reg,"")),array=[],i=0;i<binary.length;i++)array.push(binary.charCodeAt(i));return new Blob([new Uint8Array(array)],{type:m[1]})}}),function(hello){var api=hello.api,utils=hello.utils;utils.extend(utils,{dataToJSON:function(p){var _this=this,w=window,data=p.data;if(_this.domInstance("form",data)?data=_this.nodeListToJSON(data.elements):"NodeList"in w&&data instanceof NodeList?data=_this.nodeListToJSON(data):_this.domInstance("input",data)&&(data=_this.nodeListToJSON([data])),("File"in w&&data instanceof w.File||"Blob"in w&&data instanceof w.Blob||"FileList"in w&&data instanceof w.FileList)&&(data={file:data}),!("FormData"in w&&data instanceof w.FormData))for(var x in data)if(data.hasOwnProperty(x))if("FileList"in w&&data[x]instanceof w.FileList)1===data[x].length&&(data[x]=data[x][0]);else{if(_this.domInstance("input",data[x])&&"file"===data[x].type)continue;_this.domInstance("input",data[x])||_this.domInstance("select",data[x])||_this.domInstance("textArea",data[x])?data[x]=data[x].value:_this.domInstance(null,data[x])&&(data[x]=data[x].innerHTML||data[x].innerText)}return p.data=data,data},nodeListToJSON:function(nodelist){for(var json={},i=0;i<nodelist.length;i++){var input=nodelist[i];!input.disabled&&input.name&&("file"===input.type?json[input.name]=input:json[input.name]=input.value||input.innerHTML)}return json}}),hello.api=function(){var p=utils.args({path:"s!",method:"s",data:"o",timeout:"i",callback:"f"},arguments);return p.data&&utils.dataToJSON(p),api.call(this,p)}}(hello),hello.utils.responseHandler(window,window.opener||window.parent),"object"==typeof chrome&&"object"==typeof chrome.identity&&chrome.identity.launchWebAuthFlow&&!function(){function _open(url,interactive){var ref={closed:!1};return chrome.identity.launchWebAuthFlow({url:url,interactive:interactive},function(responseUrl){if(void 0===responseUrl)return void(ref.closed=!0);var a=hello.utils.url(responseUrl),_popup={location:{assign:function(url){_open(url,!1)},search:a.search,hash:a.hash,href:a.href},close:function(){}};hello.utils.responseHandler(_popup,window)}),ref}hello.utils.popup=function(url){return _open(url,!0)},hello.utils.iframe=function(url){_open(url,!1)},hello.utils.request_cors=function(callback){return callback(),!0};var _cache={};chrome.storage.local.get("hello",function(r){_cache=r.hello||{}}),hello.utils.store=function(name,value){return 0===arguments.length?_cache:1===arguments.length?_cache[name]||null:value?(_cache[name]=value,chrome.storage.local.set({hello:_cache}),value):null===value?(delete _cache[name],chrome.storage.local.set({hello:_cache}),null):void 0}}(),function(){if(/^file:\/{3}[^\/]/.test(window.location.href)&&window.cordova){hello.utils.iframe=function(url,redirectUri){hello.utils.popup(url,redirectUri,{hidden:"yes"})};var utilPopup=hello.utils.popup;hello.utils.popup=function(url,redirectUri,options){var popup=utilPopup.call(this,url,redirectUri,options);try{if(popup&&popup.addEventListener){var a=hello.utils.url(redirectUri),redirectUriOrigin=a.origin||a.protocol+"//"+a.hostname;popup.addEventListener("loadstart",function(e){var url=e.url;if(0===url.indexOf(redirectUriOrigin)){var a=hello.utils.url(url),_popup={location:{assign:function(location){popup.executeScript({code:'window.location.href = "'+location+';"'})},search:a.search,hash:a.hash,href:a.href},close:function(){if(popup.close){popup.close();try{popup.closed=!0}catch(_e){}}}};hello.utils.responseHandler(_popup,window)}})}}catch(e){}return popup}}}(),function(hello){function formatError(o){o&&"error"in o&&(o.error={code:"server_error",message:o.error.message||o.error})}function formatFile(o,headers,req){if(!("object"!=typeof o||"undefined"!=typeof Blob&&o instanceof Blob||"undefined"!=typeof ArrayBuffer&&o instanceof ArrayBuffer||"error"in o)){var path=("app_folder"!==o.root?o.root:"")+o.path.replace(/\&/g,"%26");path=path.replace(/^\//,""),o.thumb_exists&&(o.thumbnail=req.oauth_proxy+"?path="+encodeURIComponent("https://api-content.dropbox.com/1/thumbnails/auto/"+path+"?format=jpeg&size=m")+"&access_token="+req.options.access_token),o.type=o.is_dir?"folder":o.mime_type,o.name=o.path.replace(/.*\//g,""),o.is_dir?o.files=path.replace(/^\//,""):(o.downloadLink=hello.settings.oauth_proxy+"?path="+encodeURIComponent("https://api-content.dropbox.com/1/files/auto/"+path)+"&access_token="+req.options.access_token,o.file="https://api-content.dropbox.com/1/files/auto/"+path),o.id||(o.id=o.path.replace(/^\//,""))}}function req(str){return function(p,cb){delete p.query.limit,cb(str)}}var OAuth1Settings={version:"1.0",auth:"https://www.dropbox.com/1/oauth/authorize",request:"https://api.dropbox.com/1/oauth/request_token",token:"https://api.dropbox.com/1/oauth/access_token"},OAuth2Settings={version:2,auth:"https://www.dropbox.com/1/oauth2/authorize",grant:"https://api.dropbox.com/1/oauth2/token"};hello.init({dropbox:{name:"Dropbox",oauth:OAuth2Settings,login:function(p){p.qs.scope="";var redirect=decodeURIComponent(p.qs.redirect_uri);0===redirect.indexOf("http:")&&0!==redirect.indexOf("http://localhost/")?hello.services.dropbox.oauth=OAuth1Settings:hello.services.dropbox.oauth=OAuth2Settings,p.options.popup.width=1e3,p.options.popup.height=1e3},base:"https://api.dropbox.com/1/",root:"sandbox",get:{me:"account/info","me/files":req("metadata/auto/@{parent|}"),"me/folder":req("metadata/auto/@{id}"),"me/folders":req("metadata/auto/"),default:function(p,callback){p.path.match("https://api-content.dropbox.com/1/files/")&&(p.method="blob"),callback(p.path)}},post:{"me/files":function(p,callback){var path=p.data.parent,fileName=p.data.name;p.data={file:p.data.file},"string"==typeof p.data.file&&(p.data.file=hello.utils.toBlob(p.data.file)),callback("https://api-content.dropbox.com/1/files_put/auto/"+path+"/"+fileName)},"me/folders":function(p,callback){var name=p.data.name;p.data={},callback("fileops/create_folder?root=@{root|sandbox}&"+hello.utils.param({path:name}))}},del:{"me/files":"fileops/delete?root=@{root|sandbox}&path=@{id}","me/folder":"fileops/delete?root=@{root|sandbox}&path=@{id}"},wrap:{me:function(o){if(formatError(o),!o.uid)return o;o.name=o.display_name;var m=o.name.split(" ");return o.first_name=m.shift(),o.last_name=m.join(" "),o.id=o.uid,delete o.uid,delete o.display_name,o},default:function(o,headers,req){return formatError(o),o.is_dir&&o.contents&&(o.data=o.contents,delete o.contents,o.data.forEach(function(item){item.root=o.root,formatFile(item,headers,req)})),formatFile(o,headers,req),o.is_deleted&&(o.success=!0),o}},xhr:function(p){if(p.data&&p.data.file){var file=p.data.file;file&&(file.files?p.data=file.files[0]:p.data=file)}return"delete"===p.method&&(p.method="post"),!0},form:function(p,qs){delete qs.state,delete qs.redirect_uri}}})}(hello),function(hello){function formatUser(o){return o.id&&(o.thumbnail=o.picture="https://graph.facebook.com/"+o.id+"/picture"),o}function formatFriends(o){return"data"in o&&o.data.forEach(formatUser),o}function format(o,headers,req){if("boolean"==typeof o&&(o={success:o}),o&&"data"in o){var token=req.query.access_token;if(!(o.data instanceof Array)){var data=o.data;delete o.data,o.data=[data]}o.data.forEach(function(d){d.picture&&(d.thumbnail=d.picture),d.pictures=(d.images||[]).sort(function(a,b){return a.width-b.width}),d.cover_photo&&d.cover_photo.id&&(d.thumbnail=base+d.cover_photo.id+"/picture?access_token="+token),"album"===d.type&&(d.files=d.photos=base+d.id+"/photos"),d.can_upload&&(d.upload_location=base+d.id+"/photos")})}return o}hello.init({facebook:{name:"Facebook",oauth:{version:2,auth:"https://www.facebook.com/dialog/oauth/",grant:"https://graph.facebook.com/oauth/access_token"},scope:{basic:"public_profile",email:"email",share:"user_posts",birthday:"user_birthday",events:"user_events",photos:"user_photos",videos:"user_videos",friends:"user_friends",files:"user_photos,user_videos",publish_files:"user_photos,user_videos,publish_actions",publish:"publish_actions",offline_access:""},refresh:!1,login:function(p){p.options.force&&(p.qs.auth_type="reauthenticate"),p.qs.display=p.options.display||"popup"},logout:function(callback,options){var callbackID=hello.utils.globalEvent(callback),redirect=encodeURIComponent(hello.settings.redirect_uri+"?"+hello.utils.param({callback:callbackID,result:JSON.stringify({force:!0}),state:"{}"})),token=(options.authResponse||{}).access_token;if(hello.utils.iframe("https://www.facebook.com/logout.php?next="+redirect+"&access_token="+token),!token)return!1},base:"https://graph.facebook.com/v2.7/",get:{me:"me?fields=email,first_name,last_name,name,timezone,verified","me/friends":"me/friends","me/following":"me/friends","me/followers":"me/friends","me/share":"me/feed","me/like":"me/likes","me/files":"me/albums","me/albums":"me/albums?fields=cover_photo,name","me/album":"@{id}/photos?fields=picture","me/photos":"me/photos","me/photo":"@{id}","friend/albums":"@{id}/albums","friend/photos":"@{id}/photos"},post:{"me/share":"me/feed","me/photo":"@{id}"},wrap:{me:formatUser,"me/friends":formatFriends,"me/following":formatFriends,"me/followers":formatFriends,"me/albums":format,"me/photos":format,"me/files":format,default:format},xhr:function(p,qs){return"get"!==p.method&&"post"!==p.method||(qs.suppress_response_codes=!0),"post"===p.method&&p.data&&"string"==typeof p.data.file&&(p.data.file=hello.utils.toBlob(p.data.file)),!0},jsonp:function(p,qs){var m=p.method;"get"===m||hello.utils.hasBinary(p.data)?"delete"===p.method&&(qs.method="delete",p.method="post"):(p.data.method=m,p.method="get")},form:function(p){return{callbackonload:!0}}}});var base="https://graph.facebook.com/"}(hello),function(hello){function getApiUrl(method,extraParams,skipNetwork){var url=(skipNetwork?"":"flickr:")+"?method="+method+"&api_key="+hello.services.flickr.id+"&format=json";for(var param in extraParams)extraParams.hasOwnProperty(param)&&(url+="&"+param+"="+extraParams[param]);return url}function withUser(cb){var auth=hello.getAuthResponse("flickr");cb(auth&&auth.user_nsid?auth.user_nsid:null)}function sign(url,params){return params||(params={}),function(p,callback){withUser(function(userId){params.user_id=userId,callback(getApiUrl(url,params,!0))})}}function getBuddyIcon(profile,size){var url="https://www.flickr.com/images/buddyicon.gif";return profile.nsid&&profile.iconserver&&profile.iconfarm&&(url="https://farm"+profile.iconfarm+".staticflickr.com/"+profile.iconserver+"/buddyicons/"+profile.nsid+(size?"_"+size:"")+".jpg"),url}function createPhotoUrl(id,farm,server,secret,size){return size=size?"_"+size:"","https://farm"+farm+".staticflickr.com/"+server+"/"+id+"_"+secret+size+".jpg"}function formatError(o){o&&o.stat&&"ok"!=o.stat.toLowerCase()&&(o.error={code:"invalid_request",message:o.message})}function formatPhotos(o){if(o.photoset||o.photos){var set="photoset"in o?"photoset":"photos";o=checkResponse(o,set),paging(o),o.data=o.photo,delete o.photo;for(var i=0;i<o.data.length;i++){var photo=o.data[i];photo.name=photo.title,photo.picture=createPhotoUrl(photo.id,photo.farm,photo.server,photo.secret,""),photo.pictures=createPictures(photo.id,photo.farm,photo.server,photo.secret),photo.source=createPhotoUrl(photo.id,photo.farm,photo.server,photo.secret,"b"),
photo.thumbnail=createPhotoUrl(photo.id,photo.farm,photo.server,photo.secret,"m")}}return o}function createPictures(id,farm,server,secret){var NO_LIMIT=2048,sizes=[{id:"t",max:100},{id:"m",max:240},{id:"n",max:320},{id:"",max:500},{id:"z",max:640},{id:"c",max:800},{id:"b",max:1024},{id:"h",max:1600},{id:"k",max:2048},{id:"o",max:NO_LIMIT}];return sizes.map(function(size){return{source:createPhotoUrl(id,farm,server,secret,size.id),width:size.max,height:size.max}})}function checkResponse(o,key){return key in o?o=o[key]:"error"in o||(o.error={code:"invalid_request",message:o.message||"Failed to get data from Flickr"}),o}function formatFriends(o){if(formatError(o),o.contacts){o=checkResponse(o,"contacts"),paging(o),o.data=o.contact,delete o.contact;for(var i=0;i<o.data.length;i++){var item=o.data[i];item.id=item.nsid,item.name=item.realname||item.username,item.thumbnail=getBuddyIcon(item,"m")}}return o}function paging(res){res.page&&res.pages&&res.page!==res.pages&&(res.paging={next:"?page="+ ++res.page})}hello.init({flickr:{name:"Flickr",oauth:{version:"1.0a",auth:"https://www.flickr.com/services/oauth/authorize?perms=read",request:"https://www.flickr.com/services/oauth/request_token",token:"https://www.flickr.com/services/oauth/access_token"},base:"https://api.flickr.com/services/rest",get:{me:sign("flickr.people.getInfo"),"me/friends":sign("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/following":sign("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/followers":sign("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/albums":sign("flickr.photosets.getList",{per_page:"@{limit|50}"}),"me/album":sign("flickr.photosets.getPhotos",{photoset_id:"@{id}"}),"me/photos":sign("flickr.people.getPhotos",{per_page:"@{limit|50}"})},wrap:{me:function(o){if(formatError(o),o=checkResponse(o,"person"),o.id){if(o.realname){o.name=o.realname._content;var m=o.name.split(" ");o.first_name=m.shift(),o.last_name=m.join(" ")}o.thumbnail=getBuddyIcon(o,"l"),o.picture=getBuddyIcon(o,"l")}return o},"me/friends":formatFriends,"me/followers":formatFriends,"me/following":formatFriends,"me/albums":function(o){return formatError(o),o=checkResponse(o,"photosets"),paging(o),o.photoset&&(o.data=o.photoset,o.data.forEach(function(item){item.name=item.title._content,item.photos="https://api.flickr.com/services/rest"+getApiUrl("flickr.photosets.getPhotos",{photoset_id:item.id},!0)}),delete o.photoset),o},"me/photos":function(o){return formatError(o),formatPhotos(o)},default:function(o){return formatError(o),formatPhotos(o)}},xhr:!1,jsonp:function(p,qs){"get"==p.method&&(delete qs.callback,qs.jsoncallback=p.callbackID)}}})}(hello),function(hello){function formatError(o){!o.meta||400!==o.meta.code&&401!==o.meta.code||(o.error={code:"access_denied",message:o.meta.errorDetail})}function formatUser(o){o&&o.id&&(o.thumbnail=o.photo.prefix+"100x100"+o.photo.suffix,o.name=o.firstName+" "+o.lastName,o.first_name=o.firstName,o.last_name=o.lastName,o.contact&&o.contact.email&&(o.email=o.contact.email))}function formatRequest(p,qs){var token=qs.access_token;return delete qs.access_token,qs.oauth_token=token,qs.v=20121125,!0}hello.init({foursquare:{name:"Foursquare",oauth:{version:2,auth:"https://foursquare.com/oauth2/authenticate",grant:"https://foursquare.com/oauth2/access_token"},refresh:!0,base:"https://api.foursquare.com/v2/",get:{me:"users/self","me/friends":"users/self/friends","me/followers":"users/self/friends","me/following":"users/self/friends"},wrap:{me:function(o){return formatError(o),o&&o.response&&(o=o.response.user,formatUser(o)),o},default:function(o){return formatError(o),o&&"response"in o&&"friends"in o.response&&"items"in o.response.friends&&(o.data=o.response.friends.items,o.data.forEach(formatUser),delete o.response),o}},xhr:formatRequest,jsonp:formatRequest}})}(hello),function(hello){function formatError(o,headers){var code=headers?headers.statusCode:o&&"meta"in o&&"status"in o.meta&&o.meta.status;401!==code&&403!==code||(o.error={code:"access_denied",message:o.message||(o.data?o.data.message:"Could not get response")},delete o.message)}function formatUser(o){o.id&&(o.thumbnail=o.picture=o.avatar_url,o.name=o.login)}function paging(res,headers,req){if(res.data&&res.data.length&&headers&&headers.Link){var next=headers.Link.match(/<(.*?)>;\s*rel=\"next\"/);next&&(res.paging={next:next[1]})}}hello.init({github:{name:"GitHub",oauth:{version:2,auth:"https://github.com/login/oauth/authorize",grant:"https://github.com/login/oauth/access_token",response_type:"code"},scope:{email:"user:email"},base:"https://api.github.com/",get:{me:"user","me/friends":"user/following?per_page=@{limit|100}","me/following":"user/following?per_page=@{limit|100}","me/followers":"user/followers?per_page=@{limit|100}","me/like":"user/starred?per_page=@{limit|100}"},wrap:{me:function(o,headers){return formatError(o,headers),formatUser(o),o},default:function(o,headers,req){return formatError(o,headers),Array.isArray(o)&&(o={data:o}),o.data&&(paging(o,headers,req),o.data.forEach(formatUser)),o}},xhr:function(p){return"get"!==p.method&&p.data&&(p.headers=p.headers||{},p.headers["Content-Type"]="application/json","object"==typeof p.data&&(p.data=JSON.stringify(p.data))),!0}}})}(hello),function(hello){function toInt(s){return parseInt(s,10)}function formatFeed(o){return paging(o),o.data=o.items,delete o.items,o}function formatItem(o){if(!o.error)return o.name||(o.name=o.title||o.message),o.picture||(o.picture=o.thumbnailLink),o.thumbnail||(o.thumbnail=o.thumbnailLink),"application/vnd.google-apps.folder"===o.mimeType&&(o.type="folder",o.files="https://www.googleapis.com/drive/v2/files?q=%22"+o.id+"%22+in+parents"),o}function formatImage(image){return{source:image.url,width:image.width,height:image.height}}function formatPhotos(o){o.data=o.feed.entry.map(formatEntry),delete o.feed}function gEntry(o){if(paging(o),"feed"in o&&"entry"in o.feed)o.data=o.feed.entry.map(formatEntry),delete o.feed;else{if("entry"in o)return formatEntry(o.entry);"items"in o?(o.data=o.items.map(formatItem),delete o.items):formatItem(o)}return o}function formatPerson(o){o.name=o.displayName||o.name,o.picture=o.picture||(o.image?o.image.url:null),o.thumbnail=o.picture}function formatFriends(o,headers,req){paging(o);if("feed"in o&&"entry"in o.feed){for(var token=req.query.access_token,i=0;i<o.feed.entry.length;i++){var a=o.feed.entry[i];if(a.id=a.id.$t,a.name=a.title.$t,delete a.title,a.gd$email&&(a.email=a.gd$email&&a.gd$email.length>0?a.gd$email[0].address:null,a.emails=a.gd$email,delete a.gd$email),a.updated&&(a.updated=a.updated.$t),a.link){var pic=a.link.length>0?a.link[0].href:null;pic&&a.link[0].gd$etag&&(pic+=(pic.indexOf("?")>-1?"&":"?")+"access_token="+token,a.picture=pic,a.thumbnail=pic),delete a.link}a.category&&delete a.category}o.data=o.feed.entry,delete o.feed}return o}function formatEntry(a){var _a,group=a.media$group,photo=group.media$content.length?group.media$content[0]:{},mediaContent=group.media$content||[],mediaThumbnail=group.media$thumbnail||[],pictures=mediaContent.concat(mediaThumbnail).map(formatImage).sort(function(a,b){return a.width-b.width}),i=0,p={id:a.id.$t,name:a.title.$t,description:a.summary.$t,updated_time:a.updated.$t,created_time:a.published.$t,picture:photo?photo.url:null,pictures:pictures,images:[],thumbnail:photo?photo.url:null,width:photo.width,height:photo.height};if("link"in a)for(i=0;i<a.link.length;i++){var d=a.link[i];if(d.rel.match(/\#feed$/)){p.upload_location=p.files=p.photos=d.href;break}}if("category"in a&&a.category.length)for(_a=a.category,i=0;i<_a.length;i++)_a[i].scheme&&_a[i].scheme.match(/\#kind$/)&&(p.type=_a[i].term.replace(/^.*?\#/,""));return"media$thumbnail"in group&&group.media$thumbnail.length&&(_a=group.media$thumbnail,p.thumbnail=_a[0].url,p.images=_a.map(formatImage)),_a=group.media$content,_a&&_a.length&&p.images.push(formatImage(_a[0])),p}function paging(res){if("feed"in res&&res.feed.openSearch$itemsPerPage){var limit=toInt(res.feed.openSearch$itemsPerPage.$t),start=toInt(res.feed.openSearch$startIndex.$t),total=toInt(res.feed.openSearch$totalResults.$t);start+limit<total&&(res.paging={next:"?start="+(start+limit)})}else"nextPageToken"in res&&(res.paging={next:"?pageToken="+res.nextPageToken})}function Multipart(){function addFile(item){var fr=new FileReader;fr.onload=function(e){addContent(btoa(e.target.result),item.type+lineBreak+"Content-Transfer-Encoding: base64")},fr.readAsBinaryString(item)}function addContent(content,type){body.push(lineBreak+"Content-Type: "+type+lineBreak+lineBreak+content),counter--,ready()}var body=[],boundary=(1e10*Math.random()).toString(32),counter=0,lineBreak="\r\n",delim=lineBreak+"--"+boundary,ready=function(){},dataUri=/^data\:([^;,]+(\;charset=[^;,]+)?)(\;base64)?,/i;this.append=function(content,type){"string"!=typeof content&&"length"in Object(content)||(content=[content]);for(var i=0;i<content.length;i++){counter++;var item=content[i];if("undefined"!=typeof File&&item instanceof File||"undefined"!=typeof Blob&&item instanceof Blob)addFile(item);else if("string"==typeof item&&item.match(dataUri)){var m=item.match(dataUri);addContent(item.replace(dataUri,""),m[1]+lineBreak+"Content-Transfer-Encoding: base64")}else addContent(item,type)}},this.onready=function(fn){(ready=function(){0===counter&&(body.unshift(""),body.push("--"),fn(body.join(delim),boundary),body=[])})()}}function uploadDrive(p,callback){var data={};p.data&&"undefined"!=typeof HTMLInputElement&&p.data instanceof HTMLInputElement&&(p.data={file:p.data}),!p.data.name&&Object(Object(p.data.file).files).length&&"post"===p.method&&(p.data.name=p.data.file.files[0].name),"post"===p.method?p.data={title:p.data.name,parents:[{id:p.data.parent||"root"}],file:p.data.file}:(data=p.data,p.data={},data.parent&&(p.data.parents=[{id:p.data.parent||"root"}]),data.file&&(p.data.file=data.file),data.name&&(p.data.title=data.name));var file;if("file"in p.data&&(file=p.data.file,delete p.data.file,"object"==typeof file&&"files"in file&&(file=file.files),!file||!file.length))return void callback({error:{code:"request_invalid",message:"There were no files attached with this request to upload"}});var parts=new Multipart;parts.append(JSON.stringify(p.data),"application/json"),file&&parts.append(file),parts.onready(function(body,boundary){p.headers["content-type"]='multipart/related; boundary="'+boundary+'"',p.data=body,callback("upload/drive/v2/files"+(data.id?"/"+data.id:"")+"?uploadType=multipart")})}function toJSON(p){if("object"==typeof p.data)try{p.data=JSON.stringify(p.data),p.headers["content-type"]="application/json"}catch(e){}}var contactsUrl="https://www.google.com/m8/feeds/contacts/default/full?v=3.0&alt=json&max-results=@{limit|1000}&start-index=@{start|1}";hello.init({google:{name:"Google Plus",oauth:{version:2,auth:"https://accounts.google.com/o/oauth2/auth",grant:"https://accounts.google.com/o/oauth2/token"},scope:{basic:"https://www.googleapis.com/auth/plus.me profile",email:"email",birthday:"",events:"",photos:"https://picasaweb.google.com/data/",videos:"http://gdata.youtube.com",friends:"https://www.google.com/m8/feeds, https://www.googleapis.com/auth/plus.login",files:"https://www.googleapis.com/auth/drive.readonly",publish:"",publish_files:"https://www.googleapis.com/auth/drive",share:"",create_event:"",offline_access:""},scope_delim:" ",login:function(p){"code"===p.qs.response_type&&(p.qs.access_type="offline"),p.options.force&&(p.qs.approval_prompt="force")},base:"https://www.googleapis.com/",get:{me:"plus/v1/people/me","me/friends":"plus/v1/people/me/people/visible?maxResults=@{limit|100}","me/following":contactsUrl,"me/followers":contactsUrl,"me/contacts":contactsUrl,"me/share":"plus/v1/people/me/activities/public?maxResults=@{limit|100}","me/feed":"plus/v1/people/me/activities/public?maxResults=@{limit|100}","me/albums":"https://picasaweb.google.com/data/feed/api/user/default?alt=json&max-results=@{limit|100}&start-index=@{start|1}","me/album":function(p,callback){var key=p.query.id;delete p.query.id,callback(key.replace("/entry/","/feed/"))},"me/photos":"https://picasaweb.google.com/data/feed/api/user/default?alt=json&kind=photo&max-results=@{limit|100}&start-index=@{start|1}","me/file":"drive/v2/files/@{id}","me/files":"drive/v2/files?q=%22@{parent|root}%22+in+parents+and+trashed=false&maxResults=@{limit|100}","me/folders":"drive/v2/files?q=%22@{id|root}%22+in+parents+and+mimeType+=+%22application/vnd.google-apps.folder%22+and+trashed=false&maxResults=@{limit|100}","me/folder":"drive/v2/files?q=%22@{id|root}%22+in+parents+and+trashed=false&maxResults=@{limit|100}"},post:{"me/files":uploadDrive,"me/folders":function(p,callback){p.data={title:p.data.name,parents:[{id:p.data.parent||"root"}],mimeType:"application/vnd.google-apps.folder"},callback("drive/v2/files")}},put:{"me/files":uploadDrive},del:{"me/files":"drive/v2/files/@{id}","me/folder":"drive/v2/files/@{id}"},patch:{"me/file":"drive/v2/files/@{id}"},wrap:{me:function(o){return o.id&&(o.last_name=o.family_name||(o.name?o.name.familyName:null),o.first_name=o.given_name||(o.name?o.name.givenName:null),o.emails&&o.emails.length&&(o.email=o.emails[0].value),formatPerson(o)),o},"me/friends":function(o){return o.items&&(paging(o),o.data=o.items,o.data.forEach(formatPerson),delete o.items),o},"me/contacts":formatFriends,"me/followers":formatFriends,"me/following":formatFriends,"me/share":formatFeed,"me/feed":formatFeed,"me/albums":gEntry,"me/photos":formatPhotos,default:gEntry},xhr:function(p){return"post"===p.method||"put"===p.method?toJSON(p):"patch"===p.method&&(hello.utils.extend(p.query,p.data),p.data=null),!0},form:!1}})}(hello),function(hello){function formatImage(image){return{source:image.url,width:image.width,height:image.height}}function formatError(o){return"string"==typeof o?{error:{code:"invalid_request",message:o}}:(o&&"meta"in o&&"error_type"in o.meta&&(o.error={code:o.meta.error_type,message:o.meta.error_message}),o)}function formatFriends(o){return paging(o),o&&"data"in o&&o.data.forEach(formatFriend),o}function formatFriend(o){o.id&&(o.thumbnail=o.profile_picture,o.name=o.full_name||o.username)}function paging(res){"pagination"in res&&(res.paging={next:res.pagination.next_url},delete res.pagination)}hello.init({instagram:{name:"Instagram",oauth:{version:2,auth:"https://instagram.com/oauth/authorize/",grant:"https://api.instagram.com/oauth/access_token"},refresh:!0,scope:{basic:"basic",photos:"",friends:"relationships",publish:"likes comments",email:"",share:"",publish_files:"",files:"",videos:"",offline_access:""},scope_delim:" ",base:"https://api.instagram.com/v1/",get:{me:"users/self","me/feed":"users/self/feed?count=@{limit|100}","me/photos":"users/self/media/recent?min_id=0&count=@{limit|100}","me/friends":"users/self/follows?count=@{limit|100}","me/following":"users/self/follows?count=@{limit|100}","me/followers":"users/self/followed-by?count=@{limit|100}","friend/photos":"users/@{id}/media/recent?min_id=0&count=@{limit|100}"},post:{"me/like":function(p,callback){var id=p.data.id;p.data={},callback("media/"+id+"/likes")}},del:{"me/like":"media/@{id}/likes"},wrap:{me:function(o){return formatError(o),"data"in o&&(o.id=o.data.id,o.thumbnail=o.data.profile_picture,o.name=o.data.full_name||o.data.username),o},"me/friends":formatFriends,"me/following":formatFriends,"me/followers":formatFriends,"me/photos":function(o){return formatError(o),paging(o),"data"in o&&(o.data=o.data.filter(function(d){return"image"===d.type}),o.data.forEach(function(d){d.name=d.caption?d.caption.text:null,d.thumbnail=d.images.thumbnail.url,d.picture=d.images.standard_resolution.url,d.pictures=Object.keys(d.images).map(function(key){var image=d.images[key];return formatImage(image)}).sort(function(a,b){return a.width-b.width})})),o},default:function(o){return o=formatError(o),paging(o),o}},xhr:function(p,qs){var method=p.method,proxy="get"!==method;return proxy&&("post"!==method&&"put"!==method||!p.query.access_token||(p.data.access_token=p.query.access_token,delete p.query.access_token),p.proxy=proxy),proxy},form:!1}})}(hello),function(hello){function formatError(o,headers){var errorCode,message;return o&&"Message"in o&&(message=o.Message,delete o.Message,"ErrorCode"in o?(errorCode=o.ErrorCode,delete o.ErrorCode):errorCode=getErrorCode(headers),o.error={code:errorCode,message:message,details:o}),o}function formatRequest(p,qs){var token=qs.access_token;return delete qs.access_token,p.headers.Authorization="Bearer "+token,"get"!==p.method&&p.data&&(p.headers["Content-Type"]="application/json","object"==typeof p.data&&(p.data=JSON.stringify(p.data))),"put"===p.method&&(p.method="patch"),!0}function getErrorCode(headers){switch(headers.statusCode){case 400:return"invalid_request";case 403:return"stale_token";case 401:return"invalid_token";case 500:return"server_error";default:return"server_error"}}hello.init({joinme:{name:"join.me",oauth:{version:2,auth:"https://secure.join.me/api/public/v1/auth/oauth2",grant:"https://secure.join.me/api/public/v1/auth/oauth2"},refresh:!1,scope:{basic:"user_info",user:"user_info",scheduler:"scheduler",start:"start_meeting",email:"",friends:"",share:"",publish:"",photos:"",publish_files:"",files:"",videos:"",offline_access:""},scope_delim:" ",login:function(p){p.options.popup.width=400,p.options.popup.height=700},base:"https://api.join.me/v1/",get:{me:"user",meetings:"meetings","meetings/info":"meetings/@{id}"},post:{"meetings/start/adhoc":function(p,callback){callback("meetings/start")},"meetings/start/scheduled":function(p,callback){var meetingId=p.data.meetingId;p.data={},callback("meetings/"+meetingId+"/start")},"meetings/schedule":function(p,callback){callback("meetings")}},patch:{"meetings/update":function(p,callback){callback("meetings/"+p.data.meetingId)}},del:{"meetings/delete":"meetings/@{id}"},wrap:{me:function(o,headers){return formatError(o,headers),o.email?(o.name=o.fullName,o.first_name=o.name.split(" ")[0],o.last_name=o.name.split(" ")[1],o.id=o.email,o):o},default:function(o,headers){return formatError(o,headers),o}},xhr:formatRequest}})}(hello),function(hello){function formatError(o){o&&"errorCode"in o&&(o.error={code:o.status,message:o.message})}function formatUser(o){if(!o.error)return o.first_name=o.firstName,o.last_name=o.lastName,o.name=o.formattedName||o.first_name+" "+o.last_name,o.thumbnail=o.pictureUrl,o.email=o.emailAddress,o}function formatFriends(o){return formatError(o),paging(o),o.values&&(o.data=o.values.map(formatUser),delete o.values),o}function paging(res){"_count"in res&&"_start"in res&&res._count+res._start<res._total&&(res.paging={next:"?start="+(res._start+res._count)+"&count="+res._count})}function empty(o,headers){"{}"===JSON.stringify(o)&&200===headers.statusCode&&(o.success=!0)}function formatQuery(qs){qs.access_token&&(qs.oauth2_access_token=qs.access_token,delete qs.access_token)}function like(p,callback){p.headers["x-li-format"]="json";var id=p.data.id;p.data=("delete"!==p.method).toString(),p.method="put",callback("people/~/network/updates/key="+id+"/is-liked")}hello.init({linkedin:{oauth:{version:2,response_type:"code",auth:"https://www.linkedin.com/uas/oauth2/authorization",grant:"https://www.linkedin.com/uas/oauth2/accessToken"},refresh:!0,scope:{basic:"r_basicprofile",email:"r_emailaddress",files:"",friends:"",photos:"",publish:"w_share",publish_files:"w_share",share:"",videos:"",offline_access:""},scope_delim:" ",base:"https://api.linkedin.com/v1/",get:{me:"people/~:(picture-url,first-name,last-name,id,formatted-name,email-address)","me/share":"people/~/network/updates?count=@{limit|250}"},post:{"me/share":function(p,callback){var data={visibility:{code:"anyone"}};p.data.id?data.attribution={share:{id:p.data.id}}:(data.comment=p.data.message,p.data.picture&&p.data.link&&(data.content={"submitted-url":p.data.link,"submitted-image-url":p.data.picture})),p.data=JSON.stringify(data),callback("people/~/shares?format=json")},"me/like":like},del:{"me/like":like},wrap:{me:function(o){return formatError(o),formatUser(o),o},"me/friends":formatFriends,"me/following":formatFriends,"me/followers":formatFriends,"me/share":function(o){return formatError(o),paging(o),o.values&&(o.data=o.values.map(formatUser),o.data.forEach(function(item){item.message=item.headline}),delete o.values),o},default:function(o,headers){formatError(o),empty(o,headers),paging(o)}},jsonp:function(p,qs){formatQuery(qs),"get"===p.method&&(qs.format="jsonp",qs["error-callback"]=p.callbackID)},xhr:function(p,qs){return"get"!==p.method&&(formatQuery(qs),p.headers["Content-Type"]="application/json",p.headers["x-li-format"]="json",p.proxy=!0,!0)}}})}(hello),function(hello){function formatRequest(p,qs){var token=qs.access_token;return delete qs.access_token,qs.oauth_token=token,qs["_status_code_map[302]"]=200,!0}function formatUser(o){return o.id&&(o.picture=o.avatar_url,o.thumbnail=o.avatar_url,o.name=o.username||o.full_name),o}function paging(res){"next_href"in res&&(res.paging={next:res.next_href})}hello.init({soundcloud:{name:"SoundCloud",oauth:{version:2,auth:"https://soundcloud.com/connect",grant:"https://soundcloud.com/oauth2/token"},base:"https://api.soundcloud.com/",get:{me:"me.json","me/friends":"me/followings.json","me/followers":"me/followers.json","me/following":"me/followings.json",default:function(p,callback){callback(p.path+".json")}},wrap:{me:function(o){return formatUser(o),o},default:function(o){return Array.isArray(o)&&(o={data:o.map(formatUser)}),paging(o),o}},xhr:formatRequest,jsonp:formatRequest}})}(hello),function(hello){function formatUser(o){if(o.id){if(o.name){var m=o.name.split(" ");o.first_name=m.shift(),o.last_name=m.join(" ")}o.thumbnail=o.profile_image_url_https||o.profile_image_url}return o}function formatFriends(o){return formatError(o),paging(o),o.users&&(o.data=o.users.map(formatUser),delete o.users),o}function formatError(o){if(o.errors){var e=o.errors[0];o.error={code:"request_failed",message:e.message}}}function paging(res){"next_cursor_str"in res&&(res.paging={next:"?cursor="+res.next_cursor_str})}function arrayToDataResponse(res){return Array.isArray(res)?{data:res}:res}var base="https://api.twitter.com/";hello.init({twitter:{oauth:{version:"1.0a",auth:base+"oauth/authenticate",request:base+"oauth/request_token",token:base+"oauth/access_token"},login:function(p){var prefix="?force_login=true";this.oauth.auth=this.oauth.auth.replace(prefix,"")+(p.options.force?prefix:"")},base:base+"1.1/",get:{me:"account/verify_credentials.json","me/friends":"friends/list.json?count=@{limit|200}","me/following":"friends/list.json?count=@{limit|200}","me/followers":"followers/list.json?count=@{limit|200}","me/share":"statuses/user_timeline.json?count=@{limit|200}","me/like":"favorites/list.json?count=@{limit|200}"},post:{"me/share":function(p,callback){var data=p.data;p.data=null;var status=[];data.message&&(status.push(data.message),delete data.message),data.link&&(status.push(data.link),delete data.link),data.picture&&(status.push(data.picture),delete data.picture),status.length&&(data.status=status.join(" ")),data.file?(data["media[]"]=data.file,delete data.file,p.data=data,callback("statuses/update_with_media.json")):"id"in data?callback("statuses/retweet/"+data.id+".json"):(hello.utils.extend(p.query,data),callback("statuses/update.json?include_entities=1"))},"me/like":function(p,callback){var id=p.data.id;p.data=null,callback("favorites/create.json?id="+id)}},del:{"me/like":function(){p.method="post";var id=p.data.id;p.data=null,callback("favorites/destroy.json?id="+id)}},wrap:{me:function(res){return formatError(res),formatUser(res),res},"me/friends":formatFriends,"me/followers":formatFriends,"me/following":formatFriends,"me/share":function(res){return formatError(res),paging(res),!res.error&&"length"in res?{data:res}:res},default:function(res){return res=arrayToDataResponse(res),paging(res),res}},xhr:function(p){return"get"!==p.method}}})}(hello),function(hello){function formatUser(o,req){return null!==o&&"response"in o&&null!==o.response&&o.response.length&&(o=o.response[0],o.id=o.uid,o.thumbnail=o.picture=o.photo_max,o.name=o.first_name+" "+o.last_name,req.authResponse&&null!==req.authResponse.email&&(o.email=req.authResponse.email)),o}function formatError(o){if(o.error){var e=o.error;o.error={code:e.error_code,message:e.error_msg}}}hello.init({vk:{name:"Vk",oauth:{version:2,auth:"https://oauth.vk.com/authorize",grant:"https://oauth.vk.com/access_token"},scope:{email:"email",friends:"friends",photos:"photos",videos:"video",share:"share",offline_access:"offline"},refresh:!0,login:function(p){p.qs.display=window.navigator&&window.navigator.userAgent&&/ipad|phone|phone|android/.test(window.navigator.userAgent.toLowerCase())?"mobile":"popup"},base:"https://api.vk.com/method/",get:{me:function(p,callback){p.query.fields="id,first_name,last_name,photo_max",callback("users.get")}},wrap:{me:function(res,headers,req){return formatError(res),formatUser(res,req)}},xhr:!1,jsonp:!0,form:!1}})}(hello),function(hello){function formatDefault(o){return"data"in o&&o.data.forEach(function(d){d.picture&&(d.thumbnail=d.picture),d.images&&(d.pictures=d.images.map(formatImage).sort(function(a,b){return a.width-b.width}))}),o}function formatImage(image){return{width:image.width,height:image.height,source:image.source}}function formatAlbums(o){return"data"in o&&o.data.forEach(function(d){d.photos=d.files="https://apis.live.net/v5.0/"+d.id+"/photos"}),o}function formatUser(o,headers,req){if(o.id){var token=req.query.access_token;if(o.emails&&(o.email=o.emails.preferred),o.is_friend!==!1){var id=o.user_id||o.id;o.thumbnail=o.picture="https://apis.live.net/v5.0/"+id+"/picture?access_token="+token}}return o}function formatFriends(o,headers,req){return"data"in o&&o.data.forEach(function(d){formatUser(d,headers,req)}),o}hello.init({windows:{name:"Windows live",oauth:{version:2,auth:"https://login.live.com/oauth20_authorize.srf",grant:"https://login.live.com/oauth20_token.srf"},refresh:!0,logout:function(){return"http://login.live.com/oauth20_logout.srf?ts="+(new Date).getTime()},scope:{basic:"wl.signin,wl.basic",email:"wl.emails",birthday:"wl.birthday",events:"wl.calendars",photos:"wl.photos",videos:"wl.photos",friends:"wl.contacts_emails",files:"wl.skydrive",publish:"wl.share",publish_files:"wl.skydrive_update",share:"wl.share",create_event:"wl.calendars_update,wl.events_create",offline_access:"wl.offline_access"},base:"https://apis.live.net/v5.0/",get:{me:"me","me/friends":"me/friends","me/following":"me/contacts","me/followers":"me/friends","me/contacts":"me/contacts","me/albums":"me/albums","me/album":"@{id}/files","me/photo":"@{id}","me/files":"@{parent|me/skydrive}/files","me/folders":"@{id|me/skydrive}/files","me/folder":"@{id|me/skydrive}/files"},post:{"me/albums":"me/albums","me/album":"@{id}/files/","me/folders":"@{id|me/skydrive/}","me/files":"@{parent|me/skydrive}/files"},del:{"me/album":"@{id}","me/photo":"@{id}","me/folder":"@{id}","me/files":"@{id}"},wrap:{me:formatUser,"me/friends":formatFriends,"me/contacts":formatFriends,"me/followers":formatFriends,"me/following":formatFriends,"me/albums":formatAlbums,"me/photos":formatDefault,default:formatDefault},xhr:function(p){return"get"===p.method||"delete"===p.method||hello.utils.hasBinary(p.data)||("string"==typeof p.data.file?p.data.file=hello.utils.toBlob(p.data.file):(p.data=JSON.stringify(p.data),p.headers={"Content-Type":"application/json"})),!0},jsonp:function(p){"get"===p.method||hello.utils.hasBinary(p.data)||(p.data.method=p.method,p.method="get")}}})}(hello),function(hello){function formatError(o){o&&"meta"in o&&"error_type"in o.meta&&(o.error={code:o.meta.error_type,message:o.meta.error_message})}function formatUser(o){if(formatError(o),o.query&&o.query.results&&o.query.results.profile){o=o.query.results.profile,o.id=o.guid,o.last_name=o.familyName,o.first_name=o.givenName||o.nickname;var a=[];o.first_name&&a.push(o.first_name),o.last_name&&a.push(o.last_name),o.name=a.join(" "),o.email=o.emails&&o.emails[0]?o.emails[0].handle:null,o.thumbnail=o.image?o.image.imageUrl:null}return o}function formatFriends(o,headers,request){formatError(o),paging(o,headers,request);return o.query&&o.query.results&&o.query.results.contact&&(o.data=o.query.results.contact,delete o.query,Array.isArray(o.data)||(o.data=[o.data]),o.data.forEach(formatFriend)),o}function formatFriend(contact){contact.id=null,!contact.fields||contact.fields instanceof Array||(contact.fields=[contact.fields]),(contact.fields||[]).forEach(function(field){"email"===field.type&&(contact.email=field.value),"name"===field.type&&(contact.first_name=field.value.givenName,contact.last_name=field.value.familyName,contact.name=field.value.givenName+" "+field.value.familyName),"yahooid"===field.type&&(contact.id=field.value)})}function paging(res,headers,request){return res.query&&res.query.count&&request.options&&(res.paging={next:"?start="+(res.query.count+(+request.options.start||1))}),res}function yql(q){return"https://query.yahooapis.com/v1/yql?q="+(q+" limit @{limit|100} offset @{start|0}").replace(/\s/g,"%20")+"&format=json"}hello.init({yahoo:{oauth:{version:"1.0a",auth:"https://api.login.yahoo.com/oauth/v2/request_auth",request:"https://api.login.yahoo.com/oauth/v2/get_request_token",token:"https://api.login.yahoo.com/oauth/v2/get_token"},login:function(p){p.options.popup.width=560;try{delete p.qs.state.scope}catch(e){}},base:"https://social.yahooapis.com/v1/",get:{me:yql("select * from social.profile(0) where guid=me"),"me/friends":yql("select * from social.contacts(0) where guid=me"),"me/following":yql("select * from social.contacts(0) where guid=me")},wrap:{me:formatUser,"me/friends":formatFriends,"me/following":formatFriends,default:paging}}})}(hello),"function"==typeof define&&define.amd&&define(function(){return hello}),"object"==typeof module&&module.exports&&(module.exports=hello),Object.create||(Object.create=function(){function F(){}return function(o){if(1!=arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return F.prototype=o,new F}}()),Object.keys||(Object.keys=function(o,k,r){r=[];for(k in o)r.hasOwnProperty.call(o,k)&&r.push(k);return r}),Array.prototype.indexOf||(Array.prototype.indexOf=function(s){for(var j=0;j<this.length;j++)if(this[j]===s)return j;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(fun){if(void 0===this||null===this)throw new TypeError;var t=Object(this),len=t.length>>>0;if("function"!=typeof fun)throw new TypeError;for(var thisArg=arguments.length>=2?arguments[1]:void 0,i=0;i<len;i++)i in t&&fun.call(thisArg,t[i],i,t);return this}),Array.prototype.filter||(Array.prototype.filter=function(fun,thisArg){var a=[];return this.forEach(function(val,i,t){fun.call(thisArg||void 0,val,i,t)&&a.push(val)}),a}),Array.prototype.map||(Array.prototype.map=function(fun,thisArg){var a=[];return this.forEach(function(val,i,t){a.push(fun.call(thisArg||void 0,val,i,t))}),a}),Array.isArray||(Array.isArray=function(o){return"[object Array]"===Object.prototype.toString.call(o)}),"object"!=typeof window||"object"!=typeof window.location||window.location.assign||(window.location.assign=function(url){window.location=url}),Function.prototype.bind||(Function.prototype.bind=function(b){function C(){}if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var a=[].slice,f=a.call(arguments,1),_this=this,D=function(){return _this.apply(this instanceof C?this:b||window,f.concat(a.call(arguments)))};return C.prototype=this.prototype,D.prototype=new C,D});var hello=function(name){return hello.use(name)};hello.utils={extend:function(r){return Array.prototype.slice.call(arguments,1).forEach(function(a){if(Array.isArray(r)&&Array.isArray(a))Array.prototype.push.apply(r,a);else if(r instanceof Object&&a instanceof Object&&r!==a)for(var x in a)r[x]=hello.utils.extend(r[x],a[x]);else Array.isArray(a)&&(a=a.slice(0)),r=a}),r}},hello.utils.extend(hello,{settings:{redirect_uri:window.location.href.split("#")[0],
response_type:"token",display:"popup",state:"",oauth_proxy:"https://auth-server.herokuapp.com/proxy",timeout:2e4,popup:{resizable:1,scrollbars:1,width:500,height:550},scope:["basic"],scope_map:{basic:""},default_service:null,force:null,page_uri:window.location.href},services:{},use:function(service){var self=Object.create(this);return self.settings=Object.create(this.settings),service&&(self.settings.default_service=service),self.utils.Event.call(self),self},init:function(services,options){var utils=this.utils;if(!services)return this.services;for(var x in services)services.hasOwnProperty(x)&&"object"!=typeof services[x]&&(services[x]={id:services[x]});return utils.extend(this.services,services),options&&(utils.extend(this.settings,options),"redirect_uri"in options&&(this.settings.redirect_uri=utils.url(options.redirect_uri).href)),this},login:function(){function emit(s,value){hello.emit(s,value)}function encodeFunction(s){return s}function filterEmpty(s){return!!s}var url,_this=this,utils=_this.utils,error=utils.error,promise=utils.Promise(),p=utils.args({network:"s",options:"o",callback:"f"},arguments),qs=utils.diffKey(p.options,_this.settings),opts=p.options=utils.merge(_this.settings,p.options||{});if(opts.popup=utils.merge(_this.settings.popup,p.options.popup||{}),p.network=p.network||_this.settings.default_service,promise.proxy.then(p.callback,p.callback),promise.proxy.then(emit.bind(this,"auth.login auth"),emit.bind(this,"auth.failed auth")),"string"!=typeof p.network||!(p.network in _this.services))return promise.reject(error("invalid_network","The provided network was not recognized"));var provider=_this.services[p.network],callbackId=utils.globalEvent(function(str){var obj;obj=str?JSON.parse(str):error("cancelled","The authentication was not completed"),obj.error?promise.reject(obj):(utils.store(obj.network,obj),promise.fulfill({network:obj.network,authResponse:obj}))}),redirectUri=utils.url(opts.redirect_uri).href,responseType=provider.oauth.response_type||opts.response_type;/\bcode\b/.test(responseType)&&!provider.oauth.grant&&(responseType=responseType.replace(/\bcode\b/,"token")),p.qs=utils.merge(qs,{client_id:encodeURIComponent(provider.id),response_type:encodeURIComponent(responseType),redirect_uri:encodeURIComponent(redirectUri),state:{client_id:provider.id,network:p.network,display:opts.display,callback:callbackId,state:opts.state,redirect_uri:redirectUri}});var session=utils.store(p.network),SCOPE_SPLIT=/[,\s]+/,scope=_this.settings.scope?[_this.settings.scope.toString()]:[],scopeMap=utils.merge(_this.settings.scope_map,provider.scope||{});if(opts.scope&&scope.push(opts.scope.toString()),session&&"scope"in session&&session.scope instanceof String&&scope.push(session.scope),scope=scope.join(",").split(SCOPE_SPLIT),scope=utils.unique(scope).filter(filterEmpty),p.qs.state.scope=scope.join(","),scope=scope.map(function(item){return item in scopeMap?scopeMap[item]:item}),scope=scope.join(",").split(SCOPE_SPLIT),scope=utils.unique(scope).filter(filterEmpty),p.qs.scope=scope.join(provider.scope_delim||","),opts.force===!1&&session&&"access_token"in session&&session.access_token&&"expires"in session&&session.expires>(new Date).getTime()/1e3){var diff=utils.diff((session.scope||"").split(SCOPE_SPLIT),(p.qs.state.scope||"").split(SCOPE_SPLIT));if(0===diff.length)return promise.fulfill({unchanged:!0,network:p.network,authResponse:session}),promise}if("page"===opts.display&&opts.page_uri&&(p.qs.state.page_uri=utils.url(opts.page_uri).href),"login"in provider&&"function"==typeof provider.login&&provider.login(p),(!/\btoken\b/.test(responseType)||parseInt(provider.oauth.version,10)<2||"none"===opts.display&&provider.oauth.grant&&session&&session.refresh_token)&&(p.qs.state.oauth=provider.oauth,p.qs.state.oauth_proxy=opts.oauth_proxy),p.qs.state=encodeURIComponent(JSON.stringify(p.qs.state)),1===parseInt(provider.oauth.version,10)?url=utils.qs(opts.oauth_proxy,p.qs,encodeFunction):"none"===opts.display&&provider.oauth.grant&&session&&session.refresh_token?(p.qs.refresh_token=session.refresh_token,url=utils.qs(opts.oauth_proxy,p.qs,encodeFunction)):url=utils.qs(provider.oauth.auth,p.qs,encodeFunction),emit("auth.init",p),"none"===opts.display)utils.iframe(url,redirectUri);else if("popup"===opts.display)var popup=utils.popup(url,redirectUri,opts.popup),timer=setInterval(function(){if((!popup||popup.closed)&&(clearInterval(timer),!promise.state)){var response=error("cancelled","Login has been cancelled");popup||(response=error("blocked","Popup was blocked")),response.network=p.network,promise.reject(response)}},100);else window.location=url;return promise.proxy},logout:function(){function emit(s,value){hello.emit(s,value)}var _this=this,utils=_this.utils,error=utils.error,promise=utils.Promise(),p=utils.args({name:"s",options:"o",callback:"f"},arguments);if(p.options=p.options||{},promise.proxy.then(p.callback,p.callback),promise.proxy.then(emit.bind(this,"auth.logout auth"),emit.bind(this,"error")),p.name=p.name||this.settings.default_service,p.authResponse=utils.store(p.name),!p.name||p.name in _this.services)if(p.name&&p.authResponse){var callback=function(opts){utils.store(p.name,null),promise.fulfill(hello.utils.merge({network:p.name},opts||{}))},_opts={};if(p.options.force){var logout=_this.services[p.name].logout;if(logout)if("function"==typeof logout&&(logout=logout(callback,p)),"string"==typeof logout)utils.iframe(logout),_opts.force=null,_opts.message="Logout success on providers site was indeterminate";else if(void 0===logout)return promise.proxy}callback(_opts)}else promise.reject(error("invalid_session","There was no session to remove"));else promise.reject(error("invalid_network","The network was unrecognized"));return promise.proxy},getAuthResponse:function(service){return service=service||this.settings.default_service,service&&service in this.services?this.utils.store(service)||null:null},events:{}}),hello.utils.extend(hello.utils,{error:function(code,message){return{error:{code:code,message:message}}},qs:function(url,params,formatFunction){if(params){formatFunction=formatFunction||encodeURIComponent;for(var x in params){var str="([\\?\\&])"+x+"=[^\\&]*",reg=new RegExp(str);url.match(reg)&&(url=url.replace(reg,"$1"+x+"="+formatFunction(params[x])),delete params[x])}}return this.isEmpty(params)?url:url+(url.indexOf("?")>-1?"&":"?")+this.param(params,formatFunction)},param:function(s,formatFunction){var b,m,a={};if("string"==typeof s){if(formatFunction=formatFunction||decodeURIComponent,m=s.replace(/^[\#\?]/,"").match(/([^=\/\&]+)=([^\&]+)/g))for(var i=0;i<m.length;i++)b=m[i].match(/([^=]+)=(.*)/),a[b[1]]=formatFunction(b[2]);return a}formatFunction=formatFunction||encodeURIComponent;var o=s;a=[];for(var x in o)o.hasOwnProperty(x)&&o.hasOwnProperty(x)&&a.push([x,"?"===o[x]?"?":formatFunction(o[x])].join("="));return a.join("&")},store:function(){function get(){var json={};try{json=JSON.parse(localStorage.getItem("hello"))||{}}catch(e){}return json}function set(json){localStorage.setItem("hello",JSON.stringify(json))}for(var localStorage,a=["localStorage","sessionStorage"],i=-1,prefix="test";a[++i];)try{localStorage=window[a[i]],localStorage.setItem(prefix+i,i),localStorage.removeItem(prefix+i);break}catch(e){localStorage=null}if(!localStorage){var cache=null;localStorage={getItem:function(prop){prop+="=";for(var m=document.cookie.split(";"),i=0;i<m.length;i++){var _m=m[i].replace(/(^\s+|\s+$)/,"");if(_m&&0===_m.indexOf(prop))return _m.substr(prop.length)}return cache},setItem:function(prop,value){cache=value,document.cookie=prop+"="+value}},cache=localStorage.getItem("hello")}return function(name,value,days){var json=get();if(name&&void 0===value)return json[name]||null;if(name&&null===value)try{delete json[name]}catch(e){json[name]=null}else{if(!name)return json;json[name]=value}return set(json),json||null}}(),append:function(node,attr,target){var n="string"==typeof node?document.createElement(node):node;if("object"==typeof attr)if("tagName"in attr)target=attr;else for(var x in attr)if(attr.hasOwnProperty(x))if("object"==typeof attr[x])for(var y in attr[x])attr[x].hasOwnProperty(y)&&(n[x][y]=attr[x][y]);else"html"===x?n.innerHTML=attr[x]:/^on/.test(x)?n[x]=attr[x]:n.setAttribute(x,attr[x]);return"body"===target?!function self(){document.body?document.body.appendChild(n):setTimeout(self,16)}():"object"==typeof target?target.appendChild(n):"string"==typeof target&&document.getElementsByTagName(target)[0].appendChild(n),n},iframe:function(src){this.append("iframe",{src:src,style:{position:"absolute",left:"-1000px",bottom:0,height:"1px",width:"1px"}},"body")},merge:function(){var args=Array.prototype.slice.call(arguments);return args.unshift({}),this.extend.apply(null,args)},args:function(o,args){var p={},i=0,t=null,x=null;for(x in o)if(o.hasOwnProperty(x))break;if(1===args.length&&"object"==typeof args[0]&&"o!"!=o[x])for(x in args[0])if(o.hasOwnProperty(x)&&x in o)return args[0];for(x in o)if(o.hasOwnProperty(x))if(t=typeof args[i],"function"==typeof o[x]&&o[x].test(args[i])||"string"==typeof o[x]&&(o[x].indexOf("s")>-1&&"string"===t||o[x].indexOf("o")>-1&&"object"===t||o[x].indexOf("i")>-1&&"number"===t||o[x].indexOf("a")>-1&&"object"===t||o[x].indexOf("f")>-1&&"function"===t))p[x]=args[i++];else if("string"==typeof o[x]&&o[x].indexOf("!")>-1)return!1;return p},url:function(path){if(path){if(window.URL&&URL instanceof Function&&0!==URL.length)return new URL(path,window.location);var a=document.createElement("a");return a.href=path,a.cloneNode(!1)}return window.location},diff:function(a,b){return b.filter(function(item){return a.indexOf(item)===-1})},diffKey:function(a,b){if(a||!b){var r={};for(var x in a)x in b||(r[x]=a[x]);return r}return a},unique:function(a){return Array.isArray(a)?a.filter(function(item,index){return a.indexOf(item)===index}):[]},isEmpty:function(obj){if(!obj)return!0;if(Array.isArray(obj))return!obj.length;if("object"==typeof obj)for(var key in obj)if(obj.hasOwnProperty(key))return!1;return!0},Promise:function(){var STATE_PENDING=0,STATE_FULFILLED=1,STATE_REJECTED=2,api=function(executor){return this instanceof api?(this.id="Thenable/1.0.6",this.state=STATE_PENDING,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},void("function"==typeof executor&&executor.call(this,this.fulfill.bind(this),this.reject.bind(this)))):new api(executor)};api.prototype={fulfill:function(value){return deliver(this,STATE_FULFILLED,"fulfillValue",value)},reject:function(value){return deliver(this,STATE_REJECTED,"rejectReason",value)},then:function(onFulfilled,onRejected){var curr=this,next=new api;return curr.onFulfilled.push(resolver(onFulfilled,next,"fulfill")),curr.onRejected.push(resolver(onRejected,next,"reject")),execute(curr),next.proxy}};var deliver=function(curr,state,name,value){return curr.state===STATE_PENDING&&(curr.state=state,curr[name]=value,execute(curr)),curr},execute=function(curr){curr.state===STATE_FULFILLED?execute_handlers(curr,"onFulfilled",curr.fulfillValue):curr.state===STATE_REJECTED&&execute_handlers(curr,"onRejected",curr.rejectReason)},execute_handlers=function(curr,name,value){if(0!==curr[name].length){var handlers=curr[name];curr[name]=[];var func=function(){for(var i=0;i<handlers.length;i++)handlers[i](value)};"object"==typeof process&&"function"==typeof process.nextTick?process.nextTick(func):"function"==typeof setImmediate?setImmediate(func):setTimeout(func,0)}},resolver=function(cb,next,method){return function(value){if("function"!=typeof cb)next[method].call(next,value);else{var result;try{result=cb(value)}catch(e){return void next.reject(e)}resolve(next,result)}}},resolve=function(promise,x){if(promise===x||promise.proxy===x)return void promise.reject(new TypeError("cannot resolve promise with itself"));var then;if("object"==typeof x&&null!==x||"function"==typeof x)try{then=x.then}catch(e){return void promise.reject(e)}if("function"!=typeof then)promise.fulfill(x);else{var resolved=!1;try{then.call(x,function(y){resolved||(resolved=!0,y===x?promise.reject(new TypeError("circular thenable chain")):resolve(promise,y))},function(r){resolved||(resolved=!0,promise.reject(r))})}catch(e){resolved||promise.reject(e)}}};return api}(),Event:function(){var separator=/[\s\,]+/;return this.parent={events:this.events,findEvents:this.findEvents,parent:this.parent,utils:this.utils},this.events={},this.on=function(evt,callback){if(callback&&"function"==typeof callback)for(var a=evt.split(separator),i=0;i<a.length;i++)this.events[a[i]]=[callback].concat(this.events[a[i]]||[]);return this},this.off=function(evt,callback){return this.findEvents(evt,function(name,index){callback&&this.events[name][index]!==callback||(this.events[name][index]=null)}),this},this.emit=function(evt){var args=Array.prototype.slice.call(arguments,1);args.push(evt);for(var handler=function(name,index){args[args.length-1]="*"===name?evt:name,this.events[name][index].apply(this,args)},_this=this;_this&&_this.findEvents;)_this.findEvents(evt+",*",handler),_this=_this.parent;return this},this.emitAfter=function(){var _this=this,args=arguments;return setTimeout(function(){_this.emit.apply(_this,args)},0),this},this.findEvents=function(evt,callback){var a=evt.split(separator);for(var name in this.events)if(this.events.hasOwnProperty(name)&&a.indexOf(name)>-1)for(var i=0;i<this.events[name].length;i++)this.events[name][i]&&callback.call(this,name,i)},this},globalEvent:function(callback,guid){return guid=guid||"_hellojs_"+parseInt(1e12*Math.random(),10).toString(36),window[guid]=function(){try{callback.apply(this,arguments)&&delete window[guid]}catch(e){console.error(e)}},guid},popup:function(url,redirectUri,options){var documentElement=document.documentElement;if(options.height){var dualScreenTop=void 0!==window.screenTop?window.screenTop:screen.top,height=screen.height||window.innerHeight||documentElement.clientHeight;options.top=parseInt((height-options.height)/2,10)+dualScreenTop}if(options.width){var dualScreenLeft=void 0!==window.screenLeft?window.screenLeft:screen.left,width=screen.width||window.innerWidth||documentElement.clientWidth;options.left=parseInt((width-options.width)/2,10)+dualScreenLeft}var optionsArray=[];Object.keys(options).forEach(function(name){var value=options[name];optionsArray.push(name+(null!==value?"="+value:""))}),navigator.userAgent.indexOf("Safari")!==-1&&navigator.userAgent.indexOf("Chrome")===-1&&(url=redirectUri+"#oauth_redirect="+encodeURIComponent(encodeURIComponent(url)));var popup=window.open(url,"_blank",optionsArray.join(","));return popup&&popup.focus&&popup.focus(),popup},responseHandler:function(window,parent){function authCallback(obj,window,parent){var cb=obj.callback,network=obj.network;if(_this.store(network,obj),!("display"in obj&&"page"===obj.display)){if(parent&&cb&&cb in parent){try{delete obj.callback}catch(e){}_this.store(network,obj);var str=JSON.stringify(obj);try{callback(parent,cb)(str)}catch(e){}}closeWindow()}}function callback(parent,callbackID){return 0!==callbackID.indexOf("_hellojs_")?function(){throw"Could not execute callback "+callbackID}:parent[callbackID]}function closeWindow(){if(window.frameElement)parent.document.body.removeChild(window.frameElement);else{try{window.close()}catch(e){}window.addEventListener&&window.addEventListener("load",function(){window.close()})}}var p,_this=this,location=window.location;if(p=_this.param(location.search),p&&p.state&&(p.code||p.oauth_token)){var state=JSON.parse(p.state);p.redirect_uri=state.redirect_uri||location.href.replace(/[\?\#].*$/,"");var path=state.oauth_proxy+"?"+_this.param(p);return void location.assign(path)}if(p=_this.merge(_this.param(location.search||""),_this.param(location.hash||"")),p&&"state"in p){try{var a=JSON.parse(p.state);_this.extend(p,a)}catch(e){console.error("Could not decode state parameter")}if("access_token"in p&&p.access_token&&p.network)p.expires_in&&0!==parseInt(p.expires_in,10)||(p.expires_in=0),p.expires_in=parseInt(p.expires_in,10),p.expires=(new Date).getTime()/1e3+(p.expires_in||31536e3),authCallback(p,window,parent);else if("error"in p&&p.error&&p.network)p.error={code:p.error,message:p.error_message||p.error_description},authCallback(p,window,parent);else if(p.callback&&p.callback in parent){var res=!!("result"in p&&p.result)&&JSON.parse(p.result);callback(parent,p.callback)(res),closeWindow()}p.page_uri&&location.assign(p.page_uri)}else if("oauth_redirect"in p)return void location.assign(decodeURIComponent(p.oauth_redirect))}}),hello.utils.Event.call(hello),function(hello){var oldSessions={},expired={};hello.on("auth.login, auth.logout",function(auth){auth&&"object"==typeof auth&&auth.network&&(oldSessions[auth.network]=hello.utils.store(auth.network)||{})}),function self(){var CURRENT_TIME=(new Date).getTime()/1e3,emit=function(eventName){hello.emit("auth."+eventName,{network:name,authResponse:session})};for(var name in hello.services)if(hello.services.hasOwnProperty(name)){if(!hello.services[name].id)continue;var session=hello.utils.store(name)||{},provider=hello.services[name],oldSess=oldSessions[name]||{};if(session&&"callback"in session){var cb=session.callback;try{delete session.callback}catch(e){}hello.utils.store(name,session);try{window[cb](session)}catch(e){}}if(session&&"expires"in session&&session.expires<CURRENT_TIME){var refresh=provider.refresh||session.refresh_token;!refresh||name in expired&&!(expired[name]<CURRENT_TIME)?refresh||name in expired||(emit("expired"),expired[name]=!0):(hello.emit("notice",name+" has expired trying to resignin"),hello.login(name,{display:"none",force:!1}),expired[name]=CURRENT_TIME+600);continue}if(oldSess.access_token===session.access_token&&oldSess.expires===session.expires)continue;!session.access_token&&oldSess.access_token?emit("logout"):session.access_token&&!oldSess.access_token?emit("login"):session.expires!==oldSess.expires&&emit("update"),oldSessions[name]=session,name in expired&&delete expired[name]}setTimeout(self,1e3)}()}(hello),hello.api=function(){function getPath(url){url=url.replace(/\@\{([a-z\_\-]+)(\|.*?)?\}/gi,function(m,key,defaults){var val=defaults?defaults.replace(/^\|/,""):"";return key in p.query?(val=p.query[key],delete p.query[key]):p.data&&key in p.data?(val=p.data[key],delete p.data[key]):defaults||promise.reject(error("missing_attribute","The attribute "+key+" is missing from the request")),val}),url.match(/^https?:\/\//)||(url=o.base+url),p.url=url,utils.request(p,function(r,headers){if(!p.formatResponse)return void(("object"==typeof headers?headers.statusCode>=400:"object"==typeof r&&"error"in r)?promise.reject(r):promise.fulfill(r));if(r===!0?r={success:!0}:r||(r={}),"delete"===p.method&&(r=!r||utils.isEmpty(r)?{success:!0}:r),o.wrap&&(p.path in o.wrap||"default"in o.wrap)){var wrap=p.path in o.wrap?p.path:"default",b=((new Date).getTime(),o.wrap[wrap](r,headers,p));b&&(r=b)}r&&"paging"in r&&r.paging.next&&("?"===r.paging.next[0]?r.paging.next=p.path+r.paging.next:r.paging.next+="#"+p.path),!r||"error"in r?promise.reject(r):promise.fulfill(r)})}var _this=this,utils=_this.utils,error=utils.error,promise=utils.Promise(),p=utils.args({path:"s!",query:"o",method:"s",data:"o",timeout:"i",callback:"f"},arguments);p.method=(p.method||"get").toLowerCase(),p.headers=p.headers||{},p.query=p.query||{},"get"!==p.method&&"delete"!==p.method||(utils.extend(p.query,p.data),p.data={});var data=p.data=p.data||{};if(promise.then(p.callback,p.callback),!p.path)return promise.reject(error("invalid_path","Missing the path parameter from the request"));p.path=p.path.replace(/^\/+/,"");var a=(p.path.split(/[\/\:]/,2)||[])[0].toLowerCase();if(a in _this.services){p.network=a;var reg=new RegExp("^"+a+":?/?");p.path=p.path.replace(reg,"")}p.network=_this.settings.default_service=p.network||_this.settings.default_service;var o=_this.services[p.network];if(!o)return promise.reject(error("invalid_network","Could not match the service requested: "+p.network));if(p.method in o&&p.path in o[p.method]&&o[p.method][p.path]===!1)return promise.reject(error("invalid_path","The provided path is not available on the selected network"));p.oauth_proxy||(p.oauth_proxy=_this.settings.oauth_proxy),"proxy"in p||(p.proxy=p.oauth_proxy&&o.oauth&&1===parseInt(o.oauth.version,10)),"timeout"in p||(p.timeout=_this.settings.timeout),"formatResponse"in p||(p.formatResponse=!0),p.authResponse=_this.getAuthResponse(p.network),p.authResponse&&p.authResponse.access_token&&(p.query.access_token=p.authResponse.access_token);var m,url=p.path;p.options=utils.clone(p.query),p.data=utils.clone(data);var actions=o[{delete:"del"}[p.method]||p.method]||{};if("get"===p.method){var query=url.split(/[\?#]/)[1];query&&(utils.extend(p.query,utils.param(query)),url=url.replace(/\?.*?(#|$)/,"$1"))}return(m=url.match(/#(.+)/,""))?(url=url.split("#")[0],p.path=m[1]):url in actions?(p.path=url,url=actions[url]):"default"in actions&&(url=actions.default),p.redirect_uri=_this.settings.redirect_uri,p.xhr=o.xhr,p.jsonp=o.jsonp,p.form=o.form,"function"==typeof url?url(p,getPath):getPath(url),promise.proxy},hello.utils.extend(hello.utils,{request:function(p,callback){function formatUrl(p,callback){var sign;p.authResponse&&p.authResponse.oauth&&1===parseInt(p.authResponse.oauth.version,10)&&(sign=p.query.access_token,delete p.query.access_token,p.proxy=!0),!p.data||"get"!==p.method&&"delete"!==p.method||(_this.extend(p.query,p.data),p.data=null);var path=_this.qs(p.url,p.query);p.proxy&&(path=_this.qs(p.oauth_proxy,{path:path,access_token:sign||"",then:p.proxy_response_type||("get"===p.method.toLowerCase()?"redirect":"proxy"),method:p.method.toLowerCase(),suppress_response_codes:!0})),callback(path)}var _this=this,error=_this.error;_this.isEmpty(p.data)||"FileList"in window||!_this.hasBinary(p.data)||(p.xhr=!1,p.jsonp=!1);var cors=this.request_cors(function(){return void 0===p.xhr||p.xhr&&("function"!=typeof p.xhr||p.xhr(p,p.query))});if(cors)return void formatUrl(p,function(url){var x=_this.xhr(p.method,url,p.headers,p.data,callback);x.onprogress=p.onprogress||null,x.upload&&p.onuploadprogress&&(x.upload.onprogress=p.onuploadprogress)});var _query=p.query;if(p.query=_this.clone(p.query),p.callbackID=_this.globalEvent(),p.jsonp!==!1){if(p.query.callback=p.callbackID,"function"==typeof p.jsonp&&p.jsonp(p,p.query),"get"===p.method)return void formatUrl(p,function(url){_this.jsonp(url,callback,p.callbackID,p.timeout)});p.query=_query}if(p.form!==!1){p.query.redirect_uri=p.redirect_uri,p.query.state=JSON.stringify({callback:p.callbackID});var opts;if("function"==typeof p.form&&(opts=p.form(p,p.query)),"post"===p.method&&opts!==!1)return void formatUrl(p,function(url){_this.post(url,p.data,opts,callback,p.callbackID,p.timeout)})}callback(error("invalid_request","There was no mechanism for handling this request"))},request_cors:function(callback){return"withCredentials"in new XMLHttpRequest&&callback()},domInstance:function(type,data){var test="HTML"+(type||"").replace(/^[a-z]/,function(m){return m.toUpperCase()})+"Element";return!!data&&(window[test]?data instanceof window[test]:window.Element?data instanceof window.Element&&(!type||data.tagName&&data.tagName.toLowerCase()===type):!(data instanceof Object||data instanceof Array||data instanceof String||data instanceof Number)&&data.tagName&&data.tagName.toLowerCase()===type)},clone:function(obj){if(null===obj||"object"!=typeof obj||obj instanceof Date||"nodeName"in obj||this.isBinary(obj)||"function"==typeof FormData&&obj instanceof FormData)return obj;if(Array.isArray(obj))return obj.map(this.clone.bind(this));var clone={};for(var x in obj)clone[x]=this.clone(obj[x]);return clone},xhr:function(method,url,headers,data,callback){function headersToJSON(s){for(var m,r={},reg=/([a-z\-]+):\s?(.*);?/gi;m=reg.exec(s);)r[m[1]]=m[2];return r}var r=new XMLHttpRequest,error=this.error,binary=!1;"blob"===method&&(binary=method,method="GET"),method=method.toUpperCase(),r.onload=function(e){var json=r.response;try{json=JSON.parse(r.responseText)}catch(_e){401===r.status&&(json=error("access_denied",r.statusText))}var headers=headersToJSON(r.getAllResponseHeaders());headers.statusCode=r.status,callback(json||("GET"===method?error("empty_response","Could not get resource"):{}),headers)},r.onerror=function(e){var json=r.responseText;try{json=JSON.parse(r.responseText)}catch(_e){}callback(json||error("access_denied","Could not get resource"))};var x;if("GET"===method||"DELETE"===method)data=null;else if(data&&"string"!=typeof data&&!(data instanceof FormData)&&!(data instanceof File)&&!(data instanceof Blob)){var f=new FormData;for(x in data)data.hasOwnProperty(x)&&(data[x]instanceof HTMLInputElement?"files"in data[x]&&data[x].files.length>0&&f.append(x,data[x].files[0]):data[x]instanceof Blob?f.append(x,data[x],data.name):f.append(x,data[x]));data=f}if(r.open(method,url,!0),binary&&("responseType"in r?r.responseType=binary:r.overrideMimeType("text/plain; charset=x-user-defined")),headers)for(x in headers)r.setRequestHeader(x,headers[x]);return r.send(data),r},jsonp:function(url,callback,callbackID,timeout){var operaFix,_this=this,error=_this.error,bool=0,head=document.getElementsByTagName("head")[0],result=error("server_error","server_error"),cb=function(){bool++||window.setTimeout(function(){callback(result),head.removeChild(script)},0)};callbackID=_this.globalEvent(function(json){return result=json,!0},callbackID),url=url.replace(new RegExp("=\\?(&|$)"),"="+callbackID+"$1");var script=_this.append("script",{id:callbackID,name:callbackID,src:url,async:!0,onload:cb,onerror:cb,onreadystatechange:function(){/loaded|complete/i.test(this.readyState)&&cb()}});window.navigator.userAgent.toLowerCase().indexOf("opera")>-1&&(operaFix=_this.append("script",{text:"document.getElementById('"+callbackID+"').onerror();"}),script.async=!1),timeout&&window.setTimeout(function(){result=error("timeout","timeout"),cb()},timeout),head.appendChild(script),operaFix&&head.appendChild(operaFix)},post:function(url,data,options,callback,callbackID,timeout){var newform,_this=this,error=_this.error,doc=document,form=null,reenableAfterSubmit=[],i=0,x=null,bool=0,cb=function(r){bool++||callback(r)};_this.globalEvent(cb,callbackID);var win;try{win=doc.createElement('<iframe name="'+callbackID+'">')}catch(e){win=doc.createElement("iframe")}if(win.name=callbackID,win.id=callbackID,win.style.display="none",options&&options.callbackonload&&(win.onload=function(){cb({response:"posted",message:"Content was posted"})}),timeout&&setTimeout(function(){cb(error("timeout","The post operation timed out"))},timeout),doc.body.appendChild(win),_this.domInstance("form",data)){for(form=data.form,i=0;i<form.elements.length;i++)form.elements[i]!==data&&form.elements[i].setAttribute("disabled",!0);data=form}if(_this.domInstance("form",data))for(form=data,i=0;i<form.elements.length;i++)form.elements[i].disabled||"file"!==form.elements[i].type||(form.encoding=form.enctype="multipart/form-data",form.elements[i].setAttribute("name","file"));else{for(x in data)data.hasOwnProperty(x)&&_this.domInstance("input",data[x])&&"file"===data[x].type&&(form=data[x].form,form.encoding=form.enctype="multipart/form-data");form||(form=doc.createElement("form"),doc.body.appendChild(form),newform=form);var input;for(x in data)if(data.hasOwnProperty(x)){var el=_this.domInstance("input",data[x])||_this.domInstance("textArea",data[x])||_this.domInstance("select",data[x]);if(el&&data[x].form===form)el&&data[x].name!==x&&(data[x].setAttribute("name",x),data[x].name=x);else{var inputs=form.elements[x];if(input)for(inputs instanceof NodeList||(inputs=[inputs]),i=0;i<inputs.length;i++)inputs[i].parentNode.removeChild(inputs[i]);input=doc.createElement("input"),input.setAttribute("type","hidden"),input.setAttribute("name",x),el?input.value=data[x].value:_this.domInstance(null,data[x])?input.value=data[x].innerHTML||data[x].innerText:input.value=data[x],form.appendChild(input)}}for(i=0;i<form.elements.length;i++)input=form.elements[i],input.name in data||input.getAttribute("disabled")===!0||(input.setAttribute("disabled",!0),reenableAfterSubmit.push(input))}form.setAttribute("method","POST"),form.setAttribute("target",callbackID),form.target=callbackID,form.setAttribute("action",url),setTimeout(function(){form.submit(),setTimeout(function(){try{newform&&newform.parentNode.removeChild(newform)}catch(e){try{console.error("HelloJS: could not remove iframe")}catch(ee){}}for(var i=0;i<reenableAfterSubmit.length;i++)reenableAfterSubmit[i]&&(reenableAfterSubmit[i].setAttribute("disabled",!1),reenableAfterSubmit[i].disabled=!1)},0)},100)},hasBinary:function(data){for(var x in data)if(data.hasOwnProperty(x)&&this.isBinary(data[x]))return!0;return!1},isBinary:function(data){return data instanceof Object&&(this.domInstance("input",data)&&"file"===data.type||"FileList"in window&&data instanceof window.FileList||"File"in window&&data instanceof window.File||"Blob"in window&&data instanceof window.Blob)},toBlob:function(dataURI){var reg=/^data\:([^;,]+(\;charset=[^;,]+)?)(\;base64)?,/i,m=dataURI.match(reg);if(!m)return dataURI;for(var binary=atob(dataURI.replace(reg,"")),array=[],i=0;i<binary.length;i++)array.push(binary.charCodeAt(i));return new Blob([new Uint8Array(array)],{type:m[1]})}}),function(hello){var api=hello.api,utils=hello.utils;utils.extend(utils,{dataToJSON:function(p){var _this=this,w=window,data=p.data;if(_this.domInstance("form",data)?data=_this.nodeListToJSON(data.elements):"NodeList"in w&&data instanceof NodeList?data=_this.nodeListToJSON(data):_this.domInstance("input",data)&&(data=_this.nodeListToJSON([data])),("File"in w&&data instanceof w.File||"Blob"in w&&data instanceof w.Blob||"FileList"in w&&data instanceof w.FileList)&&(data={file:data}),!("FormData"in w&&data instanceof w.FormData))for(var x in data)if(data.hasOwnProperty(x))if("FileList"in w&&data[x]instanceof w.FileList)1===data[x].length&&(data[x]=data[x][0]);else{if(_this.domInstance("input",data[x])&&"file"===data[x].type)continue;_this.domInstance("input",data[x])||_this.domInstance("select",data[x])||_this.domInstance("textArea",data[x])?data[x]=data[x].value:_this.domInstance(null,data[x])&&(data[x]=data[x].innerHTML||data[x].innerText)}return p.data=data,data},nodeListToJSON:function(nodelist){for(var json={},i=0;i<nodelist.length;i++){var input=nodelist[i];!input.disabled&&input.name&&("file"===input.type?json[input.name]=input:json[input.name]=input.value||input.innerHTML)}return json}}),hello.api=function(){var p=utils.args({path:"s!",method:"s",data:"o",timeout:"i",callback:"f"},arguments);return p.data&&utils.dataToJSON(p),api.call(this,p)}}(hello),hello.utils.responseHandler(window,window.opener||window.parent),"object"==typeof chrome&&"object"==typeof chrome.identity&&chrome.identity.launchWebAuthFlow&&!function(){function _open(url,interactive){var ref={closed:!1};return chrome.identity.launchWebAuthFlow({url:url,interactive:interactive},function(responseUrl){if(void 0===responseUrl)return void(ref.closed=!0);var a=hello.utils.url(responseUrl),_popup={location:{assign:function(url){_open(url,!1)},search:a.search,hash:a.hash,href:a.href},close:function(){}};hello.utils.responseHandler(_popup,window)}),ref}hello.utils.popup=function(url){return _open(url,!0)},hello.utils.iframe=function(url){_open(url,!1)},hello.utils.request_cors=function(callback){return callback(),!0};var _cache={};chrome.storage.local.get("hello",function(r){_cache=r.hello||{}}),hello.utils.store=function(name,value){return 0===arguments.length?_cache:1===arguments.length?_cache[name]||null:value?(_cache[name]=value,chrome.storage.local.set({hello:_cache}),value):null===value?(delete _cache[name],chrome.storage.local.set({hello:_cache}),null):void 0}}(),function(){if(/^file:\/{3}[^\/]/.test(window.location.href)&&window.cordova){hello.utils.iframe=function(url,redirectUri){hello.utils.popup(url,redirectUri,{hidden:"yes"})};var utilPopup=hello.utils.popup;hello.utils.popup=function(url,redirectUri,options){
var popup=utilPopup.call(this,url,redirectUri,options);try{if(popup&&popup.addEventListener){var a=hello.utils.url(redirectUri),redirectUriOrigin=a.origin||a.protocol+"//"+a.hostname;popup.addEventListener("loadstart",function(e){var url=e.url;if(0===url.indexOf(redirectUriOrigin)){var a=hello.utils.url(url),_popup={location:{assign:function(location){popup.executeScript({code:'window.location.href = "'+location+';"'})},search:a.search,hash:a.hash,href:a.href},close:function(){if(popup.close){popup.close();try{popup.closed=!0}catch(_e){}}}};hello.utils.responseHandler(_popup,window)}})}}catch(e){}return popup}}}(),"function"==typeof define&&define.amd&&define(function(){return hello}),"object"==typeof module&&module.exports&&(module.exports=hello),angular.module("ApiExplorer",["ngAnimate","ngMaterial"]).config(["$mdThemingProvider",function($mdThemingProvider){$mdThemingProvider.definePalette("O365PrimaryPalette",{50:"e9f0fc",100:"d3e2f8",200:"bdd3f5",300:"91b6ee",400:"6599e7",500:"4685e2",600:"387be0",700:"226ddd",800:"1f62c7",900:"1c57b0",A100:"FF6A00",A200:"FF6A00",A400:"FF6A00",A700:"FF6A00",contrastDefaultColor:"light",contrastDarkColors:["50","100","200","300","400","A100"],contrastLightColors:void 0}),$mdThemingProvider.definePalette("O365AccentPalette",{50:"ffc499",100:"ffb580",200:"ffa666",300:"ff974d",400:"ff8833",500:"FF6A00",600:"e66000",700:"cc5500",800:"b34a00",900:"994000",A100:"FF6A00",A200:"FF6A00",A400:"FF6A00",A700:"FF6A00"}),$mdThemingProvider.theme("default").primaryPalette("O365PrimaryPalette"),$mdThemingProvider.theme("default").accentPalette("O365AccentPalette")}]),angular.module("ApiExplorer").config(function($locationProvider){$locationProvider.html5Mode({enabled:!0,requireBase:!1,rewriteLinks:!1})}).factory("ApiExplorerSvc",[function(){var apiExplorerService={};return apiExplorerService}]),angular.module("ApiExplorer").factory("ApiExplorerSvc",["$http","$cacheFactory",function($http,$cacheFactory){return{text:"https://graph.microsoft.com/v1.0/me/",selectedVersion:"v1.0",selectedOption:"GET",showJsonEditor:!1,cache:$cacheFactory("myCache"),performAnonymousQuery:function(queryType){return function(query,postString,requestHeaders){var headersObj={Authorization:"Bearer {token:https://graph.microsoft.com/}",Accept:"application/json"};requestHeaders&&requestHeaders.Authorization&&(headersObj.Authorization=requestHeaders.Authorization),requestHeaders&&requestHeaders.Accept&&(headersObj.Accept=requestHeaders.Accept);var request={url:"https://proxy.apisandbox.msdn.microsoft.com/svc?url="+encodeURIComponent(query),method:"GET",headers:headersObj};if("GET_BINARY"==queryType&&(request.responseType="arraybuffer"),"GET_BINARY"==queryType||"GET"==queryType)return $http(request)}},performQuery:function(queryType){return function(query,postString,requestHeaders){switch(queryType){case"GET":return $http.get(query,{headers:requestHeaders});case"GET_BINARY":return $http.get(query,{responseType:"arraybuffer"},{headers:requestHeaders});case"POST":return $http.post(query,postString,{headers:requestHeaders});case"PATCH":return $http.patch(query,postString,{headers:requestHeaders});case"DELETE":return $http.delete(query,{headers:requestHeaders})}}},getMetadata:function(){return this.performAnonymousQuery("GET")("https://graph.microsoft.com/"+this.selectedVersion+"/$metadata")}}}]);var loc_strings={};loc_strings["en-US"]={"To try the explorer, please ":"To try the explorer, please ","sign in":"sign in"," with your work or school account from Microsoft.":" with your work or school account from Microsoft.",Submit:"Submit","Using demo tenant":"Using demo tenant","sign out":"sign out",History:"History",Method:"Method",Query:"Query","Status Code":"Status Code",Duration:"Duration",Go:"Go",YES:"YES",NO:"NO","request header":"request header","request body":"request body",response:"response",login_to_send_requests:"Login to change the request type"},loc_strings["fr-FR"]={"To try the explorer, please ":"Pour essayer l’afficheur, veuillez ","sign in":"se connecter"," with your work or school account from Microsoft.":" avec votre compte scolaire ou professionnel de Microsoft.",Submit:"Envoyer","Using demo tenant":"À l’aide du client de démonstration","sign out":"se déconnecter",History:"Historique",Method:"Méthode",Query:"Requête","Status Code":"Code d'état",Duration:"Durée",Go:"Rechercher",YES:"OUI",NO:"NON","request header":"en-tête de la demande","request body":"corps de la demande",response:"réponse"},loc_strings["es-ES"]={"To try the explorer, please ":"Para utilizar el probador, ","sign in":"iniciar sesión"," with your work or school account from Microsoft.":" con su cuenta profesional o educativa de Microsoft.",Submit:"Enviar","Using demo tenant":"Uso de inquilinos de demostración","sign out":"cerrar sesión",History:"Historial",Method:"Método",Query:"Consulta","Status Code":"Código de estado",Duration:"Duración",Go:"Ir",YES:"SÍ",NO:"NO","request header":"encabezado de solicitud","request body":"cuerpo de solicitud",response:"respuesta"},loc_strings["ja-JP"]={"To try the explorer, please ":"エクスプローラーをお試しいただくには、Microsoft の職場または学校アカウントで ","sign in":"サインイン"," with your work or school account from Microsoft.":" します。",Submit:"送信","Using demo tenant":"デモ テナントを使用しています","sign out":"サインアウト",History:"履歴",Method:"メソッド",Query:"クエリ","Status Code":"状態コード",Duration:"期間",Go:"検索",YES:"はい",NO:"いいえ","request header":"要求ヘッダー","request body":"要求本文",response:"応答"},loc_strings["de-DE"]={"To try the explorer, please ":"Um den Tester auszuprobieren, ","sign in":"Anmelden"," with your work or school account from Microsoft.":" mit Ihrem Geschäfts- oder Schulkonto von Microsoft an.",Submit:"Senden","Using demo tenant":"Verwenden des Demomandanten","sign out":"Abmelden",History:"Verlauf",Method:"Methode",Query:"Abfrage","Status Code":"Statuscode",Duration:"Dauer",Go:"OK",YES:"JA",NO:"NEIN","request header":"Anforderungsheader","request body":"Anforderungstextkörper",response:"Antwort"},loc_strings["zh-CN"]={"To try the explorer, please ":"若要尝试浏览器，请 使用你的 Microsoft 工作或学校帐户","sign in":"登录"," with your work or school account from Microsoft.":"。",Submit:"提交","Using demo tenant":"使用演示租户","sign out":"注销",History:"历史记录",Method:"方法",Query:"查询","Status Code":"状态代码",Duration:"持续时间",Go:"转到",YES:"是",NO:"否","request header":"请求标题","request body":"请求正文",response:"响应"},loc_strings["pt-BR"]={"To try the explorer, please ":"Para experimentar o Explorador, ","sign in":"entrar"," with your work or school account from Microsoft.":" com a sua conta corporativa ou de estudante da Microsoft.",Submit:"Enviar","Using demo tenant":"Usando o Locatário de Demonstração","sign out":"sair",History:"Histórico",Method:"Método",Query:"Consulta","Status Code":"Código de Status",Duration:"Duração",Go:"Ir",YES:"SIM",NO:"NÃO","request header":"cabeçalho da solicitação","request body":"corpo da solicitação",response:"resposta"},loc_strings["ru-RU"]={"To try the explorer, please ":"Чтобы опробовать песочницу, ","sign in":"войти"," with your work or school account from Microsoft.":" с помощью рабочей или учебной учетной записи от корпорации Майкрософт.",Submit:"Отправить","Using demo tenant":"С помощью демонстрационного клиента","sign out":"выйти",History:"Журнал",Method:"Метод",Query:"Запрос","Status Code":"Код состояния",Duration:"Длительность",Go:"Перейти",YES:"ДА",NO:"НЕТ","request header":"заголовок запроса","request body":"текст запроса",response:"ответ"};var s;angular.module("ApiExplorer").controller("ApiExplorerCtrl",["$scope","$http","$location","ApiExplorerSvc","$timeout","$templateCache","$mdDialog","$sce",function($scope,$http,$location,apiService,$timeout,$templateCache,$mdDialog,$sce){function checkCanInsertTemplate(URL){var entity=$scope.getCurrentEntityName(),canInsertTemplate=entity in postTemplates;return canInsertTemplate}s=$scope,$scope.userInfo={},$scope.getAssetPath=function(relPath){return s.pathToBuildDir+"/"+relPath},$scope.finishAdminConsertFlow=function(){hello("msft_token_refresh").login({display:"popup",response_type:"token",redirect_uri:$scope.redirectUrl,scope:$scope.scopes+" "+$scope.adminScopes,response_mode:"fragment",prompt:"none",domain_hint:"organizations",login_hint:$scope.userInfo.preferred_username},function(res){if(res.authResponse){var accessToken=res.authResponse.access_token;$http.defaults.headers.common.Authorization="Bearer "+accessToken}},function(res){console.error(res)})},hello.on("auth.login",function(auth){var accessToken;if("msft_token_refresh"==auth.network)accessToken=hello("msft_token_refresh").getAuthResponse().access_token;else if("msft"==auth.network){var authResponse=hello("msft").getAuthResponse();accessToken=authResponse.access_token}accessToken&&($http.defaults.headers.common.Authorization="Bearer "+accessToken,apiService.performQuery("GET")("https://graph.microsoft.com/v1.0/me").then(function(result){var resultBody=result.data;$scope.userInfo={preferred_username:resultBody.mail}},function(res){console.error(res)}))}),$scope.tabConfig={disableRequestBodyEditor:!0,hideContent:!0,selected:0},$scope.showImage=!1,$scope.tabConfig.previousSelected=$scope.tabConfig.selected,$scope.processTabClick=function(){var switchingTabs=$scope.tabConfig.previousSelected!=$scope.tabConfig.selected;switchingTabs||($scope.tabConfig.hideContent=!$scope.tabConfig.hideContent),$scope.tabConfig.previousSelected=$scope.tabConfig.selected};var requestVal=$location.search().request,actionVal=$location.search().method,bodyVal=$location.search().body,versionVal=$location.search().version,headersVal=$location.search().headers;handleQueryString(apiService,actionVal,versionVal,requestVal),$timeout(function(){initializeJsonEditorHeaders($scope,headersVal),initializeJsonViewer($scope,apiService)}),parseMetadata(apiService,$scope),$scope.isAuthenticated=function(){var session=hello("msft").getAuthResponse();if(null===session)return!1;var currentTime=(new Date).getTime()/1e3;return session&&session.access_token&&session.expires>currentTime},$scope.$watch("getEditor()",function(event,args){initializeJsonEditor($scope,bodyVal)}),$scope.login=function(){hello("msft").login({display:"page",response_type:"id_token token",nonce:"graph_explorer",prompt:"login",msafed:0},function(res){},function(){console.error("error signing in")})},$scope.logout=function(){apiService.selectedOption="GET",$scope.tabConfig.disableRequestBodyEditor=!0,setSelectedTab(0),hello("msft").logout(null,{force:!0}),delete $scope.userInfo},$scope.isActive=function(viewLocation){return viewLocation===$location.path()},$scope.searchText="",$scope.setSearchText=function(text){$scope.searchText=text},$scope.getSearchText=function(){return $scope.searchText},$scope.getCurrentEntityName=function(){if(!$scope.searchText)return null;var txt=$scope.searchText,pathArr=txt.split("/").filter(function(a){return a.length>0});return pathArr.pop()},$scope.canInsertTemplate=function(){return"POST"==apiService.selectedOption&&checkCanInsertTemplate($scope.searchText)},$scope.insertPostTemplate=function(){var entity=$scope.getCurrentEntityName(),strToInsert=JSON.stringify(postTemplates[entity],null,2).trim(),fullUserEmail=$scope.userInfo.preferred_username,domain=fullUserEmail.split("@")[1];strToInsert=strToInsert.replace(/AUTHENTICATED_DOMAIN/g,domain),strToInsert=strToInsert.replace(/FULL_USER_EMAIL/g,fullUserEmail),initializeJsonEditor($scope,strToInsert)},$scope.showShareDialog=function(ev){$mdDialog.show({controller:ShareDialogController,templateUrl:pathToBuildDir+"/assets/views/shareDialog.tmpl.html",parent:angular.element(document.body),targetEvent:ev,clickOutsideToClose:!0,scope:$scope.$new(),locals:{apiService:apiService,$sce:$sce,headers:formatRequestHeaders($scope.jsonEditorHeaders.getSession().getValue()),body:getJsonViewer().getSession().getValue()}}).then(function(answer){$scope.status='You said the information was "'+answer+'".'},function(){$scope.status="You cancelled the dialog."})}}]),angular.module("ApiExplorer").controller("DropdownCtrl",["$scope","ApiExplorerSvc",function($scope,apiService){$scope.selectedOption=apiService.selectedOption,$scope.onItemClick=function(choice){$scope.selectedOption=choice},$scope.items=["GET","POST","PATCH","DELETE"],$scope.getServiceOption=function(){return apiService.selectedOption},$scope.getOption=function(){return $scope.selectedOption},$scope.$watch("getOption()",function(newVal,oldVal){oldVal!==newVal&&(apiService.selectedOption=$scope.selectedOption,apiService.text=apiService.text.replace(/https:\/\/graph.microsoft.com($|\/([\w]|\.)*($|\/))/,"https://graph.microsoft.com/"+apiService.selectedVersion+"/"),"POST"==$scope.selectedOption||"PATCH"==$scope.selectedOption?showRequestBodyEditor():"GET"!=$scope.selectedOption&&"DELETE"!=$scope.selectedOption||(s.tabConfig.disableRequestBodyEditor=!0,setSelectedTab(0)))})}]),angular.module("ApiExplorer").controller("VersionCtrl",["$scope","ApiExplorerSvc",function($scope,apiService){$scope.items=["beta","v1.0"],$scope.getServiceVersion=function(){return apiService.selectedVersion},$scope.onItemClick=function(choice){apiService.selectedVersion=choice}}]),angular.module("ApiExplorer").controller("datalistCtrl",["$scope","ApiExplorerSvc",function($scope,apiService){$scope.searchTextChange=function(searchText){$scope.$parent.setSearchText(searchText),apiService.text=searchText},$scope.getRequestHistory=function(){return requestHistory},$scope.getServiceVersion=function(){return apiService.selectedVersion},$scope.$on("updateUrlFromServiceText",function(event,data){$scope.text=apiService.text}),$scope.$watch("getServiceVersion()",function(newVal,oldVal){oldVal!==newVal&&($scope.$parent.searchText&&($scope.searchTextChange($scope.$parent.searchText.replace(/https:\/\/graph.microsoft.com($|\/([\w]|\.)*($|\/))/,"https://graph.microsoft.com/"+apiService.selectedVersion+"/")),$scope.text=apiService.text),parseMetadata(apiService,$scope))}),$scope.searchTextChange(apiService.text),$scope.getMatches=function(query){var urls=getUrlsFromServiceURL(apiService);return urls.filter(function(option){var queryInOption=option.indexOf(query)>-1,queryIsEmpty=0==getEntityName(query).length;return queryIsEmpty||queryInOption})},window.runTests&&runAutoCompleteTests(apiService)}]),angular.module("ApiExplorer").controller("FormCtrl",["$scope","ApiExplorerSvc",function($scope,apiService){$scope.requestInProgress=!1,$scope.insufficientPrivileges=!1,null==hello("msft").getAuthResponse()||"POST"!==apiService.selectedOption&&"PATCH"!==apiService.selectedOption?setSelectedTab(0):showRequestBodyEditor(),$scope.getText=function(){return apiService.text},$scope.$parent.$on("urlChange",function(event,args){msGraphLinkResolution($scope,getJsonViewer().getSession().getValue(),args,apiService)}),$scope.historyOnClick=function(historyItem){$scope.text=historyItem.urlText,apiService.selectedVersion=historyItem.selectedVersion,apiService.selectedOption=historyItem.htmlOption,"POST"==historyItem.htmlOption||"PATCH"==historyItem.htmlOption?getJsonViewer()?getJsonViewer().getSession().setValue(historyItem.jsonInput):console.error("json editor watch event not firing"):getJsonViewer()&&getJsonViewer().getSession().setValue(""),$scope.submit($scope.text)},$scope.closeAdminConsentBar=function(){$scope.insufficientPrivileges=!1},$scope.getAdminConsent=function(){hello("msft_admin_consent").login({display:"popup"}).then(function(){$scope.finishAdminConsertFlow()},function(){$scope.finishAdminConsertFlow()})},$scope.submit=function(query){function handleSuccessfulQueryResponse(result){var status=result.status,headers=result.headers,resultBody=result.data;isImageResponse(headers)?handleImageResponse($scope,apiService,startTime,headers,status,handleUnsuccessfulQueryResponse):isHtmlResponse(headers)?handleHtmlResponse($scope,startTime,resultBody,headers,status):isXmlResponse(result)?handleXmlResponse($scope,startTime,resultBody,headers,status):handleJsonResponse($scope,startTime,resultBody,headers,status),saveHistoryObject(historyObj,status,new Date-startTime),$scope.insufficientPrivileges=!1}function handleUnsuccessfulQueryResponse(result){var status=result.status,headers=result.headers;handleJsonResponse($scope,startTime,result.data,headers,status),saveHistoryObject(historyObj,status,new Date-startTime),401!==status&&403!==status||($scope.insufficientPrivileges=!0)}if(query){apiService.text=query,$scope.requestInProgress=!0;var historyObj={};historyObj.urlText=query,historyObj.selectedVersion=apiService.selectedVersion,historyObj.htmlOption=apiService.selectedOption,historyObj.jsonInput="","POST"!=historyObj.htmlOption&&"PATCH"!=historyObj.htmlOption||(historyObj.jsonInput=getRequestBodyEditor().getSession().getValue()),$scope.showImage=!1;var postBody="";void 0!=getRequestBodyEditor()&&(postBody=getRequestBodyEditor().getSession().getValue());var requestHeaders="";void 0!=$scope.jsonEditorHeaders&&(requestHeaders=$scope.jsonEditorHeaders.getSession().getValue(),requestHeaders=formatRequestHeaders(requestHeaders));var startTime=new Date;$scope.isAuthenticated()?apiService.performQuery(apiService.selectedOption)(apiService.text,postBody,requestHeaders).then(handleSuccessfulQueryResponse,handleUnsuccessfulQueryResponse):apiService.performAnonymousQuery(apiService.selectedOption)(apiService.text,postBody,requestHeaders).then(handleSuccessfulQueryResponse,handleUnsuccessfulQueryResponse)}}}]);var scripts=document.getElementsByTagName("script"),src=scripts[scripts.length-1].src,pathToBuildDir=src.split("/").slice(0,-2).join("/");angular.module("ApiExplorer").directive("apiExplorer",function(){return{scope:{strings:"=",language:"=",scopes:"=",adminScopes:"=",clientId:"=",redirectUrl:"="},templateUrl:pathToBuildDir+"/assets/views/explorer.html",controller:function($scope){$scope.pathToBuildDir=pathToBuildDir,$scope.str=loc_strings.en_us,$scope.language&&($scope.str=loc_strings[$scope.language]),angular.extend($scope.str,$scope.strings),hello.init({msft:$scope.clientId},{scope:$scope.scopes,redirect_uri:window.location.pathname}),hello.init({msft_admin_consent:$scope.clientId,msft_token_refresh:$scope.clientId},{redirect_uri:window.location.pathname})}}}),hello.init({msft:{oauth:{version:2,auth:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",grant:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token"},scope_delim:" ",form:!1},msft_admin_consent:{oauth:{version:2,auth:"https://login.microsoftonline.com/organizations/adminconsent",grant:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token"},scope_delim:" ",form:!1},msft_token_refresh:{oauth:{version:2,auth:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",grant:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token"},scope_delim:" ",form:!1}});var postTemplates={messages:{subject:"Meet for lunch?",body:{contentType:"Text",content:"The new cafeteria is open."},toRecipients:[{emailAddress:{address:"garthf@contoso.com"}}]},events:{subject:"My event",start:{dateTime:"2017-05-07T16:15:00.0000000",timeZone:"UTC"},end:{dateTime:"2017-06-07T16:15:00.0000000",timeZone:"UTC"}},sendMail:{message:{subject:"Meet for lunch?",body:{contentType:"Text",content:"The new cafeteria is open."},toRecipients:[{emailAddress:{address:"garthf@contoso.com"}}]},saveToSentItems:"false"},findMeetingTimes:{attendees:[{emailAddress:{address:"FULL_USER_EMAIL",name:"Alex Darrow"},type:"Required"}],timeConstraint:{timeslots:[{start:{dateTime:"2016-10-20T07:00:00",timeZone:"Pacific Standard Time"},end:{dateTime:"2016-10-20T17:00:00",timeZone:"Pacific Standard Time"}}]},locationConstraint:{isRequired:"false",suggestLocation:"true",locations:[{displayName:"Conf Room 32/1368",locationEmailAddress:"conf32room1368@imgeek.onmicrosoft.com"}]},meetingDuration:"PT1H"},users:{accountEnabled:!0,city:"Seattle",country:"United States",department:"Sales & Marketing",displayName:"Melissa Darrow",givenName:"Melissa",jobTitle:"Marketing Director",mailNickname:"MelissaD",passwordPolicies:"DisablePasswordExpiration",passwordProfile:{password:"Test1234",forceChangePasswordNextSignIn:!1},officeLocation:"131/1105",postalCode:"98052",preferredLanguage:"en-US",state:"WA",streetAddress:"9256 Towne Center Dr., Suite 400",surname:"Darrow",mobilePhone:"+1 206 555 0110",usageLocation:"US",userPrincipalName:"MelissaD@AUTHENTICATED_DOMAIN"},groups:{"@odata.type":"#Microsoft.Graph.Group",description:"This group is the best ever",displayName:"Unified group 3ef15",groupTypes:["Unified"],mailEnabled:!0,mailNickname:"Group911e5",securityEnabled:!0},contacts:{givenName:"Pavel",surname:"Bansky",emailAddresses:[{address:"pavelb@fabrikam.onmicrosoft.com",name:"Pavel Bansky"}],businessPhones:["+1 732 555 0102"]}},templateNames={messages:"message",events:"event",sendMail:"email"},requestHistory=[],LocalStorageKeyGraphRequestHistory="GRAPH_REQUEST_HISTORY";loadHistoryFromLocalStorage();